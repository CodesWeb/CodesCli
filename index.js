#!/usr/bin/env node
(()=>{var __webpack_modules__={4412:(e,t,s)=>{"use strict";e=s.nmd(e);const wrapAnsi16=(e,t)=>(...s)=>{const i=e(...s);return`[${i+t}m`};const wrapAnsi256=(e,t)=>(...s)=>{const i=e(...s);return`[${38+t};5;${i}m`};const wrapAnsi16m=(e,t)=>(...s)=>{const i=e(...s);return`[${38+t};2;${i[0]};${i[1]};${i[2]}m`};const ansi2ansi=e=>e;const rgb2rgb=(e,t,s)=>[e,t,s];const setLazyProperty=(e,t,s)=>{Object.defineProperty(e,t,{get:()=>{const i=s();Object.defineProperty(e,t,{value:i,enumerable:true,configurable:true});return i},enumerable:true,configurable:true})};let i;const makeDynamicStyles=(e,t,n,r)=>{if(i===undefined){i=s(4185)}const o=r?10:0;const a={};for(const[s,r]of Object.entries(i)){const i=s==="ansi16"?"ansi":s;if(s===t){a[i]=e(n,o)}else if(typeof r==="object"){a[i]=e(r[t],o)}}return a};function assembleStyles(){const e=new Map;const t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright;t.bgColor.bgGray=t.bgColor.bgBlackBright;t.color.grey=t.color.blackBright;t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(const[s,i]of Object.entries(t)){for(const[s,n]of Object.entries(i)){t[s]={open:`[${n[0]}m`,close:`[${n[1]}m`};i[s]=t[s];e.set(n[0],n[1])}Object.defineProperty(t,s,{value:i,enumerable:false})}Object.defineProperty(t,"codes",{value:e,enumerable:false});t.color.close="[39m";t.bgColor.close="[49m";setLazyProperty(t.color,"ansi",(()=>makeDynamicStyles(wrapAnsi16,"ansi16",ansi2ansi,false)));setLazyProperty(t.color,"ansi256",(()=>makeDynamicStyles(wrapAnsi256,"ansi256",ansi2ansi,false)));setLazyProperty(t.color,"ansi16m",(()=>makeDynamicStyles(wrapAnsi16m,"rgb",rgb2rgb,false)));setLazyProperty(t.bgColor,"ansi",(()=>makeDynamicStyles(wrapAnsi16,"ansi16",ansi2ansi,true)));setLazyProperty(t.bgColor,"ansi256",(()=>makeDynamicStyles(wrapAnsi256,"ansi256",ansi2ansi,true)));setLazyProperty(t.bgColor,"ansi16m",(()=>makeDynamicStyles(wrapAnsi16m,"rgb",rgb2rgb,true)));return t}Object.defineProperty(e,"exports",{enumerable:true,get:assembleStyles})},465:(e,t,s)=>{"use strict";const i=s(4412);const{stdout:n,stderr:r}=s(1450);const{stringReplaceAll:o,stringEncaseCRLFWithFirstIndex:a}=s(8809);const{isArray:l}=Array;const c=["ansi","ansi","ansi256","ansi16m"];const h=Object.create(null);const applyOptions=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3)){throw new Error("The `level` option should be an integer from 0 to 3")}const s=n?n.level:0;e.level=t.level===undefined?s:t.level};class ChalkClass{constructor(e){return chalkFactory(e)}}const chalkFactory=e=>{const t={};applyOptions(t,e);t.template=(...e)=>chalkTag(t.template,...e);Object.setPrototypeOf(t,Chalk.prototype);Object.setPrototypeOf(t.template,t);t.template.constructor=()=>{throw new Error("`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.")};t.template.Instance=ChalkClass;return t.template};function Chalk(e){return chalkFactory(e)}for(const[e,t]of Object.entries(i)){h[e]={get(){const s=createBuilder(this,createStyler(t.open,t.close,this._styler),this._isEmpty);Object.defineProperty(this,e,{value:s});return s}}}h.visible={get(){const e=createBuilder(this,this._styler,true);Object.defineProperty(this,"visible",{value:e});return e}};const u=["rgb","hex","keyword","hsl","hsv","hwb","ansi","ansi256"];for(const e of u){h[e]={get(){const{level:t}=this;return function(...s){const n=createStyler(i.color[c[t]][e](...s),i.color.close,this._styler);return createBuilder(this,n,this._isEmpty)}}}}for(const e of u){const t="bg"+e[0].toUpperCase()+e.slice(1);h[t]={get(){const{level:t}=this;return function(...s){const n=createStyler(i.bgColor[c[t]][e](...s),i.bgColor.close,this._styler);return createBuilder(this,n,this._isEmpty)}}}}const d=Object.defineProperties((()=>{}),{...h,level:{enumerable:true,get(){return this._generator.level},set(e){this._generator.level=e}}});const createStyler=(e,t,s)=>{let i;let n;if(s===undefined){i=e;n=t}else{i=s.openAll+e;n=t+s.closeAll}return{open:e,close:t,openAll:i,closeAll:n,parent:s}};const createBuilder=(e,t,s)=>{const builder=(...e)=>{if(l(e[0])&&l(e[0].raw)){return applyStyle(builder,chalkTag(builder,...e))}return applyStyle(builder,e.length===1?""+e[0]:e.join(" "))};Object.setPrototypeOf(builder,d);builder._generator=e;builder._styler=t;builder._isEmpty=s;return builder};const applyStyle=(e,t)=>{if(e.level<=0||!t){return e._isEmpty?"":t}let s=e._styler;if(s===undefined){return t}const{openAll:i,closeAll:n}=s;if(t.indexOf("")!==-1){while(s!==undefined){t=o(t,s.close,s.open);s=s.parent}}const r=t.indexOf("\n");if(r!==-1){t=a(t,n,i,r)}return i+t+n};let p;const chalkTag=(e,...t)=>{const[i]=t;if(!l(i)||!l(i.raw)){return t.join(" ")}const n=t.slice(1);const r=[i.raw[0]];for(let e=1;e<i.length;e++){r.push(String(n[e-1]).replace(/[{}\\]/g,"\\$&"),String(i.raw[e]))}if(p===undefined){p=s(4670)}return p(e,r.join(""))};Object.defineProperties(Chalk.prototype,h);const f=Chalk();f.supportsColor=n;f.stderr=Chalk({level:r?r.level:0});f.stderr.supportsColor=r;e.exports=f},4670:e=>{"use strict";const t=/(?:\\(u(?:[a-f\d]{4}|\{[a-f\d]{1,6}\})|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi;const s=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g;const i=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/;const n=/\\(u(?:[a-f\d]{4}|{[a-f\d]{1,6}})|x[a-f\d]{2}|.)|([^\\])/gi;const r=new Map([["n","\n"],["r","\r"],["t","\t"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e",""],["a",""]]);function unescape(e){const t=e[0]==="u";const s=e[1]==="{";if(t&&!s&&e.length===5||e[0]==="x"&&e.length===3){return String.fromCharCode(parseInt(e.slice(1),16))}if(t&&s){return String.fromCodePoint(parseInt(e.slice(2,-1),16))}return r.get(e)||e}function parseArguments(e,t){const s=[];const r=t.trim().split(/\s*,\s*/g);let o;for(const t of r){const r=Number(t);if(!Number.isNaN(r)){s.push(r)}else if(o=t.match(i)){s.push(o[2].replace(n,((e,t,s)=>t?unescape(t):s)))}else{throw new Error(`Invalid Chalk template style argument: ${t} (in style '${e}')`)}}return s}function parseStyle(e){s.lastIndex=0;const t=[];let i;while((i=s.exec(e))!==null){const e=i[1];if(i[2]){const s=parseArguments(e,i[2]);t.push([e].concat(s))}else{t.push([e])}}return t}function buildStyle(e,t){const s={};for(const e of t){for(const t of e.styles){s[t[0]]=e.inverse?null:t.slice(1)}}let i=e;for(const[e,t]of Object.entries(s)){if(!Array.isArray(t)){continue}if(!(e in i)){throw new Error(`Unknown Chalk style: ${e}`)}i=t.length>0?i[e](...t):i[e]}return i}e.exports=(e,s)=>{const i=[];const n=[];let r=[];s.replace(t,((t,s,o,a,l,c)=>{if(s){r.push(unescape(s))}else if(a){const t=r.join("");r=[];n.push(i.length===0?t:buildStyle(e,i)(t));i.push({inverse:o,styles:parseStyle(a)})}else if(l){if(i.length===0){throw new Error("Found extraneous } in Chalk template literal")}n.push(buildStyle(e,i)(r.join("")));r=[];i.pop()}else{r.push(c)}}));n.push(r.join(""));if(i.length>0){const e=`Chalk template literal is missing ${i.length} closing bracket${i.length===1?"":"s"} (\`}\`)`;throw new Error(e)}return n.join("")}},8809:e=>{"use strict";const stringReplaceAll=(e,t,s)=>{let i=e.indexOf(t);if(i===-1){return e}const n=t.length;let r=0;let o="";do{o+=e.substr(r,i-r)+t+s;r=i+n;i=e.indexOf(t,r)}while(i!==-1);o+=e.substr(r);return o};const stringEncaseCRLFWithFirstIndex=(e,t,s,i)=>{let n=0;let r="";do{const o=e[i-1]==="\r";r+=e.substr(n,(o?i-1:i)-n)+t+(o?"\r\n":"\n")+s;n=i+1;i=e.indexOf("\n",n)}while(i!==-1);r+=e.substr(n);return r};e.exports={stringReplaceAll:stringReplaceAll,stringEncaseCRLFWithFirstIndex:stringEncaseCRLFWithFirstIndex}},6872:(e,t,s)=>{const i=s(4953);const n={};for(const e of Object.keys(i)){n[i[e]]=e}const r={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};e.exports=r;for(const e of Object.keys(r)){if(!("channels"in r[e])){throw new Error("missing channels property: "+e)}if(!("labels"in r[e])){throw new Error("missing channel labels property: "+e)}if(r[e].labels.length!==r[e].channels){throw new Error("channel and label counts mismatch: "+e)}const{channels:t,labels:s}=r[e];delete r[e].channels;delete r[e].labels;Object.defineProperty(r[e],"channels",{value:t});Object.defineProperty(r[e],"labels",{value:s})}r.rgb.hsl=function(e){const t=e[0]/255;const s=e[1]/255;const i=e[2]/255;const n=Math.min(t,s,i);const r=Math.max(t,s,i);const o=r-n;let a;let l;if(r===n){a=0}else if(t===r){a=(s-i)/o}else if(s===r){a=2+(i-t)/o}else if(i===r){a=4+(t-s)/o}a=Math.min(a*60,360);if(a<0){a+=360}const c=(n+r)/2;if(r===n){l=0}else if(c<=.5){l=o/(r+n)}else{l=o/(2-r-n)}return[a,l*100,c*100]};r.rgb.hsv=function(e){let t;let s;let i;let n;let r;const o=e[0]/255;const a=e[1]/255;const l=e[2]/255;const c=Math.max(o,a,l);const h=c-Math.min(o,a,l);const diffc=function(e){return(c-e)/6/h+1/2};if(h===0){n=0;r=0}else{r=h/c;t=diffc(o);s=diffc(a);i=diffc(l);if(o===c){n=i-s}else if(a===c){n=1/3+t-i}else if(l===c){n=2/3+s-t}if(n<0){n+=1}else if(n>1){n-=1}}return[n*360,r*100,c*100]};r.rgb.hwb=function(e){const t=e[0];const s=e[1];let i=e[2];const n=r.rgb.hsl(e)[0];const o=1/255*Math.min(t,Math.min(s,i));i=1-1/255*Math.max(t,Math.max(s,i));return[n,o*100,i*100]};r.rgb.cmyk=function(e){const t=e[0]/255;const s=e[1]/255;const i=e[2]/255;const n=Math.min(1-t,1-s,1-i);const r=(1-t-n)/(1-n)||0;const o=(1-s-n)/(1-n)||0;const a=(1-i-n)/(1-n)||0;return[r*100,o*100,a*100,n*100]};function comparativeDistance(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}r.rgb.keyword=function(e){const t=n[e];if(t){return t}let s=Infinity;let r;for(const t of Object.keys(i)){const n=i[t];const o=comparativeDistance(e,n);if(o<s){s=o;r=t}}return r};r.keyword.rgb=function(e){return i[e]};r.rgb.xyz=function(e){let t=e[0]/255;let s=e[1]/255;let i=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92;s=s>.04045?((s+.055)/1.055)**2.4:s/12.92;i=i>.04045?((i+.055)/1.055)**2.4:i/12.92;const n=t*.4124+s*.3576+i*.1805;const r=t*.2126+s*.7152+i*.0722;const o=t*.0193+s*.1192+i*.9505;return[n*100,r*100,o*100]};r.rgb.lab=function(e){const t=r.rgb.xyz(e);let s=t[0];let i=t[1];let n=t[2];s/=95.047;i/=100;n/=108.883;s=s>.008856?s**(1/3):7.787*s+16/116;i=i>.008856?i**(1/3):7.787*i+16/116;n=n>.008856?n**(1/3):7.787*n+16/116;const o=116*i-16;const a=500*(s-i);const l=200*(i-n);return[o,a,l]};r.hsl.rgb=function(e){const t=e[0]/360;const s=e[1]/100;const i=e[2]/100;let n;let r;let o;if(s===0){o=i*255;return[o,o,o]}if(i<.5){n=i*(1+s)}else{n=i+s-i*s}const a=2*i-n;const l=[0,0,0];for(let e=0;e<3;e++){r=t+1/3*-(e-1);if(r<0){r++}if(r>1){r--}if(6*r<1){o=a+(n-a)*6*r}else if(2*r<1){o=n}else if(3*r<2){o=a+(n-a)*(2/3-r)*6}else{o=a}l[e]=o*255}return l};r.hsl.hsv=function(e){const t=e[0];let s=e[1]/100;let i=e[2]/100;let n=s;const r=Math.max(i,.01);i*=2;s*=i<=1?i:2-i;n*=r<=1?r:2-r;const o=(i+s)/2;const a=i===0?2*n/(r+n):2*s/(i+s);return[t,a*100,o*100]};r.hsv.rgb=function(e){const t=e[0]/60;const s=e[1]/100;let i=e[2]/100;const n=Math.floor(t)%6;const r=t-Math.floor(t);const o=255*i*(1-s);const a=255*i*(1-s*r);const l=255*i*(1-s*(1-r));i*=255;switch(n){case 0:return[i,l,o];case 1:return[a,i,o];case 2:return[o,i,l];case 3:return[o,a,i];case 4:return[l,o,i];case 5:return[i,o,a]}};r.hsv.hsl=function(e){const t=e[0];const s=e[1]/100;const i=e[2]/100;const n=Math.max(i,.01);let r;let o;o=(2-s)*i;const a=(2-s)*n;r=s*n;r/=a<=1?a:2-a;r=r||0;o/=2;return[t,r*100,o*100]};r.hwb.rgb=function(e){const t=e[0]/360;let s=e[1]/100;let i=e[2]/100;const n=s+i;let r;if(n>1){s/=n;i/=n}const o=Math.floor(6*t);const a=1-i;r=6*t-o;if((o&1)!==0){r=1-r}const l=s+r*(a-s);let c;let h;let u;switch(o){default:case 6:case 0:c=a;h=l;u=s;break;case 1:c=l;h=a;u=s;break;case 2:c=s;h=a;u=l;break;case 3:c=s;h=l;u=a;break;case 4:c=l;h=s;u=a;break;case 5:c=a;h=s;u=l;break}return[c*255,h*255,u*255]};r.cmyk.rgb=function(e){const t=e[0]/100;const s=e[1]/100;const i=e[2]/100;const n=e[3]/100;const r=1-Math.min(1,t*(1-n)+n);const o=1-Math.min(1,s*(1-n)+n);const a=1-Math.min(1,i*(1-n)+n);return[r*255,o*255,a*255]};r.xyz.rgb=function(e){const t=e[0]/100;const s=e[1]/100;const i=e[2]/100;let n;let r;let o;n=t*3.2406+s*-1.5372+i*-.4986;r=t*-.9689+s*1.8758+i*.0415;o=t*.0557+s*-.204+i*1.057;n=n>.0031308?1.055*n**(1/2.4)-.055:n*12.92;r=r>.0031308?1.055*r**(1/2.4)-.055:r*12.92;o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92;n=Math.min(Math.max(0,n),1);r=Math.min(Math.max(0,r),1);o=Math.min(Math.max(0,o),1);return[n*255,r*255,o*255]};r.xyz.lab=function(e){let t=e[0];let s=e[1];let i=e[2];t/=95.047;s/=100;i/=108.883;t=t>.008856?t**(1/3):7.787*t+16/116;s=s>.008856?s**(1/3):7.787*s+16/116;i=i>.008856?i**(1/3):7.787*i+16/116;const n=116*s-16;const r=500*(t-s);const o=200*(s-i);return[n,r,o]};r.lab.xyz=function(e){const t=e[0];const s=e[1];const i=e[2];let n;let r;let o;r=(t+16)/116;n=s/500+r;o=r-i/200;const a=r**3;const l=n**3;const c=o**3;r=a>.008856?a:(r-16/116)/7.787;n=l>.008856?l:(n-16/116)/7.787;o=c>.008856?c:(o-16/116)/7.787;n*=95.047;r*=100;o*=108.883;return[n,r,o]};r.lab.lch=function(e){const t=e[0];const s=e[1];const i=e[2];let n;const r=Math.atan2(i,s);n=r*360/2/Math.PI;if(n<0){n+=360}const o=Math.sqrt(s*s+i*i);return[t,o,n]};r.lch.lab=function(e){const t=e[0];const s=e[1];const i=e[2];const n=i/360*2*Math.PI;const r=s*Math.cos(n);const o=s*Math.sin(n);return[t,r,o]};r.rgb.ansi16=function(e,t=null){const[s,i,n]=e;let o=t===null?r.rgb.hsv(e)[2]:t;o=Math.round(o/50);if(o===0){return 30}let a=30+(Math.round(n/255)<<2|Math.round(i/255)<<1|Math.round(s/255));if(o===2){a+=60}return a};r.hsv.ansi16=function(e){return r.rgb.ansi16(r.hsv.rgb(e),e[2])};r.rgb.ansi256=function(e){const t=e[0];const s=e[1];const i=e[2];if(t===s&&s===i){if(t<8){return 16}if(t>248){return 231}return Math.round((t-8)/247*24)+232}const n=16+36*Math.round(t/255*5)+6*Math.round(s/255*5)+Math.round(i/255*5);return n};r.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7){if(e>50){t+=3.5}t=t/10.5*255;return[t,t,t]}const s=(~~(e>50)+1)*.5;const i=(t&1)*s*255;const n=(t>>1&1)*s*255;const r=(t>>2&1)*s*255;return[i,n,r]};r.ansi256.rgb=function(e){if(e>=232){const t=(e-232)*10+8;return[t,t,t]}e-=16;let t;const s=Math.floor(e/36)/5*255;const i=Math.floor((t=e%36)/6)/5*255;const n=t%6/5*255;return[s,i,n]};r.rgb.hex=function(e){const t=((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255);const s=t.toString(16).toUpperCase();return"000000".substring(s.length)+s};r.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t){return[0,0,0]}let s=t[0];if(t[0].length===3){s=s.split("").map((e=>e+e)).join("")}const i=parseInt(s,16);const n=i>>16&255;const r=i>>8&255;const o=i&255;return[n,r,o]};r.rgb.hcg=function(e){const t=e[0]/255;const s=e[1]/255;const i=e[2]/255;const n=Math.max(Math.max(t,s),i);const r=Math.min(Math.min(t,s),i);const o=n-r;let a;let l;if(o<1){a=r/(1-o)}else{a=0}if(o<=0){l=0}else if(n===t){l=(s-i)/o%6}else if(n===s){l=2+(i-t)/o}else{l=4+(t-s)/o}l/=6;l%=1;return[l*360,o*100,a*100]};r.hsl.hcg=function(e){const t=e[1]/100;const s=e[2]/100;const i=s<.5?2*t*s:2*t*(1-s);let n=0;if(i<1){n=(s-.5*i)/(1-i)}return[e[0],i*100,n*100]};r.hsv.hcg=function(e){const t=e[1]/100;const s=e[2]/100;const i=t*s;let n=0;if(i<1){n=(s-i)/(1-i)}return[e[0],i*100,n*100]};r.hcg.rgb=function(e){const t=e[0]/360;const s=e[1]/100;const i=e[2]/100;if(s===0){return[i*255,i*255,i*255]}const n=[0,0,0];const r=t%1*6;const o=r%1;const a=1-o;let l=0;switch(Math.floor(r)){case 0:n[0]=1;n[1]=o;n[2]=0;break;case 1:n[0]=a;n[1]=1;n[2]=0;break;case 2:n[0]=0;n[1]=1;n[2]=o;break;case 3:n[0]=0;n[1]=a;n[2]=1;break;case 4:n[0]=o;n[1]=0;n[2]=1;break;default:n[0]=1;n[1]=0;n[2]=a}l=(1-s)*i;return[(s*n[0]+l)*255,(s*n[1]+l)*255,(s*n[2]+l)*255]};r.hcg.hsv=function(e){const t=e[1]/100;const s=e[2]/100;const i=t+s*(1-t);let n=0;if(i>0){n=t/i}return[e[0],n*100,i*100]};r.hcg.hsl=function(e){const t=e[1]/100;const s=e[2]/100;const i=s*(1-t)+.5*t;let n=0;if(i>0&&i<.5){n=t/(2*i)}else if(i>=.5&&i<1){n=t/(2*(1-i))}return[e[0],n*100,i*100]};r.hcg.hwb=function(e){const t=e[1]/100;const s=e[2]/100;const i=t+s*(1-t);return[e[0],(i-t)*100,(1-i)*100]};r.hwb.hcg=function(e){const t=e[1]/100;const s=e[2]/100;const i=1-s;const n=i-t;let r=0;if(n<1){r=(i-n)/(1-n)}return[e[0],n*100,r*100]};r.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};r.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};r.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};r.gray.hsl=function(e){return[0,0,e[0]]};r.gray.hsv=r.gray.hsl;r.gray.hwb=function(e){return[0,100,e[0]]};r.gray.cmyk=function(e){return[0,0,0,e[0]]};r.gray.lab=function(e){return[e[0],0,0]};r.gray.hex=function(e){const t=Math.round(e[0]/100*255)&255;const s=(t<<16)+(t<<8)+t;const i=s.toString(16).toUpperCase();return"000000".substring(i.length)+i};r.rgb.gray=function(e){const t=(e[0]+e[1]+e[2])/3;return[t/255*100]}},4185:(e,t,s)=>{const i=s(6872);const n=s(4200);const r={};const o=Object.keys(i);function wrapRaw(e){const wrappedFn=function(...t){const s=t[0];if(s===undefined||s===null){return s}if(s.length>1){t=s}return e(t)};if("conversion"in e){wrappedFn.conversion=e.conversion}return wrappedFn}function wrapRounded(e){const wrappedFn=function(...t){const s=t[0];if(s===undefined||s===null){return s}if(s.length>1){t=s}const i=e(t);if(typeof i==="object"){for(let e=i.length,t=0;t<e;t++){i[t]=Math.round(i[t])}}return i};if("conversion"in e){wrappedFn.conversion=e.conversion}return wrappedFn}o.forEach((e=>{r[e]={};Object.defineProperty(r[e],"channels",{value:i[e].channels});Object.defineProperty(r[e],"labels",{value:i[e].labels});const t=n(e);const s=Object.keys(t);s.forEach((s=>{const i=t[s];r[e][s]=wrapRounded(i);r[e][s].raw=wrapRaw(i)}))}));e.exports=r},4200:(e,t,s)=>{const i=s(6872);function buildGraph(){const e={};const t=Object.keys(i);for(let s=t.length,i=0;i<s;i++){e[t[i]]={distance:-1,parent:null}}return e}function deriveBFS(e){const t=buildGraph();const s=[e];t[e].distance=0;while(s.length){const e=s.pop();const n=Object.keys(i[e]);for(let i=n.length,r=0;r<i;r++){const i=n[r];const o=t[i];if(o.distance===-1){o.distance=t[e].distance+1;o.parent=e;s.unshift(i)}}}return t}function link(e,t){return function(s){return t(e(s))}}function wrapConversion(e,t){const s=[t[e].parent,e];let n=i[t[e].parent][e];let r=t[e].parent;while(t[r].parent){s.unshift(t[r].parent);n=link(i[t[r].parent][r],n);r=t[r].parent}n.conversion=s;return n}e.exports=function(e){const t=deriveBFS(e);const s={};const i=Object.keys(t);for(let e=i.length,n=0;n<e;n++){const e=i[n];const r=t[e];if(r.parent===null){continue}s[e]=wrapConversion(e,t)}return s}},4953:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},3813:e=>{"use strict";e.exports=(e,t=process.argv)=>{const s=e.startsWith("-")?"":e.length===1?"-":"--";const i=t.indexOf(s+e);const n=t.indexOf("--");return i!==-1&&(n===-1||i<n)}},1450:(e,t,s)=>{"use strict";const i=s(857);const n=s(2018);const r=s(3813);const{env:o}=process;let a;if(r("no-color")||r("no-colors")||r("color=false")||r("color=never")){a=0}else if(r("color")||r("colors")||r("color=true")||r("color=always")){a=1}if("FORCE_COLOR"in o){if(o.FORCE_COLOR==="true"){a=1}else if(o.FORCE_COLOR==="false"){a=0}else{a=o.FORCE_COLOR.length===0?1:Math.min(parseInt(o.FORCE_COLOR,10),3)}}function translateLevel(e){if(e===0){return false}return{level:e,hasBasic:true,has256:e>=2,has16m:e>=3}}function supportsColor(e,t){if(a===0){return 0}if(r("color=16m")||r("color=full")||r("color=truecolor")){return 3}if(r("color=256")){return 2}if(e&&!t&&a===undefined){return 0}const s=a||0;if(o.TERM==="dumb"){return s}if(process.platform==="win32"){const e=i.release().split(".");if(Number(e[0])>=10&&Number(e[2])>=10586){return Number(e[2])>=14931?3:2}return 1}if("CI"in o){if(["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((e=>e in o))||o.CI_NAME==="codeship"){return 1}return s}if("TEAMCITY_VERSION"in o){return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0}if(o.COLORTERM==="truecolor"){return 3}if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}if(/-256(color)?$/i.test(o.TERM)){return 2}if(/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)){return 1}if("COLORTERM"in o){return 1}return s}function getSupportLevel(e){const t=supportsColor(e,e&&e.isTTY);return translateLevel(t)}e.exports={supportsColor:getSupportLevel,stdout:translateLevel(supportsColor(true,n.isatty(1))),stderr:translateLevel(supportsColor(true,n.isatty(2)))}},5317:e=>{"use strict";e.exports=require("child_process")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},8474:e=>{"use strict";e.exports=require("node:events")},3024:e=>{"use strict";e.exports=require("node:fs")},1455:e=>{"use strict";e.exports=require("node:fs/promises")},6760:e=>{"use strict";e.exports=require("node:path")},7075:e=>{"use strict";e.exports=require("node:stream")},6193:e=>{"use strict";e.exports=require("node:string_decoder")},3136:e=>{"use strict";e.exports=require("node:url")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},3785:e=>{"use strict";e.exports=require("readline")},2018:e=>{"use strict";e.exports=require("tty")},9023:e=>{"use strict";e.exports=require("util")},516:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.range=t.balanced=void 0;const balanced=(e,s,i)=>{const n=e instanceof RegExp?maybeMatch(e,i):e;const r=s instanceof RegExp?maybeMatch(s,i):s;const o=n!==null&&r!=null&&(0,t.range)(n,r,i);return o&&{start:o[0],end:o[1],pre:i.slice(0,o[0]),body:i.slice(o[0]+n.length,o[1]),post:i.slice(o[1]+r.length)}};t.balanced=balanced;const maybeMatch=(e,t)=>{const s=t.match(e);return s?s[0]:null};const range=(e,t,s)=>{let i,n,r,o=undefined,a;let l=s.indexOf(e);let c=s.indexOf(t,l+1);let h=l;if(l>=0&&c>0){if(e===t){return[l,c]}i=[];r=s.length;while(h>=0&&!a){if(h===l){i.push(h);l=s.indexOf(e,h+1)}else if(i.length===1){const e=i.pop();if(e!==undefined)a=[e,c]}else{n=i.pop();if(n!==undefined&&n<r){r=n;o=c}c=s.indexOf(t,h+1)}h=l<c&&l>=0?l:c}if(i.length&&o!==undefined){a=[r,o]}}return a};t.range=range},1215:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.expand=expand;const i=s(516);const n="\0SLASH"+Math.random()+"\0";const r="\0OPEN"+Math.random()+"\0";const o="\0CLOSE"+Math.random()+"\0";const a="\0COMMA"+Math.random()+"\0";const l="\0PERIOD"+Math.random()+"\0";const c=new RegExp(n,"g");const h=new RegExp(r,"g");const u=new RegExp(o,"g");const d=new RegExp(a,"g");const p=new RegExp(l,"g");const f=/\\\\/g;const g=/\\{/g;const y=/\\}/g;const w=/\\,/g;const b=/\\./g;function numeric(e){return!isNaN(e)?parseInt(e,10):e.charCodeAt(0)}function escapeBraces(e){return e.replace(f,n).replace(g,r).replace(y,o).replace(w,a).replace(b,l)}function unescapeBraces(e){return e.replace(c,"\\").replace(h,"{").replace(u,"}").replace(d,",").replace(p,".")}function parseCommaParts(e){if(!e){return[""]}const t=[];const s=(0,i.balanced)("{","}",e);if(!s){return e.split(",")}const{pre:n,body:r,post:o}=s;const a=n.split(",");a[a.length-1]+="{"+r+"}";const l=parseCommaParts(o);if(o.length){a[a.length-1]+=l.shift();a.push.apply(a,l)}t.push.apply(t,a);return t}function expand(e){if(!e){return[]}if(e.slice(0,2)==="{}"){e="\\{\\}"+e.slice(2)}return expand_(escapeBraces(e),true).map(unescapeBraces)}function embrace(e){return"{"+e+"}"}function isPadded(e){return/^-?0\d/.test(e)}function lte(e,t){return e<=t}function gte(e,t){return e>=t}function expand_(e,t){const s=[];const n=(0,i.balanced)("{","}",e);if(!n)return[e];const r=n.pre;const a=n.post.length?expand_(n.post,false):[""];if(/\$$/.test(n.pre)){for(let e=0;e<a.length;e++){const t=r+"{"+n.body+"}"+a[e];s.push(t)}}else{const i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body);const l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body);const c=i||l;const h=n.body.indexOf(",")>=0;if(!c&&!h){if(n.post.match(/,(?!,).*\}/)){e=n.pre+"{"+n.body+o+n.post;return expand_(e)}return[e]}let u;if(c){u=n.body.split(/\.\./)}else{u=parseCommaParts(n.body);if(u.length===1&&u[0]!==undefined){u=expand_(u[0],false).map(embrace);if(u.length===1){return a.map((e=>n.pre+u[0]+e))}}}let d;if(c&&u[0]!==undefined&&u[1]!==undefined){const e=numeric(u[0]);const t=numeric(u[1]);const s=Math.max(u[0].length,u[1].length);let i=u.length===3&&u[2]!==undefined?Math.abs(numeric(u[2])):1;let n=lte;const r=t<e;if(r){i*=-1;n=gte}const o=u.some(isPadded);d=[];for(let r=e;n(r,t);r+=i){let e;if(l){e=String.fromCharCode(r);if(e==="\\"){e=""}}else{e=String(r);if(o){const t=s-e.length;if(t>0){const s=new Array(t+1).join("0");if(r<0){e="-"+s+e.slice(1)}else{e=s+e}}}}d.push(e)}}else{d=[];for(let e=0;e<u.length;e++){d.push.apply(d,expand_(u[e],false))}}for(let e=0;e<d.length;e++){for(let i=0;i<a.length;i++){const n=r+d[e]+a[i];if(!t||c||n){s.push(n)}}}}return s}},2981:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Glob=void 0;const i=s(1409);const n=s(3136);const r=s(6577);const o=s(7813);const a=s(1157);const l=typeof process==="object"&&process&&typeof process.platform==="string"?process.platform:"linux";class Glob{absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;includeChildMatches;opts;patterns;constructor(e,t){if(!t)throw new TypeError("glob options required");this.withFileTypes=!!t.withFileTypes;this.signal=t.signal;this.follow=!!t.follow;this.dot=!!t.dot;this.dotRelative=!!t.dotRelative;this.nodir=!!t.nodir;this.mark=!!t.mark;if(!t.cwd){this.cwd=""}else if(t.cwd instanceof URL||t.cwd.startsWith("file://")){t.cwd=(0,n.fileURLToPath)(t.cwd)}this.cwd=t.cwd||"";this.root=t.root;this.magicalBraces=!!t.magicalBraces;this.nobrace=!!t.nobrace;this.noext=!!t.noext;this.realpath=!!t.realpath;this.absolute=t.absolute;this.includeChildMatches=t.includeChildMatches!==false;this.noglobstar=!!t.noglobstar;this.matchBase=!!t.matchBase;this.maxDepth=typeof t.maxDepth==="number"?t.maxDepth:Infinity;this.stat=!!t.stat;this.ignore=t.ignore;if(this.withFileTypes&&this.absolute!==undefined){throw new Error("cannot set absolute and withFileTypes:true")}if(typeof e==="string"){e=[e]}this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===false;if(this.windowsPathsNoEscape){e=e.map((e=>e.replace(/\\/g,"/")))}if(this.matchBase){if(t.noglobstar){throw new TypeError("base matching requires globstar")}e=e.map((e=>e.includes("/")?e:`./**/${e}`))}this.pattern=e;this.platform=t.platform||l;this.opts={...t,platform:this.platform};if(t.scurry){this.scurry=t.scurry;if(t.nocase!==undefined&&t.nocase!==t.scurry.nocase){throw new Error("nocase option contradicts provided scurry option")}}else{const e=t.platform==="win32"?r.PathScurryWin32:t.platform==="darwin"?r.PathScurryDarwin:t.platform?r.PathScurryPosix:r.PathScurry;this.scurry=new e(this.cwd,{nocase:t.nocase,fs:t.fs})}this.nocase=this.scurry.nocase;const s=this.platform==="darwin"||this.platform==="win32";const a={...t,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:s,nocomment:true,noext:this.noext,nonegate:true,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug};const c=this.pattern.map((e=>new i.Minimatch(e,a)));const[h,u]=c.reduce(((e,t)=>{e[0].push(...t.set);e[1].push(...t.globParts);return e}),[[],[]]);this.patterns=h.map(((e,t)=>{const s=u[t];if(!s)throw new Error("invalid pattern object");return new o.Pattern(e,s,0,this.platform)}))}async walk(){return[...await new a.GlobWalker(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==Infinity?this.maxDepth+this.scurry.cwd.depth():Infinity,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walk()]}walkSync(){return[...new a.GlobWalker(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==Infinity?this.maxDepth+this.scurry.cwd.depth():Infinity,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walkSync()]}stream(){return new a.GlobStream(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==Infinity?this.maxDepth+this.scurry.cwd.depth():Infinity,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).stream()}streamSync(){return new a.GlobStream(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==Infinity?this.maxDepth+this.scurry.cwd.depth():Infinity,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}}t.Glob=Glob},5197:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.hasMagic=void 0;const i=s(1409);const hasMagic=(e,t={})=>{if(!Array.isArray(e)){e=[e]}for(const s of e){if(new i.Minimatch(s,t).hasMagic())return true}return false};t.hasMagic=hasMagic},5637:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Ignore=void 0;const i=s(1409);const n=s(7813);const r=typeof process==="object"&&process&&typeof process.platform==="string"?process.platform:"linux";class Ignore{relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(e,{nobrace:t,nocase:s,noext:i,noglobstar:n,platform:o=r}){this.relative=[];this.absolute=[];this.relativeChildren=[];this.absoluteChildren=[];this.platform=o;this.mmopts={dot:true,nobrace:t,nocase:s,noext:i,noglobstar:n,optimizationLevel:2,platform:o,nocomment:true,nonegate:true};for(const t of e)this.add(t)}add(e){const t=new i.Minimatch(e,this.mmopts);for(let e=0;e<t.set.length;e++){const s=t.set[e];const r=t.globParts[e];if(!s||!r){throw new Error("invalid pattern object")}while(s[0]==="."&&r[0]==="."){s.shift();r.shift()}const o=new n.Pattern(s,r,0,this.platform);const a=new i.Minimatch(o.globString(),this.mmopts);const l=r[r.length-1]==="**";const c=o.isAbsolute();if(c)this.absolute.push(a);else this.relative.push(a);if(l){if(c)this.absoluteChildren.push(a);else this.relativeChildren.push(a)}}}ignored(e){const t=e.fullpath();const s=`${t}/`;const i=e.relative()||".";const n=`${i}/`;for(const e of this.relative){if(e.match(i)||e.match(n))return true}for(const e of this.absolute){if(e.match(t)||e.match(s))return true}return false}childrenIgnored(e){const t=e.fullpath()+"/";const s=(e.relative()||".")+"/";for(const e of this.relativeChildren){if(e.match(s))return true}for(const e of this.absoluteChildren){if(e.match(t))return true}return false}}t.Ignore=Ignore},1363:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.glob=t.sync=t.iterate=t.iterateSync=t.stream=t.streamSync=t.Ignore=t.hasMagic=t.Glob=t.unescape=t.escape=void 0;t.globStreamSync=globStreamSync;t.globStream=globStream;t.globSync=globSync;t.globIterateSync=globIterateSync;t.globIterate=globIterate;const i=s(1409);const n=s(2981);const r=s(5197);var o=s(1409);Object.defineProperty(t,"escape",{enumerable:true,get:function(){return o.escape}});Object.defineProperty(t,"unescape",{enumerable:true,get:function(){return o.unescape}});var a=s(2981);Object.defineProperty(t,"Glob",{enumerable:true,get:function(){return a.Glob}});var l=s(5197);Object.defineProperty(t,"hasMagic",{enumerable:true,get:function(){return l.hasMagic}});var c=s(5637);Object.defineProperty(t,"Ignore",{enumerable:true,get:function(){return c.Ignore}});function globStreamSync(e,t={}){return new n.Glob(e,t).streamSync()}function globStream(e,t={}){return new n.Glob(e,t).stream()}function globSync(e,t={}){return new n.Glob(e,t).walkSync()}async function glob_(e,t={}){return new n.Glob(e,t).walk()}function globIterateSync(e,t={}){return new n.Glob(e,t).iterateSync()}function globIterate(e,t={}){return new n.Glob(e,t).iterate()}t.streamSync=globStreamSync;t.stream=Object.assign(globStream,{sync:globStreamSync});t.iterateSync=globIterateSync;t.iterate=Object.assign(globIterate,{sync:globIterateSync});t.sync=Object.assign(globSync,{stream:globStreamSync,iterate:globIterateSync});t.glob=Object.assign(glob_,{glob:glob_,globSync:globSync,sync:t.sync,globStream:globStream,stream:t.stream,globStreamSync:globStreamSync,streamSync:t.streamSync,globIterate:globIterate,iterate:t.iterate,globIterateSync:globIterateSync,iterateSync:t.iterateSync,Glob:n.Glob,hasMagic:r.hasMagic,escape:i.escape,unescape:i.unescape});t.glob.glob=t.glob},7813:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Pattern=void 0;const i=s(1409);const isPatternList=e=>e.length>=1;const isGlobList=e=>e.length>=1;class Pattern{#e;#t;#s;length;#i;#n;#r;#o;#a;#l;#c=true;constructor(e,t,s,i){if(!isPatternList(e)){throw new TypeError("empty pattern list")}if(!isGlobList(t)){throw new TypeError("empty glob list")}if(t.length!==e.length){throw new TypeError("mismatched pattern list and glob list lengths")}this.length=e.length;if(s<0||s>=this.length){throw new TypeError("index out of range")}this.#e=e;this.#t=t;this.#s=s;this.#i=i;if(this.#s===0){if(this.isUNC()){const[e,t,s,i,...n]=this.#e;const[r,o,a,l,...c]=this.#t;if(n[0]===""){n.shift();c.shift()}const h=[e,t,s,i,""].join("/");const u=[r,o,a,l,""].join("/");this.#e=[h,...n];this.#t=[u,...c];this.length=this.#e.length}else if(this.isDrive()||this.isAbsolute()){const[e,...t]=this.#e;const[s,...i]=this.#t;if(t[0]===""){t.shift();i.shift()}const n=e+"/";const r=s+"/";this.#e=[n,...t];this.#t=[r,...i];this.length=this.#e.length}}}pattern(){return this.#e[this.#s]}isString(){return typeof this.#e[this.#s]==="string"}isGlobstar(){return this.#e[this.#s]===i.GLOBSTAR}isRegExp(){return this.#e[this.#s]instanceof RegExp}globString(){return this.#r=this.#r||(this.#s===0?this.isAbsolute()?this.#t[0]+this.#t.slice(1).join("/"):this.#t.join("/"):this.#t.slice(this.#s).join("/"))}hasMore(){return this.length>this.#s+1}rest(){if(this.#n!==undefined)return this.#n;if(!this.hasMore())return this.#n=null;this.#n=new Pattern(this.#e,this.#t,this.#s+1,this.#i);this.#n.#l=this.#l;this.#n.#a=this.#a;this.#n.#o=this.#o;return this.#n}isUNC(){const e=this.#e;return this.#a!==undefined?this.#a:this.#a=this.#i==="win32"&&this.#s===0&&e[0]===""&&e[1]===""&&typeof e[2]==="string"&&!!e[2]&&typeof e[3]==="string"&&!!e[3]}isDrive(){const e=this.#e;return this.#o!==undefined?this.#o:this.#o=this.#i==="win32"&&this.#s===0&&this.length>1&&typeof e[0]==="string"&&/^[a-z]:$/i.test(e[0])}isAbsolute(){const e=this.#e;return this.#l!==undefined?this.#l:this.#l=e[0]===""&&e.length>1||this.isDrive()||this.isUNC()}root(){const e=this.#e[0];return typeof e==="string"&&this.isAbsolute()&&this.#s===0?e:""}checkFollowGlobstar(){return!(this.#s===0||!this.isGlobstar()||!this.#c)}markFollowGlobstar(){if(this.#s===0||!this.isGlobstar()||!this.#c)return false;this.#c=false;return true}}t.Pattern=Pattern},7843:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Processor=t.SubWalks=t.MatchRecord=t.HasWalkedCache=void 0;const i=s(1409);class HasWalkedCache{store;constructor(e=new Map){this.store=e}copy(){return new HasWalkedCache(new Map(this.store))}hasWalked(e,t){return this.store.get(e.fullpath())?.has(t.globString())}storeWalked(e,t){const s=e.fullpath();const i=this.store.get(s);if(i)i.add(t.globString());else this.store.set(s,new Set([t.globString()]))}}t.HasWalkedCache=HasWalkedCache;class MatchRecord{store=new Map;add(e,t,s){const i=(t?2:0)|(s?1:0);const n=this.store.get(e);this.store.set(e,n===undefined?i:i&n)}entries(){return[...this.store.entries()].map((([e,t])=>[e,!!(t&2),!!(t&1)]))}}t.MatchRecord=MatchRecord;class SubWalks{store=new Map;add(e,t){if(!e.canReaddir()){return}const s=this.store.get(e);if(s){if(!s.find((e=>e.globString()===t.globString()))){s.push(t)}}else this.store.set(e,[t])}get(e){const t=this.store.get(e);if(!t){throw new Error("attempting to walk unknown path")}return t}entries(){return this.keys().map((e=>[e,this.store.get(e)]))}keys(){return[...this.store.keys()].filter((e=>e.canReaddir()))}}t.SubWalks=SubWalks;class Processor{hasWalkedCache;matches=new MatchRecord;subwalks=new SubWalks;patterns;follow;dot;opts;constructor(e,t){this.opts=e;this.follow=!!e.follow;this.dot=!!e.dot;this.hasWalkedCache=t?t.copy():new HasWalkedCache}processPatterns(e,t){this.patterns=t;const s=t.map((t=>[e,t]));for(let[e,t]of s){this.hasWalkedCache.storeWalked(e,t);const s=t.root();const n=t.isAbsolute()&&this.opts.absolute!==false;if(s){e=e.resolve(s==="/"&&this.opts.root!==undefined?this.opts.root:s);const i=t.rest();if(!i){this.matches.add(e,true,false);continue}else{t=i}}if(e.isENOENT())continue;let r;let o;let a=false;while(typeof(r=t.pattern())==="string"&&(o=t.rest())){const s=e.resolve(r);e=s;t=o;a=true}r=t.pattern();o=t.rest();if(a){if(this.hasWalkedCache.hasWalked(e,t))continue;this.hasWalkedCache.storeWalked(e,t)}if(typeof r==="string"){const t=r===".."||r===""||r===".";this.matches.add(e.resolve(r),n,t);continue}else if(r===i.GLOBSTAR){if(!e.isSymbolicLink()||this.follow||t.checkFollowGlobstar()){this.subwalks.add(e,t)}const s=o?.pattern();const i=o?.rest();if(!o||(s===""||s===".")&&!i){this.matches.add(e,n,s===""||s===".")}else{if(s===".."){const t=e.parent||e;if(!i)this.matches.add(t,n,true);else if(!this.hasWalkedCache.hasWalked(t,i)){this.subwalks.add(t,i)}}}}else if(r instanceof RegExp){this.subwalks.add(e,t)}}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new Processor(this.opts,this.hasWalkedCache)}filterEntries(e,t){const s=this.subwalks.get(e);const n=this.child();for(const e of t){for(const t of s){const s=t.isAbsolute();const r=t.pattern();const o=t.rest();if(r===i.GLOBSTAR){n.testGlobstar(e,t,o,s)}else if(r instanceof RegExp){n.testRegExp(e,r,o,s)}else{n.testString(e,r,o,s)}}}return n}testGlobstar(e,t,s,i){if(this.dot||!e.name.startsWith(".")){if(!t.hasMore()){this.matches.add(e,i,false)}if(e.canReaddir()){if(this.follow||!e.isSymbolicLink()){this.subwalks.add(e,t)}else if(e.isSymbolicLink()){if(s&&t.checkFollowGlobstar()){this.subwalks.add(e,s)}else if(t.markFollowGlobstar()){this.subwalks.add(e,t)}}}}if(s){const t=s.pattern();if(typeof t==="string"&&t!==".."&&t!==""&&t!=="."){this.testString(e,t,s.rest(),i)}else if(t===".."){const t=e.parent||e;this.subwalks.add(t,s)}else if(t instanceof RegExp){this.testRegExp(e,t,s.rest(),i)}}}testRegExp(e,t,s,i){if(!t.test(e.name))return;if(!s){this.matches.add(e,i,false)}else{this.subwalks.add(e,s)}}testString(e,t,s,i){if(!e.isNamed(t))return;if(!s){this.matches.add(e,i,false)}else{this.subwalks.add(e,s)}}}t.Processor=Processor},1157:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GlobStream=t.GlobWalker=t.GlobUtil=void 0;const i=s(8275);const n=s(5637);const r=s(7843);const makeIgnore=(e,t)=>typeof e==="string"?new n.Ignore([e],t):Array.isArray(e)?new n.Ignore(e,t):e;class GlobUtil{path;patterns;opts;seen=new Set;paused=false;aborted=false;#h=[];#u;#d;signal;maxDepth;includeChildMatches;constructor(e,t,s){this.patterns=e;this.path=t;this.opts=s;this.#d=!s.posix&&s.platform==="win32"?"\\":"/";this.includeChildMatches=s.includeChildMatches!==false;if(s.ignore||!this.includeChildMatches){this.#u=makeIgnore(s.ignore??[],s);if(!this.includeChildMatches&&typeof this.#u.add!=="function"){const e="cannot ignore child matches, ignore lacks add() method.";throw new Error(e)}}this.maxDepth=s.maxDepth||Infinity;if(s.signal){this.signal=s.signal;this.signal.addEventListener("abort",(()=>{this.#h.length=0}))}}#p(e){return this.seen.has(e)||!!this.#u?.ignored?.(e)}#f(e){return!!this.#u?.childrenIgnored?.(e)}pause(){this.paused=true}resume(){if(this.signal?.aborted)return;this.paused=false;let e=undefined;while(!this.paused&&(e=this.#h.shift())){e()}}onResume(e){if(this.signal?.aborted)return;if(!this.paused){e()}else{this.#h.push(e)}}async matchCheck(e,t){if(t&&this.opts.nodir)return undefined;let s;if(this.opts.realpath){s=e.realpathCached()||await e.realpath();if(!s)return undefined;e=s}const i=e.isUnknown()||this.opts.stat;const n=i?await e.lstat():e;if(this.opts.follow&&this.opts.nodir&&n?.isSymbolicLink()){const e=await n.realpath();if(e&&(e.isUnknown()||this.opts.stat)){await e.lstat()}}return this.matchCheckTest(n,t)}matchCheckTest(e,t){return e&&(this.maxDepth===Infinity||e.depth()<=this.maxDepth)&&(!t||e.canReaddir())&&(!this.opts.nodir||!e.isDirectory())&&(!this.opts.nodir||!this.opts.follow||!e.isSymbolicLink()||!e.realpathCached()?.isDirectory())&&!this.#p(e)?e:undefined}matchCheckSync(e,t){if(t&&this.opts.nodir)return undefined;let s;if(this.opts.realpath){s=e.realpathCached()||e.realpathSync();if(!s)return undefined;e=s}const i=e.isUnknown()||this.opts.stat;const n=i?e.lstatSync():e;if(this.opts.follow&&this.opts.nodir&&n?.isSymbolicLink()){const e=n.realpathSync();if(e&&(e?.isUnknown()||this.opts.stat)){e.lstatSync()}}return this.matchCheckTest(n,t)}matchFinish(e,t){if(this.#p(e))return;if(!this.includeChildMatches&&this.#u?.add){const t=`${e.relativePosix()}/**`;this.#u.add(t)}const s=this.opts.absolute===undefined?t:this.opts.absolute;this.seen.add(e);const i=this.opts.mark&&e.isDirectory()?this.#d:"";if(this.opts.withFileTypes){this.matchEmit(e)}else if(s){const t=this.opts.posix?e.fullpathPosix():e.fullpath();this.matchEmit(t+i)}else{const t=this.opts.posix?e.relativePosix():e.relative();const s=this.opts.dotRelative&&!t.startsWith(".."+this.#d)?"."+this.#d:"";this.matchEmit(!t?"."+i:s+t+i)}}async match(e,t,s){const i=await this.matchCheck(e,s);if(i)this.matchFinish(i,t)}matchSync(e,t,s){const i=this.matchCheckSync(e,s);if(i)this.matchFinish(i,t)}walkCB(e,t,s){if(this.signal?.aborted)s();this.walkCB2(e,t,new r.Processor(this.opts),s)}walkCB2(e,t,s,i){if(this.#f(e))return i();if(this.signal?.aborted)i();if(this.paused){this.onResume((()=>this.walkCB2(e,t,s,i)));return}s.processPatterns(e,t);let n=1;const next=()=>{if(--n===0)i()};for(const[e,t,i]of s.matches.entries()){if(this.#p(e))continue;n++;this.match(e,t,i).then((()=>next()))}for(const e of s.subwalkTargets()){if(this.maxDepth!==Infinity&&e.depth()>=this.maxDepth){continue}n++;const t=e.readdirCached();if(e.calledReaddir())this.walkCB3(e,t,s,next);else{e.readdirCB(((t,i)=>this.walkCB3(e,i,s,next)),true)}}next()}walkCB3(e,t,s,i){s=s.filterEntries(e,t);let n=1;const next=()=>{if(--n===0)i()};for(const[e,t,i]of s.matches.entries()){if(this.#p(e))continue;n++;this.match(e,t,i).then((()=>next()))}for(const[e,t]of s.subwalks.entries()){n++;this.walkCB2(e,t,s.child(),next)}next()}walkCBSync(e,t,s){if(this.signal?.aborted)s();this.walkCB2Sync(e,t,new r.Processor(this.opts),s)}walkCB2Sync(e,t,s,i){if(this.#f(e))return i();if(this.signal?.aborted)i();if(this.paused){this.onResume((()=>this.walkCB2Sync(e,t,s,i)));return}s.processPatterns(e,t);let n=1;const next=()=>{if(--n===0)i()};for(const[e,t,i]of s.matches.entries()){if(this.#p(e))continue;this.matchSync(e,t,i)}for(const e of s.subwalkTargets()){if(this.maxDepth!==Infinity&&e.depth()>=this.maxDepth){continue}n++;const t=e.readdirSync();this.walkCB3Sync(e,t,s,next)}next()}walkCB3Sync(e,t,s,i){s=s.filterEntries(e,t);let n=1;const next=()=>{if(--n===0)i()};for(const[e,t,i]of s.matches.entries()){if(this.#p(e))continue;this.matchSync(e,t,i)}for(const[e,t]of s.subwalks.entries()){n++;this.walkCB2Sync(e,t,s.child(),next)}next()}}t.GlobUtil=GlobUtil;class GlobWalker extends GlobUtil{matches=new Set;constructor(e,t,s){super(e,t,s)}matchEmit(e){this.matches.add(e)}async walk(){if(this.signal?.aborted)throw this.signal.reason;if(this.path.isUnknown()){await this.path.lstat()}await new Promise(((e,t)=>{this.walkCB(this.path,this.patterns,(()=>{if(this.signal?.aborted){t(this.signal.reason)}else{e(this.matches)}}))}));return this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;if(this.path.isUnknown()){this.path.lstatSync()}this.walkCBSync(this.path,this.patterns,(()=>{if(this.signal?.aborted)throw this.signal.reason}));return this.matches}}t.GlobWalker=GlobWalker;class GlobStream extends GlobUtil{results;constructor(e,t,s){super(e,t,s);this.results=new i.Minipass({signal:this.signal,objectMode:true});this.results.on("drain",(()=>this.resume()));this.results.on("resume",(()=>this.resume()))}matchEmit(e){this.results.write(e);if(!this.results.flowing)this.pause()}stream(){const e=this.path;if(e.isUnknown()){e.lstat().then((()=>{this.walkCB(e,this.patterns,(()=>this.results.end()))}))}else{this.walkCB(e,this.patterns,(()=>this.results.end()))}return this.results}streamSync(){if(this.path.isUnknown()){this.path.lstatSync()}this.walkCBSync(this.path,this.patterns,(()=>this.results.end()));return this.results}}t.GlobStream=GlobStream},8895:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.assertValidPattern=void 0;const s=1024*64;const assertValidPattern=e=>{if(typeof e!=="string"){throw new TypeError("invalid pattern")}if(e.length>s){throw new TypeError("pattern is too long")}};t.assertValidPattern=assertValidPattern},3238:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AST=void 0;const i=s(2811);const n=s(9829);const r=new Set(["!","?","+","*","@"]);const isExtglobType=e=>r.has(e);const o="(?!(?:^|/)\\.\\.?(?:$|/))";const a="(?!\\.)";const l=new Set(["[","."]);const c=new Set(["..","."]);const h=new Set("().*{}+?[]^$\\!");const regExpEscape=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");const u="[^/]";const d=u+"*?";const p=u+"+?";class AST{type;#m;#g;#y=false;#w=[];#b;#E;#S;#k=false;#T;#x;#v=false;constructor(e,t,s={}){this.type=e;if(e)this.#g=true;this.#b=t;this.#m=this.#b?this.#b.#m:this;this.#T=this.#m===this?s:this.#m.#T;this.#S=this.#m===this?[]:this.#m.#S;if(e==="!"&&!this.#m.#k)this.#S.push(this);this.#E=this.#b?this.#b.#w.length:0}get hasMagic(){if(this.#g!==undefined)return this.#g;for(const e of this.#w){if(typeof e==="string")continue;if(e.type||e.hasMagic)return this.#g=true}return this.#g}toString(){if(this.#x!==undefined)return this.#x;if(!this.type){return this.#x=this.#w.map((e=>String(e))).join("")}else{return this.#x=this.type+"("+this.#w.map((e=>String(e))).join("|")+")"}}#_(){if(this!==this.#m)throw new Error("should only call on root");if(this.#k)return this;this.toString();this.#k=true;let e;while(e=this.#S.pop()){if(e.type!=="!")continue;let t=e;let s=t.#b;while(s){for(let i=t.#E+1;!s.type&&i<s.#w.length;i++){for(const t of e.#w){if(typeof t==="string"){throw new Error("string part in extglob AST??")}t.copyIn(s.#w[i])}}t=s;s=t.#b}}return this}push(...e){for(const t of e){if(t==="")continue;if(typeof t!=="string"&&!(t instanceof AST&&t.#b===this)){throw new Error("invalid part: "+t)}this.#w.push(t)}}toJSON(){const e=this.type===null?this.#w.slice().map((e=>typeof e==="string"?e:e.toJSON())):[this.type,...this.#w.map((e=>e.toJSON()))];if(this.isStart()&&!this.type)e.unshift([]);if(this.isEnd()&&(this===this.#m||this.#m.#k&&this.#b?.type==="!")){e.push({})}return e}isStart(){if(this.#m===this)return true;if(!this.#b?.isStart())return false;if(this.#E===0)return true;const e=this.#b;for(let t=0;t<this.#E;t++){const s=e.#w[t];if(!(s instanceof AST&&s.type==="!")){return false}}return true}isEnd(){if(this.#m===this)return true;if(this.#b?.type==="!")return true;if(!this.#b?.isEnd())return false;if(!this.type)return this.#b?.isEnd();const e=this.#b?this.#b.#w.length:0;return this.#E===e-1}copyIn(e){if(typeof e==="string")this.push(e);else this.push(e.clone(this))}clone(e){const t=new AST(this.type,e);for(const e of this.#w){t.copyIn(e)}return t}static#C(e,t,s,i){let n=false;let r=false;let o=-1;let a=false;if(t.type===null){let l=s;let c="";while(l<e.length){const s=e.charAt(l++);if(n||s==="\\"){n=!n;c+=s;continue}if(r){if(l===o+1){if(s==="^"||s==="!"){a=true}}else if(s==="]"&&!(l===o+2&&a)){r=false}c+=s;continue}else if(s==="["){r=true;o=l;a=false;c+=s;continue}if(!i.noext&&isExtglobType(s)&&e.charAt(l)==="("){t.push(c);c="";const n=new AST(s,t);l=AST.#C(e,n,l,i);t.push(n);continue}c+=s}t.push(c);return l}let l=s+1;let c=new AST(null,t);const h=[];let u="";while(l<e.length){const s=e.charAt(l++);if(n||s==="\\"){n=!n;u+=s;continue}if(r){if(l===o+1){if(s==="^"||s==="!"){a=true}}else if(s==="]"&&!(l===o+2&&a)){r=false}u+=s;continue}else if(s==="["){r=true;o=l;a=false;u+=s;continue}if(isExtglobType(s)&&e.charAt(l)==="("){c.push(u);u="";const t=new AST(s,c);c.push(t);l=AST.#C(e,t,l,i);continue}if(s==="|"){c.push(u);u="";h.push(c);c=new AST(null,t);continue}if(s===")"){if(u===""&&t.#w.length===0){t.#v=true}c.push(u);u="";t.push(...h,c);return l}u+=s}t.type=null;t.#g=undefined;t.#w=[e.substring(s-1)];return l}static fromGlob(e,t={}){const s=new AST(null,undefined,t);AST.#C(e,s,0,t);return s}toMMPattern(){if(this!==this.#m)return this.#m.toMMPattern();const e=this.toString();const[t,s,i,n]=this.toRegExpSource();const r=i||this.#g||this.#T.nocase&&!this.#T.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase();if(!r){return s}const o=(this.#T.nocase?"i":"")+(n?"u":"");return Object.assign(new RegExp(`^${t}$`,o),{_src:t,_glob:e})}get options(){return this.#T}toRegExpSource(e){const t=e??!!this.#T.dot;if(this.#m===this)this.#_();if(!this.type){const s=this.isStart()&&this.isEnd()&&!this.#w.some((e=>typeof e!=="string"));const i=this.#w.map((t=>{const[i,n,r,o]=typeof t==="string"?AST.#R(t,this.#g,s):t.toRegExpSource(e);this.#g=this.#g||r;this.#y=this.#y||o;return i})).join("");let r="";if(this.isStart()){if(typeof this.#w[0]==="string"){const s=this.#w.length===1&&c.has(this.#w[0]);if(!s){const s=l;const n=t&&s.has(i.charAt(0))||i.startsWith("\\.")&&s.has(i.charAt(2))||i.startsWith("\\.\\.")&&s.has(i.charAt(4));const c=!t&&!e&&s.has(i.charAt(0));r=n?o:c?a:""}}}let h="";if(this.isEnd()&&this.#m.#k&&this.#b?.type==="!"){h="(?:$|\\/)"}const u=r+i+h;return[u,(0,n.unescape)(i),this.#g=!!this.#g,this.#y]}const s=this.type==="*"||this.type==="+";const i=this.type==="!"?"(?:(?!(?:":"(?:";let r=this.#A(t);if(this.isStart()&&this.isEnd()&&!r&&this.type!=="!"){const e=this.toString();this.#w=[e];this.type=null;this.#g=undefined;return[e,(0,n.unescape)(this.toString()),false,false]}let h=!s||e||t||!a?"":this.#A(true);if(h===r){h=""}if(h){r=`(?:${r})(?:${h})*?`}let u="";if(this.type==="!"&&this.#v){u=(this.isStart()&&!t?a:"")+p}else{const s=this.type==="!"?"))"+(this.isStart()&&!t&&!e?a:"")+d+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&h?")":this.type==="*"&&h?`)?`:`)${this.type}`;u=i+r+s}return[u,(0,n.unescape)(r),this.#g=!!this.#g,this.#y]}#A(e){return this.#w.map((t=>{if(typeof t==="string"){throw new Error("string type in extglob ast??")}const[s,i,n,r]=t.toRegExpSource(e);this.#y=this.#y||r;return s})).filter((e=>!(this.isStart()&&this.isEnd())||!!e)).join("|")}static#R(e,t,s=false){let r=false;let o="";let a=false;for(let n=0;n<e.length;n++){const l=e.charAt(n);if(r){r=false;o+=(h.has(l)?"\\":"")+l;continue}if(l==="\\"){if(n===e.length-1){o+="\\\\"}else{r=true}continue}if(l==="["){const[s,r,l,c]=(0,i.parseClass)(e,n);if(l){o+=s;a=a||r;n+=l-1;t=t||c;continue}}if(l==="*"){o+=s&&e==="*"?p:d;t=true;continue}if(l==="?"){o+=u;t=true;continue}o+=regExpEscape(l)}return[o,(0,n.unescape)(e),!!t,a]}}t.AST=AST},2811:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.parseClass=void 0;const s={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",true],"[:alpha:]":["\\p{L}\\p{Nl}",true],"[:ascii:]":["\\x"+"00-\\x"+"7f",false],"[:blank:]":["\\p{Zs}\\t",true],"[:cntrl:]":["\\p{Cc}",true],"[:digit:]":["\\p{Nd}",true],"[:graph:]":["\\p{Z}\\p{C}",true,true],"[:lower:]":["\\p{Ll}",true],"[:print:]":["\\p{C}",true],"[:punct:]":["\\p{P}",true],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",true],"[:upper:]":["\\p{Lu}",true],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",true],"[:xdigit:]":["A-Fa-f0-9",false]};const braceEscape=e=>e.replace(/[[\]\\-]/g,"\\$&");const regexpEscape=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");const rangesToString=e=>e.join("");const parseClass=(e,t)=>{const i=t;if(e.charAt(i)!=="["){throw new Error("not in a brace expression")}const n=[];const r=[];let o=i+1;let a=false;let l=false;let c=false;let h=false;let u=i;let d="";e:while(o<e.length){const t=e.charAt(o);if((t==="!"||t==="^")&&o===i+1){h=true;o++;continue}if(t==="]"&&a&&!c){u=o+1;break}a=true;if(t==="\\"){if(!c){c=true;o++;continue}}if(t==="["&&!c){for(const[t,[a,c,h]]of Object.entries(s)){if(e.startsWith(t,o)){if(d){return["$.",false,e.length-i,true]}o+=t.length;if(h)r.push(a);else n.push(a);l=l||c;continue e}}}c=false;if(d){if(t>d){n.push(braceEscape(d)+"-"+braceEscape(t))}else if(t===d){n.push(braceEscape(t))}d="";o++;continue}if(e.startsWith("-]",o+1)){n.push(braceEscape(t+"-"));o+=2;continue}if(e.startsWith("-",o+1)){d=t;o+=2;continue}n.push(braceEscape(t));o++}if(u<o){return["",false,0,false]}if(!n.length&&!r.length){return["$.",false,e.length-i,true]}if(r.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!h){const e=n[0].length===2?n[0].slice(-1):n[0];return[regexpEscape(e),false,u-i,false]}const p="["+(h?"^":"")+rangesToString(n)+"]";const f="["+(h?"":"^")+rangesToString(r)+"]";const g=n.length&&r.length?"("+p+"|"+f+")":n.length?p:f;return[g,l,u-i,true]};t.parseClass=parseClass},6726:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.escape=void 0;const escape=(e,{windowsPathsNoEscape:t=false,magicalBraces:s=false}={})=>{if(s){return t?e.replace(/[?*()[\]{}]/g,"[$&]"):e.replace(/[?*()[\]\\{}]/g,"\\$&")}return t?e.replace(/[?*()[\]]/g,"[$&]"):e.replace(/[?*()[\]\\]/g,"\\$&")};t.escape=escape},1409:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.unescape=t.escape=t.AST=t.Minimatch=t.match=t.makeRe=t.braceExpand=t.defaults=t.filter=t.GLOBSTAR=t.sep=t.minimatch=void 0;const i=s(1215);const n=s(8895);const r=s(3238);const o=s(6726);const a=s(9829);const minimatch=(e,t,s={})=>{(0,n.assertValidPattern)(t);if(!s.nocomment&&t.charAt(0)==="#"){return false}return new Minimatch(t,s).match(e)};t.minimatch=minimatch;const l=/^\*+([^+@!?\*\[\(]*)$/;const starDotExtTest=e=>t=>!t.startsWith(".")&&t.endsWith(e);const starDotExtTestDot=e=>t=>t.endsWith(e);const starDotExtTestNocase=e=>{e=e.toLowerCase();return t=>!t.startsWith(".")&&t.toLowerCase().endsWith(e)};const starDotExtTestNocaseDot=e=>{e=e.toLowerCase();return t=>t.toLowerCase().endsWith(e)};const c=/^\*+\.\*+$/;const starDotStarTest=e=>!e.startsWith(".")&&e.includes(".");const starDotStarTestDot=e=>e!=="."&&e!==".."&&e.includes(".");const h=/^\.\*+$/;const dotStarTest=e=>e!=="."&&e!==".."&&e.startsWith(".");const u=/^\*+$/;const starTest=e=>e.length!==0&&!e.startsWith(".");const starTestDot=e=>e.length!==0&&e!=="."&&e!=="..";const d=/^\?+([^+@!?\*\[\(]*)?$/;const qmarksTestNocase=([e,t=""])=>{const s=qmarksTestNoExt([e]);if(!t)return s;t=t.toLowerCase();return e=>s(e)&&e.toLowerCase().endsWith(t)};const qmarksTestNocaseDot=([e,t=""])=>{const s=qmarksTestNoExtDot([e]);if(!t)return s;t=t.toLowerCase();return e=>s(e)&&e.toLowerCase().endsWith(t)};const qmarksTestDot=([e,t=""])=>{const s=qmarksTestNoExtDot([e]);return!t?s:e=>s(e)&&e.endsWith(t)};const qmarksTest=([e,t=""])=>{const s=qmarksTestNoExt([e]);return!t?s:e=>s(e)&&e.endsWith(t)};const qmarksTestNoExt=([e])=>{const t=e.length;return e=>e.length===t&&!e.startsWith(".")};const qmarksTestNoExtDot=([e])=>{const t=e.length;return e=>e.length===t&&e!=="."&&e!==".."};const p=typeof process==="object"&&process?typeof process.env==="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";const f={win32:{sep:"\\"},posix:{sep:"/"}};t.sep=p==="win32"?f.win32.sep:f.posix.sep;t.minimatch.sep=t.sep;t.GLOBSTAR=Symbol("globstar **");t.minimatch.GLOBSTAR=t.GLOBSTAR;const g="[^/]";const y=g+"*?";const w="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?";const b="(?:(?!(?:\\/|^)\\.).)*?";const filter=(e,s={})=>i=>(0,t.minimatch)(i,e,s);t.filter=filter;t.minimatch.filter=t.filter;const ext=(e,t={})=>Object.assign({},e,t);const defaults=e=>{if(!e||typeof e!=="object"||!Object.keys(e).length){return t.minimatch}const s=t.minimatch;const m=(t,i,n={})=>s(t,i,ext(e,n));return Object.assign(m,{Minimatch:class Minimatch extends s.Minimatch{constructor(t,s={}){super(t,ext(e,s))}static defaults(t){return s.defaults(ext(e,t)).Minimatch}},AST:class AST extends s.AST{constructor(t,s,i={}){super(t,s,ext(e,i))}static fromGlob(t,i={}){return s.AST.fromGlob(t,ext(e,i))}},unescape:(t,i={})=>s.unescape(t,ext(e,i)),escape:(t,i={})=>s.escape(t,ext(e,i)),filter:(t,i={})=>s.filter(t,ext(e,i)),defaults:t=>s.defaults(ext(e,t)),makeRe:(t,i={})=>s.makeRe(t,ext(e,i)),braceExpand:(t,i={})=>s.braceExpand(t,ext(e,i)),match:(t,i,n={})=>s.match(t,i,ext(e,n)),sep:s.sep,GLOBSTAR:t.GLOBSTAR})};t.defaults=defaults;t.minimatch.defaults=t.defaults;const braceExpand=(e,t={})=>{(0,n.assertValidPattern)(e);if(t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)){return[e]}return(0,i.expand)(e)};t.braceExpand=braceExpand;t.minimatch.braceExpand=t.braceExpand;const makeRe=(e,t={})=>new Minimatch(e,t).makeRe();t.makeRe=makeRe;t.minimatch.makeRe=t.makeRe;const match=(e,t,s={})=>{const i=new Minimatch(t,s);e=e.filter((e=>i.match(e)));if(i.options.nonull&&!e.length){e.push(t)}return e};t.match=match;t.minimatch.match=t.match;const E=/[?*]|[+@!]\(.*?\)|\[|\]/;const regExpEscape=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");class Minimatch{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){(0,n.assertValidPattern)(e);t=t||{};this.options=t;this.pattern=e;this.platform=t.platform||p;this.isWindows=this.platform==="win32";this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===false;if(this.windowsPathsNoEscape){this.pattern=this.pattern.replace(/\\/g,"/")}this.preserveMultipleSlashes=!!t.preserveMultipleSlashes;this.regexp=null;this.negate=false;this.nonegate=!!t.nonegate;this.comment=false;this.empty=false;this.partial=!!t.partial;this.nocase=!!this.options.nocase;this.windowsNoMagicRoot=t.windowsNoMagicRoot!==undefined?t.windowsNoMagicRoot:!!(this.isWindows&&this.nocase);this.globSet=[];this.globParts=[];this.set=[];this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1){return true}for(const e of this.set){for(const t of e){if(typeof t!=="string")return true}}return false}debug(...e){}make(){const e=this.pattern;const t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=true;return}if(!e){this.empty=true;return}this.parseNegate();this.globSet=[...new Set(this.braceExpand())];if(t.debug){this.debug=(...e)=>console.error(...e)}this.debug(this.pattern,this.globSet);const s=this.globSet.map((e=>this.slashSplit(e)));this.globParts=this.preprocess(s);this.debug(this.pattern,this.globParts);let i=this.globParts.map(((e,t,s)=>{if(this.isWindows&&this.windowsNoMagicRoot){const t=e[0]===""&&e[1]===""&&(e[2]==="?"||!E.test(e[2]))&&!E.test(e[3]);const s=/^[a-z]:/i.test(e[0]);if(t){return[...e.slice(0,4),...e.slice(4).map((e=>this.parse(e)))]}else if(s){return[e[0],...e.slice(1).map((e=>this.parse(e)))]}}return e.map((e=>this.parse(e)))}));this.debug(this.pattern,i);this.set=i.filter((e=>e.indexOf(false)===-1));if(this.isWindows){for(let e=0;e<this.set.length;e++){const t=this.set[e];if(t[0]===""&&t[1]===""&&this.globParts[e][2]==="?"&&typeof t[3]==="string"&&/^[a-z]:$/i.test(t[3])){t[2]="?"}}}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar){for(let t=0;t<e.length;t++){for(let s=0;s<e[t].length;s++){if(e[t][s]==="**"){e[t][s]="*"}}}}const{optimizationLevel:t=1}=this.options;if(t>=2){e=this.firstPhasePreProcess(e);e=this.secondPhasePreProcess(e)}else if(t>=1){e=this.levelOneOptimize(e)}else{e=this.adjascentGlobstarOptimize(e)}return e}adjascentGlobstarOptimize(e){return e.map((e=>{let t=-1;while(-1!==(t=e.indexOf("**",t+1))){let s=t;while(e[s+1]==="**"){s++}if(s!==t){e.splice(t,s-t)}}return e}))}levelOneOptimize(e){return e.map((e=>{e=e.reduce(((e,t)=>{const s=e[e.length-1];if(t==="**"&&s==="**"){return e}if(t===".."){if(s&&s!==".."&&s!=="."&&s!=="**"){e.pop();return e}}e.push(t);return e}),[]);return e.length===0?[""]:e}))}levelTwoFileOptimize(e){if(!Array.isArray(e)){e=this.slashSplit(e)}let t=false;do{t=false;if(!this.preserveMultipleSlashes){for(let s=1;s<e.length-1;s++){const i=e[s];if(s===1&&i===""&&e[0]==="")continue;if(i==="."||i===""){t=true;e.splice(s,1);s--}}if(e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")){t=true;e.pop()}}let s=0;while(-1!==(s=e.indexOf("..",s+1))){const i=e[s-1];if(i&&i!=="."&&i!==".."&&i!=="**"){t=true;e.splice(s-1,2);s-=2}}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=false;do{t=false;for(let s of e){let i=-1;while(-1!==(i=s.indexOf("**",i+1))){let n=i;while(s[n+1]==="**"){n++}if(n>i){s.splice(i+1,n-i)}let r=s[i+1];const o=s[i+2];const a=s[i+3];if(r!=="..")continue;if(!o||o==="."||o===".."||!a||a==="."||a===".."){continue}t=true;s.splice(i,1);const l=s.slice(0);l[i]="**";e.push(l);i--}if(!this.preserveMultipleSlashes){for(let e=1;e<s.length-1;e++){const i=s[e];if(e===1&&i===""&&s[0]==="")continue;if(i==="."||i===""){t=true;s.splice(e,1);e--}}if(s[0]==="."&&s.length===2&&(s[1]==="."||s[1]==="")){t=true;s.pop()}}let n=0;while(-1!==(n=s.indexOf("..",n+1))){const e=s[n-1];if(e&&e!=="."&&e!==".."&&e!=="**"){t=true;const e=n===1&&s[n+1]==="**";const i=e?["."]:[];s.splice(n-1,2,...i);if(s.length===0)s.push("");n-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++){for(let s=t+1;s<e.length;s++){const i=this.partsMatch(e[t],e[s],!this.preserveMultipleSlashes);if(i){e[t]=[];e[s]=i;break}}}return e.filter((e=>e.length))}partsMatch(e,t,s=false){let i=0;let n=0;let r=[];let o="";while(i<e.length&&n<t.length){if(e[i]===t[n]){r.push(o==="b"?t[n]:e[i]);i++;n++}else if(s&&e[i]==="**"&&t[n]===e[i+1]){r.push(e[i]);i++}else if(s&&t[n]==="**"&&e[i]===t[n+1]){r.push(t[n]);n++}else if(e[i]==="*"&&t[n]&&(this.options.dot||!t[n].startsWith("."))&&t[n]!=="**"){if(o==="b")return false;o="a";r.push(e[i]);i++;n++}else if(t[n]==="*"&&e[i]&&(this.options.dot||!e[i].startsWith("."))&&e[i]!=="**"){if(o==="a")return false;o="b";r.push(t[n]);i++;n++}else{return false}}return e.length===t.length&&r}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=false;let s=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++){t=!t;s++}if(s)this.pattern=e.slice(s);this.negate=t}matchOne(e,s,i=false){const n=this.options;if(this.isWindows){const t=typeof e[0]==="string"&&/^[a-z]:$/i.test(e[0]);const i=!t&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]);const n=typeof s[0]==="string"&&/^[a-z]:$/i.test(s[0]);const r=!n&&s[0]===""&&s[1]===""&&s[2]==="?"&&typeof s[3]==="string"&&/^[a-z]:$/i.test(s[3]);const o=i?3:t?0:undefined;const a=r?3:n?0:undefined;if(typeof o==="number"&&typeof a==="number"){const[t,i]=[e[o],s[a]];if(t.toLowerCase()===i.toLowerCase()){s[a]=t;if(a>o){s=s.slice(a)}else if(o>a){e=e.slice(o)}}}}const{optimizationLevel:r=1}=this.options;if(r>=2){e=this.levelTwoFileOptimize(e)}this.debug("matchOne",this,{file:e,pattern:s});this.debug("matchOne",e.length,s.length);for(var o=0,a=0,l=e.length,c=s.length;o<l&&a<c;o++,a++){this.debug("matchOne loop");var h=s[a];var u=e[o];this.debug(s,h,u);if(h===false){return false}if(h===t.GLOBSTAR){this.debug("GLOBSTAR",[s,h,u]);var d=o;var p=a+1;if(p===c){this.debug("** at the end");for(;o<l;o++){if(e[o]==="."||e[o]===".."||!n.dot&&e[o].charAt(0)===".")return false}return true}while(d<l){var f=e[d];this.debug("\nglobstar while",e,d,s,p,f);if(this.matchOne(e.slice(d),s.slice(p),i)){this.debug("globstar found match!",d,l,f);return true}else{if(f==="."||f===".."||!n.dot&&f.charAt(0)==="."){this.debug("dot detected!",e,d,s,p);break}this.debug("globstar swallow a segment, and continue");d++}}if(i){this.debug("\n>>> no match, partial?",e,d,s,p);if(d===l){return true}}return false}let r;if(typeof h==="string"){r=u===h;this.debug("string match",h,u,r)}else{r=h.test(u);this.debug("pattern match",h,u,r)}if(!r)return false}if(o===l&&a===c){return true}else if(o===l){return i}else if(a===c){return o===l-1&&e[o]===""}else{throw new Error("wtf?")}}braceExpand(){return(0,t.braceExpand)(this.pattern,this.options)}parse(e){(0,n.assertValidPattern)(e);const s=this.options;if(e==="**")return t.GLOBSTAR;if(e==="")return"";let i;let o=null;if(i=e.match(u)){o=s.dot?starTestDot:starTest}else if(i=e.match(l)){o=(s.nocase?s.dot?starDotExtTestNocaseDot:starDotExtTestNocase:s.dot?starDotExtTestDot:starDotExtTest)(i[1])}else if(i=e.match(d)){o=(s.nocase?s.dot?qmarksTestNocaseDot:qmarksTestNocase:s.dot?qmarksTestDot:qmarksTest)(i)}else if(i=e.match(c)){o=s.dot?starDotStarTestDot:starDotStarTest}else if(i=e.match(h)){o=dotStarTest}const a=r.AST.fromGlob(e,this.options).toMMPattern();if(o&&typeof a==="object"){Reflect.defineProperty(a,"test",{value:o})}return a}makeRe(){if(this.regexp||this.regexp===false)return this.regexp;const e=this.set;if(!e.length){this.regexp=false;return this.regexp}const s=this.options;const i=s.noglobstar?y:s.dot?w:b;const n=new Set(s.nocase?["i"]:[]);let r=e.map((e=>{const s=e.map((e=>{if(e instanceof RegExp){for(const t of e.flags.split(""))n.add(t)}return typeof e==="string"?regExpEscape(e):e===t.GLOBSTAR?t.GLOBSTAR:e._src}));s.forEach(((e,n)=>{const r=s[n+1];const o=s[n-1];if(e!==t.GLOBSTAR||o===t.GLOBSTAR){return}if(o===undefined){if(r!==undefined&&r!==t.GLOBSTAR){s[n+1]="(?:\\/|"+i+"\\/)?"+r}else{s[n]=i}}else if(r===undefined){s[n-1]=o+"(?:\\/|\\/"+i+")?"}else if(r!==t.GLOBSTAR){s[n-1]=o+"(?:\\/|\\/"+i+"\\/)"+r;s[n+1]=t.GLOBSTAR}}));const r=s.filter((e=>e!==t.GLOBSTAR));if(this.partial&&r.length>=1){const e=[];for(let t=1;t<=r.length;t++){e.push(r.slice(0,t).join("/"))}return"(?:"+e.join("|")+")"}return r.join("/")})).join("|");const[o,a]=e.length>1?["(?:",")"]:["",""];r="^"+o+r+a+"$";if(this.partial){r="^(?:\\/|"+o+r.slice(1,-1)+a+")$"}if(this.negate)r="^(?!"+r+").+$";try{this.regexp=new RegExp(r,[...n].join(""))}catch(e){this.regexp=false}return this.regexp}slashSplit(e){if(this.preserveMultipleSlashes){return e.split("/")}else if(this.isWindows&&/^\/\/[^\/]+/.test(e)){return["",...e.split(/\/+/)]}else{return e.split(/\/+/)}}match(e,t=this.partial){this.debug("match",e,this.pattern);if(this.comment){return false}if(this.empty){return e===""}if(e==="/"&&t){return true}const s=this.options;if(this.isWindows){e=e.split("\\").join("/")}const i=this.slashSplit(e);this.debug(this.pattern,"split",i);const n=this.set;this.debug(this.pattern,"set",n);let r=i[i.length-1];if(!r){for(let e=i.length-2;!r&&e>=0;e--){r=i[e]}}for(let e=0;e<n.length;e++){const o=n[e];let a=i;if(s.matchBase&&o.length===1){a=[r]}const l=this.matchOne(a,o,t);if(l){if(s.flipNegate){return true}return!this.negate}}if(s.flipNegate){return false}return this.negate}static defaults(e){return t.minimatch.defaults(e).Minimatch}}t.Minimatch=Minimatch;var S=s(3238);Object.defineProperty(t,"AST",{enumerable:true,get:function(){return S.AST}});var k=s(6726);Object.defineProperty(t,"escape",{enumerable:true,get:function(){return k.escape}});var T=s(9829);Object.defineProperty(t,"unescape",{enumerable:true,get:function(){return T.unescape}});t.minimatch.AST=r.AST;t.minimatch.Minimatch=Minimatch;t.minimatch.escape=o.escape;t.minimatch.unescape=a.unescape},9829:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.unescape=void 0;const unescape=(e,{windowsPathsNoEscape:t=false,magicalBraces:s=true}={})=>{if(s){return t?e.replace(/\[([^\/\\])\]/g,"$1"):e.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")}return t?e.replace(/\[([^\/\\{}])\]/g,"$1"):e.replace(/((?!\\).|^)\[([^\/\\{}])\]/g,"$1$2").replace(/\\([^\/{}])/g,"$1")};t.unescape=unescape},2477:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LRUCache=void 0;const s=typeof performance==="object"&&performance&&typeof performance.now==="function"?performance:Date;const i=new Set;const n=typeof process==="object"&&!!process?process:{};const emitWarning=(e,t,s,i)=>{typeof n.emitWarning==="function"?n.emitWarning(e,t,s,i):console.error(`[${s}] ${t}: ${e}`)};let r=globalThis.AbortController;let o=globalThis.AbortSignal;if(typeof r==="undefined"){o=class AbortSignal{onabort;_onabort=[];reason;aborted=false;addEventListener(e,t){this._onabort.push(t)}};r=class AbortController{constructor(){warnACPolyfill()}signal=new o;abort(e){if(this.signal.aborted)return;this.signal.reason=e;this.signal.aborted=true;for(const t of this.signal._onabort){t(e)}this.signal.onabort?.(e)}};let e=n.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1";const warnACPolyfill=()=>{if(!e)return;e=false;emitWarning("AbortController is not defined. If using lru-cache in "+"node 14, load an AbortController polyfill from the "+"`node-abort-controller` package. A minimal polyfill is "+"provided for use by LRUCache.fetch(), but it should not be "+"relied upon in other contexts (eg, passing it to other APIs that "+"use AbortController/AbortSignal might have undesirable effects). "+"You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",warnACPolyfill)}}const shouldWarn=e=>!i.has(e);const a=Symbol("type");const isPosInt=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e);const getUintArray=e=>!isPosInt(e)?null:e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?ZeroArray:null;class ZeroArray extends Array{constructor(e){super(e);this.fill(0)}}class Stack{heap;length;static#M=false;static create(e){const t=getUintArray(e);if(!t)return[];Stack.#M=true;const s=new Stack(e,t);Stack.#M=false;return s}constructor(e,t){if(!Stack.#M){throw new TypeError("instantiate Stack using Stack.create(n)")}this.heap=new t(e);this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class LRUCache{#O;#P;#I;#L;#N;#D;#B;#G;get perf(){return this.#G}ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#U;#F;#$;#W;#j;#z;#q;#H;#Y;#K;#V;#J;#X;#Q;#Z;#ee;#te;#se;static unsafeExposeInternals(e){return{starts:e.#X,ttls:e.#Q,sizes:e.#J,keyMap:e.#$,keyList:e.#W,valList:e.#j,next:e.#z,prev:e.#q,get head(){return e.#H},get tail(){return e.#Y},free:e.#K,isBackgroundFetch:t=>e.#ie(t),backgroundFetch:(t,s,i,n)=>e.#ne(t,s,i,n),moveToTail:t=>e.#re(t),indexes:t=>e.#oe(t),rindexes:t=>e.#ae(t),isStale:t=>e.#le(t)}}get max(){return this.#O}get maxSize(){return this.#P}get calculatedSize(){return this.#F}get size(){return this.#U}get fetchMethod(){return this.#D}get memoMethod(){return this.#B}get dispose(){return this.#I}get onInsert(){return this.#L}get disposeAfter(){return this.#N}constructor(e){const{max:t=0,ttl:n,ttlResolution:r=1,ttlAutopurge:o,updateAgeOnGet:a,updateAgeOnHas:l,allowStale:c,dispose:h,onInsert:u,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:g=0,maxEntrySize:y=0,sizeCalculation:w,fetchMethod:b,memoMethod:E,noDeleteOnFetchRejection:S,noDeleteOnStaleGet:k,allowStaleOnFetchRejection:T,allowStaleOnFetchAbort:x,ignoreFetchAbort:v,perf:_}=e;if(_!==undefined){if(typeof _?.now!=="function"){throw new TypeError("perf option must have a now() method if specified")}}this.#G=_??s;if(t!==0&&!isPosInt(t)){throw new TypeError("max option must be a nonnegative integer")}const C=t?getUintArray(t):Array;if(!C){throw new Error("invalid max value: "+t)}this.#O=t;this.#P=g;this.maxEntrySize=y||this.#P;this.sizeCalculation=w;if(this.sizeCalculation){if(!this.#P&&!this.maxEntrySize){throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize")}if(typeof this.sizeCalculation!=="function"){throw new TypeError("sizeCalculation set to non-function")}}if(E!==undefined&&typeof E!=="function"){throw new TypeError("memoMethod must be a function if defined")}this.#B=E;if(b!==undefined&&typeof b!=="function"){throw new TypeError("fetchMethod must be a function if specified")}this.#D=b;this.#ee=!!b;this.#$=new Map;this.#W=new Array(t).fill(undefined);this.#j=new Array(t).fill(undefined);this.#z=new C(t);this.#q=new C(t);this.#H=0;this.#Y=0;this.#K=Stack.create(t);this.#U=0;this.#F=0;if(typeof h==="function"){this.#I=h}if(typeof u==="function"){this.#L=u}if(typeof d==="function"){this.#N=d;this.#V=[]}else{this.#N=undefined;this.#V=undefined}this.#Z=!!this.#I;this.#se=!!this.#L;this.#te=!!this.#N;this.noDisposeOnSet=!!p;this.noUpdateTTL=!!f;this.noDeleteOnFetchRejection=!!S;this.allowStaleOnFetchRejection=!!T;this.allowStaleOnFetchAbort=!!x;this.ignoreFetchAbort=!!v;if(this.maxEntrySize!==0){if(this.#P!==0){if(!isPosInt(this.#P)){throw new TypeError("maxSize must be a positive integer if specified")}}if(!isPosInt(this.maxEntrySize)){throw new TypeError("maxEntrySize must be a positive integer if specified")}this.#ce()}this.allowStale=!!c;this.noDeleteOnStaleGet=!!k;this.updateAgeOnGet=!!a;this.updateAgeOnHas=!!l;this.ttlResolution=isPosInt(r)||r===0?r:1;this.ttlAutopurge=!!o;this.ttl=n||0;if(this.ttl){if(!isPosInt(this.ttl)){throw new TypeError("ttl must be a positive integer if specified")}this.#he()}if(this.#O===0&&this.ttl===0&&this.#P===0){throw new TypeError("At least one of max, maxSize, or ttl is required")}if(!this.ttlAutopurge&&!this.#O&&!this.#P){const e="LRU_CACHE_UNBOUNDED";if(shouldWarn(e)){i.add(e);const t="TTL caching without ttlAutopurge, max, or maxSize can "+"result in unbounded memory consumption.";emitWarning(t,"UnboundedCacheWarning",e,LRUCache)}}}getRemainingTTL(e){return this.#$.has(e)?Infinity:0}#he(){const e=new ZeroArray(this.#O);const t=new ZeroArray(this.#O);this.#Q=e;this.#X=t;this.#ue=(s,i,n=this.#G.now())=>{t[s]=i!==0?n:0;e[s]=i;if(i!==0&&this.ttlAutopurge){const e=setTimeout((()=>{if(this.#le(s)){this.#de(this.#W[s],"expire")}}),i+1);if(e.unref){e.unref()}}};this.#pe=s=>{t[s]=e[s]!==0?this.#G.now():0};this.#fe=(i,n)=>{if(e[n]){const r=e[n];const o=t[n];if(!r||!o)return;i.ttl=r;i.start=o;i.now=s||getNow();const a=i.now-o;i.remainingTTL=r-a}};let s=0;const getNow=()=>{const e=this.#G.now();if(this.ttlResolution>0){s=e;const t=setTimeout((()=>s=0),this.ttlResolution);if(t.unref){t.unref()}}return e};this.getRemainingTTL=i=>{const n=this.#$.get(i);if(n===undefined){return 0}const r=e[n];const o=t[n];if(!r||!o){return Infinity}const a=(s||getNow())-o;return r-a};this.#le=i=>{const n=t[i];const r=e[i];return!!r&&!!n&&(s||getNow())-n>r}}#pe=()=>{};#fe=()=>{};#ue=()=>{};#le=()=>false;#ce(){const e=new ZeroArray(this.#O);this.#F=0;this.#J=e;this.#me=t=>{this.#F-=e[t];e[t]=0};this.#ge=(e,t,s,i)=>{if(this.#ie(t)){return 0}if(!isPosInt(s)){if(i){if(typeof i!=="function"){throw new TypeError("sizeCalculation must be a function")}s=i(t,e);if(!isPosInt(s)){throw new TypeError("sizeCalculation return invalid (expect positive integer)")}}else{throw new TypeError("invalid size value (must be positive integer). "+"When maxSize or maxEntrySize is used, sizeCalculation "+"or size must be set.")}}return s};this.#ye=(t,s,i)=>{e[t]=s;if(this.#P){const s=this.#P-e[t];while(this.#F>s){this.#we(true)}}this.#F+=e[t];if(i){i.entrySize=s;i.totalCalculatedSize=this.#F}}}#me=e=>{};#ye=(e,t,s)=>{};#ge=(e,t,s,i)=>{if(s||i){throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}return 0};*#oe({allowStale:e=this.allowStale}={}){if(this.#U){for(let t=this.#Y;true;){if(!this.#be(t)){break}if(e||!this.#le(t)){yield t}if(t===this.#H){break}else{t=this.#q[t]}}}}*#ae({allowStale:e=this.allowStale}={}){if(this.#U){for(let t=this.#H;true;){if(!this.#be(t)){break}if(e||!this.#le(t)){yield t}if(t===this.#Y){break}else{t=this.#z[t]}}}}#be(e){return e!==undefined&&this.#$.get(this.#W[e])===e}*entries(){for(const e of this.#oe()){if(this.#j[e]!==undefined&&this.#W[e]!==undefined&&!this.#ie(this.#j[e])){yield[this.#W[e],this.#j[e]]}}}*rentries(){for(const e of this.#ae()){if(this.#j[e]!==undefined&&this.#W[e]!==undefined&&!this.#ie(this.#j[e])){yield[this.#W[e],this.#j[e]]}}}*keys(){for(const e of this.#oe()){const t=this.#W[e];if(t!==undefined&&!this.#ie(this.#j[e])){yield t}}}*rkeys(){for(const e of this.#ae()){const t=this.#W[e];if(t!==undefined&&!this.#ie(this.#j[e])){yield t}}}*values(){for(const e of this.#oe()){const t=this.#j[e];if(t!==undefined&&!this.#ie(this.#j[e])){yield this.#j[e]}}}*rvalues(){for(const e of this.#ae()){const t=this.#j[e];if(t!==undefined&&!this.#ie(this.#j[e])){yield this.#j[e]}}}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(const s of this.#oe()){const i=this.#j[s];const n=this.#ie(i)?i.__staleWhileFetching:i;if(n===undefined)continue;if(e(n,this.#W[s],this)){return this.get(this.#W[s],t)}}}forEach(e,t=this){for(const s of this.#oe()){const i=this.#j[s];const n=this.#ie(i)?i.__staleWhileFetching:i;if(n===undefined)continue;e.call(t,n,this.#W[s],this)}}rforEach(e,t=this){for(const s of this.#ae()){const i=this.#j[s];const n=this.#ie(i)?i.__staleWhileFetching:i;if(n===undefined)continue;e.call(t,n,this.#W[s],this)}}purgeStale(){let e=false;for(const t of this.#ae({allowStale:true})){if(this.#le(t)){this.#de(this.#W[t],"expire");e=true}}return e}info(e){const t=this.#$.get(e);if(t===undefined)return undefined;const s=this.#j[t];const i=this.#ie(s)?s.__staleWhileFetching:s;if(i===undefined)return undefined;const n={value:i};if(this.#Q&&this.#X){const e=this.#Q[t];const s=this.#X[t];if(e&&s){const t=e-(this.#G.now()-s);n.ttl=t;n.start=Date.now()}}if(this.#J){n.size=this.#J[t]}return n}dump(){const e=[];for(const t of this.#oe({allowStale:true})){const s=this.#W[t];const i=this.#j[t];const n=this.#ie(i)?i.__staleWhileFetching:i;if(n===undefined||s===undefined)continue;const r={value:n};if(this.#Q&&this.#X){r.ttl=this.#Q[t];const e=this.#G.now()-this.#X[t];r.start=Math.floor(Date.now()-e)}if(this.#J){r.size=this.#J[t]}e.unshift([s,r])}return e}load(e){this.clear();for(const[t,s]of e){if(s.start){const e=Date.now()-s.start;s.start=this.#G.now()-e}this.set(t,s.value,s)}}set(e,t,s={}){if(t===undefined){this.delete(e);return this}const{ttl:i=this.ttl,start:n,noDisposeOnSet:r=this.noDisposeOnSet,sizeCalculation:o=this.sizeCalculation,status:a}=s;let{noUpdateTTL:l=this.noUpdateTTL}=s;const c=this.#ge(e,t,s.size||0,o);if(this.maxEntrySize&&c>this.maxEntrySize){if(a){a.set="miss";a.maxEntrySizeExceeded=true}this.#de(e,"set");return this}let h=this.#U===0?undefined:this.#$.get(e);if(h===undefined){h=this.#U===0?this.#Y:this.#K.length!==0?this.#K.pop():this.#U===this.#O?this.#we(false):this.#U;this.#W[h]=e;this.#j[h]=t;this.#$.set(e,h);this.#z[this.#Y]=h;this.#q[h]=this.#Y;this.#Y=h;this.#U++;this.#ye(h,c,a);if(a)a.set="add";l=false;if(this.#se){this.#L?.(t,e,"add")}}else{this.#re(h);const s=this.#j[h];if(t!==s){if(this.#ee&&this.#ie(s)){s.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:t}=s;if(t!==undefined&&!r){if(this.#Z){this.#I?.(t,e,"set")}if(this.#te){this.#V?.push([t,e,"set"])}}}else if(!r){if(this.#Z){this.#I?.(s,e,"set")}if(this.#te){this.#V?.push([s,e,"set"])}}this.#me(h);this.#ye(h,c,a);this.#j[h]=t;if(a){a.set="replace";const e=s&&this.#ie(s)?s.__staleWhileFetching:s;if(e!==undefined)a.oldValue=e}}else if(a){a.set="update"}if(this.#se){this.onInsert?.(t,e,t===s?"update":"replace")}}if(i!==0&&!this.#Q){this.#he()}if(this.#Q){if(!l){this.#ue(h,i,n)}if(a)this.#fe(a,h)}if(!r&&this.#te&&this.#V){const e=this.#V;let t;while(t=e?.shift()){this.#N?.(...t)}}return this}pop(){try{while(this.#U){const e=this.#j[this.#H];this.#we(true);if(this.#ie(e)){if(e.__staleWhileFetching){return e.__staleWhileFetching}}else if(e!==undefined){return e}}}finally{if(this.#te&&this.#V){const e=this.#V;let t;while(t=e?.shift()){this.#N?.(...t)}}}}#we(e){const t=this.#H;const s=this.#W[t];const i=this.#j[t];if(this.#ee&&this.#ie(i)){i.__abortController.abort(new Error("evicted"))}else if(this.#Z||this.#te){if(this.#Z){this.#I?.(i,s,"evict")}if(this.#te){this.#V?.push([i,s,"evict"])}}this.#me(t);if(e){this.#W[t]=undefined;this.#j[t]=undefined;this.#K.push(t)}if(this.#U===1){this.#H=this.#Y=0;this.#K.length=0}else{this.#H=this.#z[t]}this.#$.delete(s);this.#U--;return t}has(e,t={}){const{updateAgeOnHas:s=this.updateAgeOnHas,status:i}=t;const n=this.#$.get(e);if(n!==undefined){const e=this.#j[n];if(this.#ie(e)&&e.__staleWhileFetching===undefined){return false}if(!this.#le(n)){if(s){this.#pe(n)}if(i){i.has="hit";this.#fe(i,n)}return true}else if(i){i.has="stale";this.#fe(i,n)}}else if(i){i.has="miss"}return false}peek(e,t={}){const{allowStale:s=this.allowStale}=t;const i=this.#$.get(e);if(i===undefined||!s&&this.#le(i)){return}const n=this.#j[i];return this.#ie(n)?n.__staleWhileFetching:n}#ne(e,t,s,i){const n=t===undefined?undefined:this.#j[t];if(this.#ie(n)){return n}const o=new r;const{signal:a}=s;a?.addEventListener("abort",(()=>o.abort(a.reason)),{signal:o.signal});const l={signal:o.signal,options:s,context:i};const cb=(i,n=false)=>{const{aborted:r}=o.signal;const a=s.ignoreFetchAbort&&i!==undefined;if(s.status){if(r&&!n){s.status.fetchAborted=true;s.status.fetchError=o.signal.reason;if(a)s.status.fetchAbortIgnored=true}else{s.status.fetchResolved=true}}if(r&&!a&&!n){return fetchFail(o.signal.reason)}const h=c;const u=this.#j[t];if(u===c||a&&n&&u===undefined){if(i===undefined){if(h.__staleWhileFetching!==undefined){this.#j[t]=h.__staleWhileFetching}else{this.#de(e,"fetch")}}else{if(s.status)s.status.fetchUpdated=true;this.set(e,i,l.options)}}return i};const eb=e=>{if(s.status){s.status.fetchRejected=true;s.status.fetchError=e}return fetchFail(e)};const fetchFail=i=>{const{aborted:n}=o.signal;const r=n&&s.allowStaleOnFetchAbort;const a=r||s.allowStaleOnFetchRejection;const l=a||s.noDeleteOnFetchRejection;const h=c;if(this.#j[t]===c){const s=!l||h.__staleWhileFetching===undefined;if(s){this.#de(e,"fetch")}else if(!r){this.#j[t]=h.__staleWhileFetching}}if(a){if(s.status&&h.__staleWhileFetching!==undefined){s.status.returnedStale=true}return h.__staleWhileFetching}else if(h.__returned===h){throw i}};const pcall=(t,i)=>{const r=this.#D?.(e,n,l);if(r&&r instanceof Promise){r.then((e=>t(e===undefined?undefined:e)),i)}o.signal.addEventListener("abort",(()=>{if(!s.ignoreFetchAbort||s.allowStaleOnFetchAbort){t(undefined);if(s.allowStaleOnFetchAbort){t=e=>cb(e,true)}}}))};if(s.status)s.status.fetchDispatched=true;const c=new Promise(pcall).then(cb,eb);const h=Object.assign(c,{__abortController:o,__staleWhileFetching:n,__returned:undefined});if(t===undefined){this.set(e,h,{...l.options,status:undefined});t=this.#$.get(e)}else{this.#j[t]=h}return h}#ie(e){if(!this.#ee)return false;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof r}async fetch(e,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:r=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:a=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:u=this.allowStaleOnFetchRejection,ignoreFetchAbort:d=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:f,forceRefresh:g=false,status:y,signal:w}=t;if(!this.#ee){if(y)y.fetch="get";return this.get(e,{allowStale:s,updateAgeOnGet:i,noDeleteOnStaleGet:n,status:y})}const b={allowStale:s,updateAgeOnGet:i,noDeleteOnStaleGet:n,ttl:r,noDisposeOnSet:o,size:a,sizeCalculation:l,noUpdateTTL:c,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:u,allowStaleOnFetchAbort:p,ignoreFetchAbort:d,status:y,signal:w};let E=this.#$.get(e);if(E===undefined){if(y)y.fetch="miss";const t=this.#ne(e,E,b,f);return t.__returned=t}else{const t=this.#j[E];if(this.#ie(t)){const e=s&&t.__staleWhileFetching!==undefined;if(y){y.fetch="inflight";if(e)y.returnedStale=true}return e?t.__staleWhileFetching:t.__returned=t}const n=this.#le(E);if(!g&&!n){if(y)y.fetch="hit";this.#re(E);if(i){this.#pe(E)}if(y)this.#fe(y,E);return t}const r=this.#ne(e,E,b,f);const o=r.__staleWhileFetching!==undefined;const a=o&&s;if(y){y.fetch=n?"stale":"refresh";if(a&&n)y.returnedStale=true}return a?r.__staleWhileFetching:r.__returned=r}}async forceFetch(e,t={}){const s=await this.fetch(e,t);if(s===undefined)throw new Error("fetch() returned undefined");return s}memo(e,t={}){const s=this.#B;if(!s){throw new Error("no memoMethod provided to constructor")}const{context:i,forceRefresh:n,...r}=t;const o=this.get(e,r);if(!n&&o!==undefined)return o;const a=s(e,o,{options:r,context:i});this.set(e,a,r);return a}get(e,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:r}=t;const o=this.#$.get(e);if(o!==undefined){const t=this.#j[o];const a=this.#ie(t);if(r)this.#fe(r,o);if(this.#le(o)){if(r)r.get="stale";if(!a){if(!n){this.#de(e,"expire")}if(r&&s)r.returnedStale=true;return s?t:undefined}else{if(r&&s&&t.__staleWhileFetching!==undefined){r.returnedStale=true}return s?t.__staleWhileFetching:undefined}}else{if(r)r.get="hit";if(a){return t.__staleWhileFetching}this.#re(o);if(i){this.#pe(o)}return t}}else if(r){r.get="miss"}}#Ee(e,t){this.#q[t]=e;this.#z[e]=t}#re(e){if(e!==this.#Y){if(e===this.#H){this.#H=this.#z[e]}else{this.#Ee(this.#q[e],this.#z[e])}this.#Ee(this.#Y,e);this.#Y=e}}delete(e){return this.#de(e,"delete")}#de(e,t){let s=false;if(this.#U!==0){const i=this.#$.get(e);if(i!==undefined){s=true;if(this.#U===1){this.#Se(t)}else{this.#me(i);const s=this.#j[i];if(this.#ie(s)){s.__abortController.abort(new Error("deleted"))}else if(this.#Z||this.#te){if(this.#Z){this.#I?.(s,e,t)}if(this.#te){this.#V?.push([s,e,t])}}this.#$.delete(e);this.#W[i]=undefined;this.#j[i]=undefined;if(i===this.#Y){this.#Y=this.#q[i]}else if(i===this.#H){this.#H=this.#z[i]}else{const e=this.#q[i];this.#z[e]=this.#z[i];const t=this.#z[i];this.#q[t]=this.#q[i]}this.#U--;this.#K.push(i)}}}if(this.#te&&this.#V?.length){const e=this.#V;let t;while(t=e?.shift()){this.#N?.(...t)}}return s}clear(){return this.#Se("delete")}#Se(e){for(const t of this.#ae({allowStale:true})){const s=this.#j[t];if(this.#ie(s)){s.__abortController.abort(new Error("deleted"))}else{const i=this.#W[t];if(this.#Z){this.#I?.(s,i,e)}if(this.#te){this.#V?.push([s,i,e])}}}this.#$.clear();this.#j.fill(undefined);this.#W.fill(undefined);if(this.#Q&&this.#X){this.#Q.fill(0);this.#X.fill(0)}if(this.#J){this.#J.fill(0)}this.#H=0;this.#Y=0;this.#K.length=0;this.#F=0;this.#U=0;if(this.#te&&this.#V){const e=this.#V;let t;while(t=e?.shift()){this.#N?.(...t)}}}}t.LRUCache=LRUCache},8275:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.Minipass=t.isWritable=t.isReadable=t.isStream=void 0;const n=typeof process==="object"&&process?process:{stdout:null,stderr:null};const r=s(8474);const o=i(s(7075));const a=s(6193);const isStream=e=>!!e&&typeof e==="object"&&(e instanceof Minipass||e instanceof o.default||(0,t.isReadable)(e)||(0,t.isWritable)(e));t.isStream=isStream;const isReadable=e=>!!e&&typeof e==="object"&&e instanceof r.EventEmitter&&typeof e.pipe==="function"&&e.pipe!==o.default.Writable.prototype.pipe;t.isReadable=isReadable;const isWritable=e=>!!e&&typeof e==="object"&&e instanceof r.EventEmitter&&typeof e.write==="function"&&typeof e.end==="function";t.isWritable=isWritable;const l=Symbol("EOF");const c=Symbol("maybeEmitEnd");const h=Symbol("emittedEnd");const u=Symbol("emittingEnd");const d=Symbol("emittedError");const p=Symbol("closed");const f=Symbol("read");const g=Symbol("flush");const y=Symbol("flushChunk");const w=Symbol("encoding");const b=Symbol("decoder");const E=Symbol("flowing");const S=Symbol("paused");const k=Symbol("resume");const T=Symbol("buffer");const x=Symbol("pipes");const v=Symbol("bufferLength");const _=Symbol("bufferPush");const C=Symbol("bufferShift");const R=Symbol("objectMode");const A=Symbol("destroyed");const M=Symbol("error");const O=Symbol("emitData");const P=Symbol("emitEnd");const I=Symbol("emitEnd2");const L=Symbol("async");const N=Symbol("abort");const D=Symbol("aborted");const B=Symbol("signal");const G=Symbol("dataListeners");const U=Symbol("discarded");const defer=e=>Promise.resolve().then(e);const nodefer=e=>e();const isEndish=e=>e==="end"||e==="finish"||e==="prefinish";const isArrayBufferLike=e=>e instanceof ArrayBuffer||!!e&&typeof e==="object"&&e.constructor&&e.constructor.name==="ArrayBuffer"&&e.byteLength>=0;const isArrayBufferView=e=>!Buffer.isBuffer(e)&&ArrayBuffer.isView(e);class Pipe{src;dest;opts;ondrain;constructor(e,t,s){this.src=e;this.dest=t;this.opts=s;this.ondrain=()=>e[k]();this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(e){}end(){this.unpipe();if(this.opts.end)this.dest.end()}}class PipeProxyErrors extends Pipe{unpipe(){this.src.removeListener("error",this.proxyErrors);super.unpipe()}constructor(e,t,s){super(e,t,s);this.proxyErrors=e=>t.emit("error",e);e.on("error",this.proxyErrors)}}const isObjectModeOptions=e=>!!e.objectMode;const isEncodingOptions=e=>!e.objectMode&&!!e.encoding&&e.encoding!=="buffer";class Minipass extends r.EventEmitter{[E]=false;[S]=false;[x]=[];[T]=[];[R];[w];[L];[b];[l]=false;[h]=false;[u]=false;[p]=false;[d]=null;[v]=0;[A]=false;[B];[D]=false;[G]=0;[U]=false;writable=true;readable=true;constructor(...e){const t=e[0]||{};super();if(t.objectMode&&typeof t.encoding==="string"){throw new TypeError("Encoding and objectMode may not be used together")}if(isObjectModeOptions(t)){this[R]=true;this[w]=null}else if(isEncodingOptions(t)){this[w]=t.encoding;this[R]=false}else{this[R]=false;this[w]=null}this[L]=!!t.async;this[b]=this[w]?new a.StringDecoder(this[w]):null;if(t&&t.debugExposeBuffer===true){Object.defineProperty(this,"buffer",{get:()=>this[T]})}if(t&&t.debugExposePipes===true){Object.defineProperty(this,"pipes",{get:()=>this[x]})}const{signal:s}=t;if(s){this[B]=s;if(s.aborted){this[N]()}else{s.addEventListener("abort",(()=>this[N]()))}}}get bufferLength(){return this[v]}get encoding(){return this[w]}set encoding(e){throw new Error("Encoding must be set at instantiation time")}setEncoding(e){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[R]}set objectMode(e){throw new Error("objectMode must be set at instantiation time")}get["async"](){return this[L]}set["async"](e){this[L]=this[L]||!!e}[N](){this[D]=true;this.emit("abort",this[B]?.reason);this.destroy(this[B]?.reason)}get aborted(){return this[D]}set aborted(e){}write(e,t,s){if(this[D])return false;if(this[l])throw new Error("write after end");if(this[A]){this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"}));return true}if(typeof t==="function"){s=t;t="utf8"}if(!t)t="utf8";const i=this[L]?defer:nodefer;if(!this[R]&&!Buffer.isBuffer(e)){if(isArrayBufferView(e)){e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(isArrayBufferLike(e)){e=Buffer.from(e)}else if(typeof e!=="string"){throw new Error("Non-contiguous data written to non-objectMode stream")}}if(this[R]){if(this[E]&&this[v]!==0)this[g](true);if(this[E])this.emit("data",e);else this[_](e);if(this[v]!==0)this.emit("readable");if(s)i(s);return this[E]}if(!e.length){if(this[v]!==0)this.emit("readable");if(s)i(s);return this[E]}if(typeof e==="string"&&!(t===this[w]&&!this[b]?.lastNeed)){e=Buffer.from(e,t)}if(Buffer.isBuffer(e)&&this[w]){e=this[b].write(e)}if(this[E]&&this[v]!==0)this[g](true);if(this[E])this.emit("data",e);else this[_](e);if(this[v]!==0)this.emit("readable");if(s)i(s);return this[E]}read(e){if(this[A])return null;this[U]=false;if(this[v]===0||e===0||e&&e>this[v]){this[c]();return null}if(this[R])e=null;if(this[T].length>1&&!this[R]){this[T]=[this[w]?this[T].join(""):Buffer.concat(this[T],this[v])]}const t=this[f](e||null,this[T][0]);this[c]();return t}[f](e,t){if(this[R])this[C]();else{const s=t;if(e===s.length||e===null)this[C]();else if(typeof s==="string"){this[T][0]=s.slice(e);t=s.slice(0,e);this[v]-=e}else{this[T][0]=s.subarray(e);t=s.subarray(0,e);this[v]-=e}}this.emit("data",t);if(!this[T].length&&!this[l])this.emit("drain");return t}end(e,t,s){if(typeof e==="function"){s=e;e=undefined}if(typeof t==="function"){s=t;t="utf8"}if(e!==undefined)this.write(e,t);if(s)this.once("end",s);this[l]=true;this.writable=false;if(this[E]||!this[S])this[c]();return this}[k](){if(this[A])return;if(!this[G]&&!this[x].length){this[U]=true}this[S]=false;this[E]=true;this.emit("resume");if(this[T].length)this[g]();else if(this[l])this[c]();else this.emit("drain")}resume(){return this[k]()}pause(){this[E]=false;this[S]=true;this[U]=false}get destroyed(){return this[A]}get flowing(){return this[E]}get paused(){return this[S]}[_](e){if(this[R])this[v]+=1;else this[v]+=e.length;this[T].push(e)}[C](){if(this[R])this[v]-=1;else this[v]-=this[T][0].length;return this[T].shift()}[g](e=false){do{}while(this[y](this[C]())&&this[T].length);if(!e&&!this[T].length&&!this[l])this.emit("drain")}[y](e){this.emit("data",e);return this[E]}pipe(e,t){if(this[A])return e;this[U]=false;const s=this[h];t=t||{};if(e===n.stdout||e===n.stderr)t.end=false;else t.end=t.end!==false;t.proxyErrors=!!t.proxyErrors;if(s){if(t.end)e.end()}else{this[x].push(!t.proxyErrors?new Pipe(this,e,t):new PipeProxyErrors(this,e,t));if(this[L])defer((()=>this[k]()));else this[k]()}return e}unpipe(e){const t=this[x].find((t=>t.dest===e));if(t){if(this[x].length===1){if(this[E]&&this[G]===0){this[E]=false}this[x]=[]}else this[x].splice(this[x].indexOf(t),1);t.unpipe()}}addListener(e,t){return this.on(e,t)}on(e,t){const s=super.on(e,t);if(e==="data"){this[U]=false;this[G]++;if(!this[x].length&&!this[E]){this[k]()}}else if(e==="readable"&&this[v]!==0){super.emit("readable")}else if(isEndish(e)&&this[h]){super.emit(e);this.removeAllListeners(e)}else if(e==="error"&&this[d]){const e=t;if(this[L])defer((()=>e.call(this,this[d])));else e.call(this,this[d])}return s}removeListener(e,t){return this.off(e,t)}off(e,t){const s=super.off(e,t);if(e==="data"){this[G]=this.listeners("data").length;if(this[G]===0&&!this[U]&&!this[x].length){this[E]=false}}return s}removeAllListeners(e){const t=super.removeAllListeners(e);if(e==="data"||e===undefined){this[G]=0;if(!this[U]&&!this[x].length){this[E]=false}}return t}get emittedEnd(){return this[h]}[c](){if(!this[u]&&!this[h]&&!this[A]&&this[T].length===0&&this[l]){this[u]=true;this.emit("end");this.emit("prefinish");this.emit("finish");if(this[p])this.emit("close");this[u]=false}}emit(e,...t){const s=t[0];if(e!=="error"&&e!=="close"&&e!==A&&this[A]){return false}else if(e==="data"){return!this[R]&&!s?false:this[L]?(defer((()=>this[O](s))),true):this[O](s)}else if(e==="end"){return this[P]()}else if(e==="close"){this[p]=true;if(!this[h]&&!this[A])return false;const e=super.emit("close");this.removeAllListeners("close");return e}else if(e==="error"){this[d]=s;super.emit(M,s);const e=!this[B]||this.listeners("error").length?super.emit("error",s):false;this[c]();return e}else if(e==="resume"){const e=super.emit("resume");this[c]();return e}else if(e==="finish"||e==="prefinish"){const t=super.emit(e);this.removeAllListeners(e);return t}const i=super.emit(e,...t);this[c]();return i}[O](e){for(const t of this[x]){if(t.dest.write(e)===false)this.pause()}const t=this[U]?false:super.emit("data",e);this[c]();return t}[P](){if(this[h])return false;this[h]=true;this.readable=false;return this[L]?(defer((()=>this[I]())),true):this[I]()}[I](){if(this[b]){const e=this[b].end();if(e){for(const t of this[x]){t.dest.write(e)}if(!this[U])super.emit("data",e)}}for(const e of this[x]){e.end()}const e=super.emit("end");this.removeAllListeners("end");return e}async collect(){const e=Object.assign([],{dataLength:0});if(!this[R])e.dataLength=0;const t=this.promise();this.on("data",(t=>{e.push(t);if(!this[R])e.dataLength+=t.length}));await t;return e}async concat(){if(this[R]){throw new Error("cannot concat in objectMode")}const e=await this.collect();return this[w]?e.join(""):Buffer.concat(e,e.dataLength)}async promise(){return new Promise(((e,t)=>{this.on(A,(()=>t(new Error("stream destroyed"))));this.on("error",(e=>t(e)));this.on("end",(()=>e()))}))}[Symbol.asyncIterator](){this[U]=false;let e=false;const stop=async()=>{this.pause();e=true;return{value:undefined,done:true}};const next=()=>{if(e)return stop();const t=this.read();if(t!==null)return Promise.resolve({done:false,value:t});if(this[l])return stop();let s;let i;const onerr=e=>{this.off("data",ondata);this.off("end",onend);this.off(A,ondestroy);stop();i(e)};const ondata=e=>{this.off("error",onerr);this.off("end",onend);this.off(A,ondestroy);this.pause();s({value:e,done:!!this[l]})};const onend=()=>{this.off("error",onerr);this.off("data",ondata);this.off(A,ondestroy);stop();s({done:true,value:undefined})};const ondestroy=()=>onerr(new Error("stream destroyed"));return new Promise(((e,t)=>{i=t;s=e;this.once(A,ondestroy);this.once("error",onerr);this.once("end",onend);this.once("data",ondata)}))};return{next:next,throw:stop,return:stop,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[U]=false;let e=false;const stop=()=>{this.pause();this.off(M,stop);this.off(A,stop);this.off("end",stop);e=true;return{done:true,value:undefined}};const next=()=>{if(e)return stop();const t=this.read();return t===null?stop():{done:false,value:t}};this.once("end",stop);this.once(M,stop);this.once(A,stop);return{next:next,throw:stop,return:stop,[Symbol.iterator](){return this}}}destroy(e){if(this[A]){if(e)this.emit("error",e);else this.emit(A);return this}this[A]=true;this[U]=true;this[T].length=0;this[v]=0;const t=this;if(typeof t.close==="function"&&!this[p])t.close();if(e)this.emit("error",e);else this.emit(A);return this}static get isStream(){return t.isStream}}t.Minipass=Minipass},6577:function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){if(i===undefined)i=s;var n=Object.getOwnPropertyDescriptor(t,s);if(!n||("get"in n?!t.__esModule:n.writable||n.configurable)){n={enumerable:true,get:function(){return t[s]}}}Object.defineProperty(e,i,n)}:function(e,t,s,i){if(i===undefined)i=s;e[i]=t[s]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))i(t,e,s);n(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.PathScurry=t.Path=t.PathScurryDarwin=t.PathScurryPosix=t.PathScurryWin32=t.PathScurryBase=t.PathPosix=t.PathWin32=t.PathBase=t.ChildrenCache=t.ResolveCache=void 0;const o=s(2477);const a=s(6760);const l=s(3136);const c=s(9896);const h=r(s(3024));const u=c.realpathSync.native;const d=s(1455);const p=s(8275);const f={lstatSync:c.lstatSync,readdir:c.readdir,readdirSync:c.readdirSync,readlinkSync:c.readlinkSync,realpathSync:u,promises:{lstat:d.lstat,readdir:d.readdir,readlink:d.readlink,realpath:d.realpath}};const fsFromOption=e=>!e||e===f||e===h?f:{...f,...e,promises:{...f.promises,...e.promises||{}}};const g=/^\\\\\?\\([a-z]:)\\?$/i;const uncToDrive=e=>e.replace(/\//g,"\\").replace(g,"$1\\");const y=/[\\\/]/;const w=0;const b=1;const E=2;const S=4;const k=6;const T=8;const x=10;const v=12;const _=15;const C=~_;const R=16;const A=32;const M=64;const O=128;const P=256;const I=512;const L=M|O|I;const N=1023;const entToType=e=>e.isFile()?T:e.isDirectory()?S:e.isSymbolicLink()?x:e.isCharacterDevice()?E:e.isBlockDevice()?k:e.isSocket()?v:e.isFIFO()?b:w;const D=new o.LRUCache({max:2**12});const normalize=e=>{const t=D.get(e);if(t)return t;const s=e.normalize("NFKD");D.set(e,s);return s};const B=new o.LRUCache({max:2**12});const normalizeNocase=e=>{const t=B.get(e);if(t)return t;const s=normalize(e.toLowerCase());B.set(e,s);return s};class ResolveCache extends o.LRUCache{constructor(){super({max:256})}}t.ResolveCache=ResolveCache;class ChildrenCache extends o.LRUCache{constructor(e=16*1024){super({maxSize:e,sizeCalculation:e=>e.length+1})}}t.ChildrenCache=ChildrenCache;const G=Symbol("PathScurry setAsCwd");class PathBase{name;root;roots;parent;nocase;isCWD=false;#ke;#Te;get dev(){return this.#Te}#xe;get mode(){return this.#xe}#ve;get nlink(){return this.#ve}#_e;get uid(){return this.#_e}#Ce;get gid(){return this.#Ce}#Re;get rdev(){return this.#Re}#Ae;get blksize(){return this.#Ae}#Me;get ino(){return this.#Me}#U;get size(){return this.#U}#Oe;get blocks(){return this.#Oe}#Pe;get atimeMs(){return this.#Pe}#Ie;get mtimeMs(){return this.#Ie}#Le;get ctimeMs(){return this.#Le}#Ne;get birthtimeMs(){return this.#Ne}#De;get atime(){return this.#De}#Be;get mtime(){return this.#Be}#Ge;get ctime(){return this.#Ge}#Ue;get birthtime(){return this.#Ue}#Fe;#$e;#We;#je;#ze;#qe;#He;#Ye;#Ke;#Ve;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(e,t=w,s,i,n,r,o){this.name=e;this.#Fe=n?normalizeNocase(e):normalize(e);this.#He=t&N;this.nocase=n;this.roots=i;this.root=s||this;this.#Ye=r;this.#We=o.fullpath;this.#ze=o.relative;this.#qe=o.relativePosix;this.parent=o.parent;if(this.parent){this.#ke=this.parent.#ke}else{this.#ke=fsFromOption(o.fs)}}depth(){if(this.#$e!==undefined)return this.#$e;if(!this.parent)return this.#$e=0;return this.#$e=this.parent.depth()+1}childrenCache(){return this.#Ye}resolve(e){if(!e){return this}const t=this.getRootString(e);const s=e.substring(t.length);const i=s.split(this.splitSep);const n=t?this.getRoot(t).#Je(i):this.#Je(i);return n}#Je(e){let t=this;for(const s of e){t=t.child(s)}return t}children(){const e=this.#Ye.get(this);if(e){return e}const t=Object.assign([],{provisional:0});this.#Ye.set(this,t);this.#He&=~R;return t}child(e,t){if(e===""||e==="."){return this}if(e===".."){return this.parent||this}const s=this.children();const i=this.nocase?normalizeNocase(e):normalize(e);for(const e of s){if(e.#Fe===i){return e}}const n=this.parent?this.sep:"";const r=this.#We?this.#We+n+e:undefined;const o=this.newChild(e,w,{...t,parent:this,fullpath:r});if(!this.canReaddir()){o.#He|=O}s.push(o);return o}relative(){if(this.isCWD)return"";if(this.#ze!==undefined){return this.#ze}const e=this.name;const t=this.parent;if(!t){return this.#ze=this.name}const s=t.relative();return s+(!s||!t.parent?"":this.sep)+e}relativePosix(){if(this.sep==="/")return this.relative();if(this.isCWD)return"";if(this.#qe!==undefined)return this.#qe;const e=this.name;const t=this.parent;if(!t){return this.#qe=this.fullpathPosix()}const s=t.relativePosix();return s+(!s||!t.parent?"":"/")+e}fullpath(){if(this.#We!==undefined){return this.#We}const e=this.name;const t=this.parent;if(!t){return this.#We=this.name}const s=t.fullpath();const i=s+(!t.parent?"":this.sep)+e;return this.#We=i}fullpathPosix(){if(this.#je!==undefined)return this.#je;if(this.sep==="/")return this.#je=this.fullpath();if(!this.parent){const e=this.fullpath().replace(/\\/g,"/");if(/^[a-z]:\//i.test(e)){return this.#je=`//?/${e}`}else{return this.#je=e}}const e=this.parent;const t=e.fullpathPosix();const s=t+(!t||!e.parent?"":"/")+this.name;return this.#je=s}isUnknown(){return(this.#He&_)===w}isType(e){return this[`is${e}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return(this.#He&_)===T}isDirectory(){return(this.#He&_)===S}isCharacterDevice(){return(this.#He&_)===E}isBlockDevice(){return(this.#He&_)===k}isFIFO(){return(this.#He&_)===b}isSocket(){return(this.#He&_)===v}isSymbolicLink(){return(this.#He&x)===x}lstatCached(){return this.#He&A?this:undefined}readlinkCached(){return this.#Ke}realpathCached(){return this.#Ve}readdirCached(){const e=this.children();return e.slice(0,e.provisional)}canReadlink(){if(this.#Ke)return true;if(!this.parent)return false;const e=this.#He&_;return!(e!==w&&e!==x||this.#He&P||this.#He&O)}calledReaddir(){return!!(this.#He&R)}isENOENT(){return!!(this.#He&O)}isNamed(e){return!this.nocase?this.#Fe===normalize(e):this.#Fe===normalizeNocase(e)}async readlink(){const e=this.#Ke;if(e){return e}if(!this.canReadlink()){return undefined}if(!this.parent){return undefined}try{const e=await this.#ke.promises.readlink(this.fullpath());const t=(await this.parent.realpath())?.resolve(e);if(t){return this.#Ke=t}}catch(e){this.#Xe(e.code);return undefined}}readlinkSync(){const e=this.#Ke;if(e){return e}if(!this.canReadlink()){return undefined}if(!this.parent){return undefined}try{const e=this.#ke.readlinkSync(this.fullpath());const t=this.parent.realpathSync()?.resolve(e);if(t){return this.#Ke=t}}catch(e){this.#Xe(e.code);return undefined}}#Qe(e){this.#He|=R;for(let t=e.provisional;t<e.length;t++){const s=e[t];if(s)s.#Ze()}}#Ze(){if(this.#He&O)return;this.#He=(this.#He|O)&C;this.#et()}#et(){const e=this.children();e.provisional=0;for(const t of e){t.#Ze()}}#tt(){this.#He|=I;this.#st()}#st(){if(this.#He&M)return;let e=this.#He;if((e&_)===S)e&=C;this.#He=e|M;this.#et()}#it(e=""){if(e==="ENOTDIR"||e==="EPERM"){this.#st()}else if(e==="ENOENT"){this.#Ze()}else{this.children().provisional=0}}#nt(e=""){if(e==="ENOTDIR"){const e=this.parent;e.#st()}else if(e==="ENOENT"){this.#Ze()}}#Xe(e=""){let t=this.#He;t|=P;if(e==="ENOENT")t|=O;if(e==="EINVAL"||e==="UNKNOWN"){t&=C}this.#He=t;if(e==="ENOTDIR"&&this.parent){this.parent.#st()}}#rt(e,t){return this.#ot(e,t)||this.#at(e,t)}#at(e,t){const s=entToType(e);const i=this.newChild(e.name,s,{parent:this});const n=i.#He&_;if(n!==S&&n!==x&&n!==w){i.#He|=M}t.unshift(i);t.provisional++;return i}#ot(e,t){for(let s=t.provisional;s<t.length;s++){const i=t[s];const n=this.nocase?normalizeNocase(e.name):normalize(e.name);if(n!==i.#Fe){continue}return this.#lt(e,i,s,t)}}#lt(e,t,s,i){const n=t.name;t.#He=t.#He&C|entToType(e);if(n!==e.name)t.name=e.name;if(s!==i.provisional){if(s===i.length-1)i.pop();else i.splice(s,1);i.unshift(t)}i.provisional++;return t}async lstat(){if((this.#He&O)===0){try{this.#ct(await this.#ke.promises.lstat(this.fullpath()));return this}catch(e){this.#nt(e.code)}}}lstatSync(){if((this.#He&O)===0){try{this.#ct(this.#ke.lstatSync(this.fullpath()));return this}catch(e){this.#nt(e.code)}}}#ct(e){const{atime:t,atimeMs:s,birthtime:i,birthtimeMs:n,blksize:r,blocks:o,ctime:a,ctimeMs:l,dev:c,gid:h,ino:u,mode:d,mtime:p,mtimeMs:f,nlink:g,rdev:y,size:b,uid:E}=e;this.#De=t;this.#Pe=s;this.#Ue=i;this.#Ne=n;this.#Ae=r;this.#Oe=o;this.#Ge=a;this.#Le=l;this.#Te=c;this.#Ce=h;this.#Me=u;this.#xe=d;this.#Be=p;this.#Ie=f;this.#ve=g;this.#Re=y;this.#U=b;this.#_e=E;const k=entToType(e);this.#He=this.#He&C|k|A;if(k!==w&&k!==S&&k!==x){this.#He|=M}}#ht=[];#ut=false;#dt(e){this.#ut=false;const t=this.#ht.slice();this.#ht.length=0;t.forEach((t=>t(null,e)))}readdirCB(e,t=false){if(!this.canReaddir()){if(t)e(null,[]);else queueMicrotask((()=>e(null,[])));return}const s=this.children();if(this.calledReaddir()){const i=s.slice(0,s.provisional);if(t)e(null,i);else queueMicrotask((()=>e(null,i)));return}this.#ht.push(e);if(this.#ut){return}this.#ut=true;const i=this.fullpath();this.#ke.readdir(i,{withFileTypes:true},((e,t)=>{if(e){this.#it(e.code);s.provisional=0}else{for(const e of t){this.#rt(e,s)}this.#Qe(s)}this.#dt(s.slice(0,s.provisional));return}))}#pt;async readdir(){if(!this.canReaddir()){return[]}const e=this.children();if(this.calledReaddir()){return e.slice(0,e.provisional)}const t=this.fullpath();if(this.#pt){await this.#pt}else{let resolve=()=>{};this.#pt=new Promise((e=>resolve=e));try{for(const s of await this.#ke.promises.readdir(t,{withFileTypes:true})){this.#rt(s,e)}this.#Qe(e)}catch(t){this.#it(t.code);e.provisional=0}this.#pt=undefined;resolve()}return e.slice(0,e.provisional)}readdirSync(){if(!this.canReaddir()){return[]}const e=this.children();if(this.calledReaddir()){return e.slice(0,e.provisional)}const t=this.fullpath();try{for(const s of this.#ke.readdirSync(t,{withFileTypes:true})){this.#rt(s,e)}this.#Qe(e)}catch(t){this.#it(t.code);e.provisional=0}return e.slice(0,e.provisional)}canReaddir(){if(this.#He&L)return false;const e=_&this.#He;if(!(e===w||e===S||e===x)){return false}return true}shouldWalk(e,t){return(this.#He&S)===S&&!(this.#He&L)&&!e.has(this)&&(!t||t(this))}async realpath(){if(this.#Ve)return this.#Ve;if((I|P|O)&this.#He)return undefined;try{const e=await this.#ke.promises.realpath(this.fullpath());return this.#Ve=this.resolve(e)}catch(e){this.#tt()}}realpathSync(){if(this.#Ve)return this.#Ve;if((I|P|O)&this.#He)return undefined;try{const e=this.#ke.realpathSync(this.fullpath());return this.#Ve=this.resolve(e)}catch(e){this.#tt()}}[G](e){if(e===this)return;e.isCWD=false;this.isCWD=true;const t=new Set([]);let s=[];let i=this;while(i&&i.parent){t.add(i);i.#ze=s.join(this.sep);i.#qe=s.join("/");i=i.parent;s.push("..")}i=e;while(i&&i.parent&&!t.has(i)){i.#ze=undefined;i.#qe=undefined;i=i.parent}}}t.PathBase=PathBase;class PathWin32 extends PathBase{sep="\\";splitSep=y;constructor(e,t=w,s,i,n,r,o){super(e,t,s,i,n,r,o)}newChild(e,t=w,s={}){return new PathWin32(e,t,this.root,this.roots,this.nocase,this.childrenCache(),s)}getRootString(e){return a.win32.parse(e).root}getRoot(e){e=uncToDrive(e.toUpperCase());if(e===this.root.name){return this.root}for(const[t,s]of Object.entries(this.roots)){if(this.sameRoot(e,t)){return this.roots[e]=s}}return this.roots[e]=new PathScurryWin32(e,this).root}sameRoot(e,t=this.root.name){e=e.toUpperCase().replace(/\//g,"\\").replace(g,"$1\\");return e===t}}t.PathWin32=PathWin32;class PathPosix extends PathBase{splitSep="/";sep="/";constructor(e,t=w,s,i,n,r,o){super(e,t,s,i,n,r,o)}getRootString(e){return e.startsWith("/")?"/":""}getRoot(e){return this.root}newChild(e,t=w,s={}){return new PathPosix(e,t,this.root,this.roots,this.nocase,this.childrenCache(),s)}}t.PathPosix=PathPosix;class PathScurryBase{root;rootPath;roots;cwd;#ft;#mt;#Ye;nocase;#ke;constructor(e=process.cwd(),t,s,{nocase:i,childrenCacheSize:n=16*1024,fs:r=f}={}){this.#ke=fsFromOption(r);if(e instanceof URL||e.startsWith("file://")){e=(0,l.fileURLToPath)(e)}const o=t.resolve(e);this.roots=Object.create(null);this.rootPath=this.parseRootPath(o);this.#ft=new ResolveCache;this.#mt=new ResolveCache;this.#Ye=new ChildrenCache(n);const a=o.substring(this.rootPath.length).split(s);if(a.length===1&&!a[0]){a.pop()}if(i===undefined){throw new TypeError("must provide nocase setting to PathScurryBase ctor")}this.nocase=i;this.root=this.newRoot(this.#ke);this.roots[this.rootPath]=this.root;let c=this.root;let h=a.length-1;const u=t.sep;let d=this.rootPath;let p=false;for(const e of a){const t=h--;c=c.child(e,{relative:new Array(t).fill("..").join(u),relativePosix:new Array(t).fill("..").join("/"),fullpath:d+=(p?"":u)+e});p=true}this.cwd=c}depth(e=this.cwd){if(typeof e==="string"){e=this.cwd.resolve(e)}return e.depth()}childrenCache(){return this.#Ye}resolve(...e){let t="";for(let s=e.length-1;s>=0;s--){const i=e[s];if(!i||i===".")continue;t=t?`${i}/${t}`:i;if(this.isAbsolute(i)){break}}const s=this.#ft.get(t);if(s!==undefined){return s}const i=this.cwd.resolve(t).fullpath();this.#ft.set(t,i);return i}resolvePosix(...e){let t="";for(let s=e.length-1;s>=0;s--){const i=e[s];if(!i||i===".")continue;t=t?`${i}/${t}`:i;if(this.isAbsolute(i)){break}}const s=this.#mt.get(t);if(s!==undefined){return s}const i=this.cwd.resolve(t).fullpathPosix();this.#mt.set(t,i);return i}relative(e=this.cwd){if(typeof e==="string"){e=this.cwd.resolve(e)}return e.relative()}relativePosix(e=this.cwd){if(typeof e==="string"){e=this.cwd.resolve(e)}return e.relativePosix()}basename(e=this.cwd){if(typeof e==="string"){e=this.cwd.resolve(e)}return e.name}dirname(e=this.cwd){if(typeof e==="string"){e=this.cwd.resolve(e)}return(e.parent||e).fullpath()}async readdir(e=this.cwd,t={withFileTypes:true}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}const{withFileTypes:s}=t;if(!e.canReaddir()){return[]}else{const t=await e.readdir();return s?t:t.map((e=>e.name))}}readdirSync(e=this.cwd,t={withFileTypes:true}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}const{withFileTypes:s=true}=t;if(!e.canReaddir()){return[]}else if(s){return e.readdirSync()}else{return e.readdirSync().map((e=>e.name))}}async lstat(e=this.cwd){if(typeof e==="string"){e=this.cwd.resolve(e)}return e.lstat()}lstatSync(e=this.cwd){if(typeof e==="string"){e=this.cwd.resolve(e)}return e.lstatSync()}async readlink(e=this.cwd,{withFileTypes:t}={withFileTypes:false}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e.withFileTypes;e=this.cwd}const s=await e.readlink();return t?s:s?.fullpath()}readlinkSync(e=this.cwd,{withFileTypes:t}={withFileTypes:false}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e.withFileTypes;e=this.cwd}const s=e.readlinkSync();return t?s:s?.fullpath()}async realpath(e=this.cwd,{withFileTypes:t}={withFileTypes:false}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e.withFileTypes;e=this.cwd}const s=await e.realpath();return t?s:s?.fullpath()}realpathSync(e=this.cwd,{withFileTypes:t}={withFileTypes:false}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e.withFileTypes;e=this.cwd}const s=e.realpathSync();return t?s:s?.fullpath()}async walk(e=this.cwd,t={}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}const{withFileTypes:s=true,follow:i=false,filter:n,walkFilter:r}=t;const o=[];if(!n||n(e)){o.push(s?e:e.fullpath())}const a=new Set;const walk=(e,t)=>{a.add(e);e.readdirCB(((e,l)=>{if(e){return t(e)}let c=l.length;if(!c)return t();const next=()=>{if(--c===0){t()}};for(const e of l){if(!n||n(e)){o.push(s?e:e.fullpath())}if(i&&e.isSymbolicLink()){e.realpath().then((e=>e?.isUnknown()?e.lstat():e)).then((e=>e?.shouldWalk(a,r)?walk(e,next):next()))}else{if(e.shouldWalk(a,r)){walk(e,next)}else{next()}}}}),true)};const l=e;return new Promise(((e,t)=>{walk(l,(s=>{if(s)return t(s);e(o)}))}))}walkSync(e=this.cwd,t={}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}const{withFileTypes:s=true,follow:i=false,filter:n,walkFilter:r}=t;const o=[];if(!n||n(e)){o.push(s?e:e.fullpath())}const a=new Set([e]);for(const e of a){const t=e.readdirSync();for(const e of t){if(!n||n(e)){o.push(s?e:e.fullpath())}let t=e;if(e.isSymbolicLink()){if(!(i&&(t=e.realpathSync())))continue;if(t.isUnknown())t.lstatSync()}if(t.shouldWalk(a,r)){a.add(t)}}}return o}[Symbol.asyncIterator](){return this.iterate()}iterate(e=this.cwd,t={}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}return this.stream(e,t)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(e=this.cwd,t={}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}const{withFileTypes:s=true,follow:i=false,filter:n,walkFilter:r}=t;if(!n||n(e)){yield s?e:e.fullpath()}const o=new Set([e]);for(const e of o){const t=e.readdirSync();for(const e of t){if(!n||n(e)){yield s?e:e.fullpath()}let t=e;if(e.isSymbolicLink()){if(!(i&&(t=e.realpathSync())))continue;if(t.isUnknown())t.lstatSync()}if(t.shouldWalk(o,r)){o.add(t)}}}}stream(e=this.cwd,t={}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}const{withFileTypes:s=true,follow:i=false,filter:n,walkFilter:r}=t;const o=new p.Minipass({objectMode:true});if(!n||n(e)){o.write(s?e:e.fullpath())}const a=new Set;const l=[e];let c=0;const process=()=>{let e=false;while(!e){const t=l.shift();if(!t){if(c===0)o.end();return}c++;a.add(t);const onReaddir=(t,u,d=false)=>{if(t)return o.emit("error",t);if(i&&!d){const e=[];for(const t of u){if(t.isSymbolicLink()){e.push(t.realpath().then((e=>e?.isUnknown()?e.lstat():e)))}}if(e.length){Promise.all(e).then((()=>onReaddir(null,u,true)));return}}for(const t of u){if(t&&(!n||n(t))){if(!o.write(s?t:t.fullpath())){e=true}}}c--;for(const e of u){const t=e.realpathCached()||e;if(t.shouldWalk(a,r)){l.push(t)}}if(e&&!o.flowing){o.once("drain",process)}else if(!h){process()}};let h=true;t.readdirCB(onReaddir,true);h=false}};process();return o}streamSync(e=this.cwd,t={}){if(typeof e==="string"){e=this.cwd.resolve(e)}else if(!(e instanceof PathBase)){t=e;e=this.cwd}const{withFileTypes:s=true,follow:i=false,filter:n,walkFilter:r}=t;const o=new p.Minipass({objectMode:true});const a=new Set;if(!n||n(e)){o.write(s?e:e.fullpath())}const l=[e];let c=0;const process=()=>{let e=false;while(!e){const t=l.shift();if(!t){if(c===0)o.end();return}c++;a.add(t);const h=t.readdirSync();for(const t of h){if(!n||n(t)){if(!o.write(s?t:t.fullpath())){e=true}}}c--;for(const e of h){let t=e;if(e.isSymbolicLink()){if(!(i&&(t=e.realpathSync())))continue;if(t.isUnknown())t.lstatSync()}if(t.shouldWalk(a,r)){l.push(t)}}}if(e&&!o.flowing)o.once("drain",process)};process();return o}chdir(e=this.cwd){const t=this.cwd;this.cwd=typeof e==="string"?this.cwd.resolve(e):e;this.cwd[G](t)}}t.PathScurryBase=PathScurryBase;class PathScurryWin32 extends PathScurryBase{sep="\\";constructor(e=process.cwd(),t={}){const{nocase:s=true}=t;super(e,a.win32,"\\",{...t,nocase:s});this.nocase=s;for(let e=this.cwd;e;e=e.parent){e.nocase=this.nocase}}parseRootPath(e){return a.win32.parse(e).root.toUpperCase()}newRoot(e){return new PathWin32(this.rootPath,S,undefined,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")||e.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(e)}}t.PathScurryWin32=PathScurryWin32;class PathScurryPosix extends PathScurryBase{sep="/";constructor(e=process.cwd(),t={}){const{nocase:s=false}=t;super(e,a.posix,"/",{...t,nocase:s});this.nocase=s}parseRootPath(e){return"/"}newRoot(e){return new PathPosix(this.rootPath,S,undefined,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")}}t.PathScurryPosix=PathScurryPosix;class PathScurryDarwin extends PathScurryPosix{constructor(e=process.cwd(),t={}){const{nocase:s=true}=t;super(e,{...t,nocase:s})}}t.PathScurryDarwin=PathScurryDarwin;t.Path=process.platform==="win32"?PathWin32:PathPosix;t.PathScurry=process.platform==="win32"?PathScurryWin32:process.platform==="darwin"?PathScurryDarwin:PathScurryPosix},4710:(e,t,s)=>{const i=s(2162);class AnthropicCaching extends i{constructor(e,t){super(e,t)}name(){return"Caching"}supported(){return true}shouldEnable(){return this.config.ENABLE_CACHE!==false}applySystem(e){return this.provider.adapter.system(e)}configure(e){if(!this.enabled()){return e}if(e.messages&&Array.isArray(e.messages)){e.messages=this.applyMessages(e.messages)}return e}applyMessages(e){if(!this.enabled()||e.length===0){return e}const t=[...e];let s=-1;for(let t=e.length-1;t>=0;t--){if(e[t].role==="assistant"){s=t;break}}if(s!==-1){const e=t[s];if(Array.isArray(e.content)&&e.content.length>0){const i=[...e.content];const n=i[i.length-1];i[i.length-1]={...n,cache_control:{type:"ephemeral"}};t[s]={...e,content:i}}}let i=-1;for(let t=e.length-1;t>=0;t--){if(e[t].role==="user"){i=t;break}}if(i!==-1){const e=t[i];if(typeof e.content==="string"){t[i]={...e,content:[{type:"text",text:e.content,cache_control:{type:"ephemeral"}}]}}else if(Array.isArray(e.content)&&e.content.length>0){const s=[...e.content];const n=s[s.length-1];s[s.length-1]={...n,cache_control:{type:"ephemeral"}};t[i]={...e,content:s}}}return t}}e.exports=AnthropicCaching},1833:(e,t,s)=>{const i=s(9201);class Prompt{constructor(e){this.config=e;this.workdir=e.WORKDIR||process.cwd();this.platform=process.platform}getPrompt(e="GENERAL",t={}){const s={SEARCH:this.getSearchPrompt.bind(this),READ:this.getReadPrompt.bind(this),CODE:this.getCodePrompt.bind(this),REVIEW:this.getReviewPrompt.bind(this),DEBUG:this.getDebugPrompt.bind(this),TEST:this.getTestPrompt.bind(this),GENERAL:this.getGeneralPrompt.bind(this)};const i=s[e]||s["GENERAL"];return i(t)}getSearchPrompt(e){const t=`You are Claude, a file search and discovery specialist.\n\n# Your Role\nHelp users quickly locate files, patterns, and code structures in their codebase.\n\n# Context\n- Working Directory: ${this.workdir}\n- Platform: ${this.platform}\n\n# Available Tools\n- **Glob**: File pattern matching (e.g., "**/*.js", "src/**/*.tsx")\n- **Grep**: Content search with regex support\n- **Read**: File inspection for verification\n- **Task**: Launch Explore agent for complex multi-step searches (use when initial search is insufficient)\n\n# Search Strategy\n1. **Understand the Goal**: Clarify what the user is looking for\n2. **Choose the Right Tool**:\n   - Use Glob for filename patterns\n   - Use Grep for content/code searches\n   - Combine tools when needed\n   - **Use Task (Explore agent) for complex searches** that require multiple iterations or comprehensive analysis\n3. **Be Efficient**: Start with broader patterns, then narrow down\n4. **Provide Context**: Show match counts and relevant snippets\n\n# When to Use Task Tool\nUse Task with "Explore" agent when:\n- You need multiple search iterations to find the right files\n- The search requires exploring multiple naming conventions or patterns\n- User asks broad questions like "where is X implemented?" or "how does Y work?"\n- Initial Glob/Grep results are unclear and need deeper investigation\n\n# Output Guidelines\n- List file paths clearly\n- Show match statistics (e.g., "Found 15 files")\n- Provide brief context about matches\n- Suggest next steps if results are unclear\n\n# Important\n- DO NOT use Write or Edit tools during search tasks\n- Focus on discovery, not modification\n- If no results found, suggest alternative search terms\n\nBegin your search efficiently and clearly.`;return i.cacheable(t)}getReadPrompt(e){const t=`You are Claude, an expert code reader and analyzer.\n\n# Your Role\nHelp users understand code structure, logic, and behavior through careful reading and explanation.\n\n# Context\n- Working Directory: ${this.workdir}\n- Platform: ${this.platform}\n\n# Available Tools\n- **Read**: Read file contents\n- **Glob**: Find related files\n- **Grep**: Search for specific patterns\n\n# Analysis Approach\n1. **Read Thoroughly**: Examine the code carefully\n2. **Identify Key Components**: Functions, classes, modules\n3. **Trace Logic Flow**: Understand execution paths\n4. **Explain Clearly**: Use simple, precise language\n\n# Output Guidelines\n- Start with a high-level summary\n- Explain key functions and their purposes\n- Highlight important patterns or design decisions\n- Use code references (e.g., "lines 23-45")\n- Point out potential issues or improvements if asked\n\n# Important\n- DO NOT modify files unless explicitly requested\n- Provide accurate, evidence-based explanations\n- Reference specific code locations\n- Ask clarifying questions if the code is ambiguous\n\nReady to help you understand the code.`;return i.cacheable(t)}getCodePrompt(e){const t=(new Date).toISOString().split("T")[0];const s=`You are an expert software engineer specializing in high-quality code implementation.\n\n# Context\n- Working Directory: ${this.workdir}\n- Platform: ${this.platform}${this.platform==="win32"?" (Windows - use `dir` not `ls`, `type` not `cat`)":""}\n- Today's date: ${t}\n\n# Available Tools\n- **Read**: Examine existing code\n- **Write**: Create new files\n- **Edit**: Modify existing files\n- **Glob/Grep**: Search codebase\n- **Bash**: Run commands${this.platform==="win32"?" (Windows: use `dir`, `npm`, `git`, avoid Unix commands like `ls`/`cat`)":""}\n- **TodoWrite**: Track multi-step tasks (MANDATORY for 3+ steps!)\n- **Task**: Launch sub-agents for complex exploration/analysis (use when searching requires multiple iterations)\n\n# Before You Start - Quick Check ⚠️\nCount the implementation steps:\n- 1-2 steps? → Start coding directly\n- 3+ steps? → CREATE TodoWrite list FIRST, then code\n\n# Task Management - CRITICAL\nYou have access to the TodoWrite tool to manage and plan tasks. Use this tool VERY frequently for multi-step implementations.\n\nThese tools are EXTREMELY helpful for planning tasks and breaking down larger complex tasks into smaller steps. If you do not use this tool when planning complex tasks, you may forget to do important tasks - and that is unacceptable.\n\nFor complex tasks (3+ steps), you MUST:\n1. Create a TodoWrite list at the start\n2. Mark each task as in_progress before starting\n3. Mark each task as completed immediately after finishing\n4. Never batch completions - update status in real-time\n\n# Implementation Workflow\n1. **Understand Requirements**: Clarify the task and constraints\n2. **Research Context**: Read related code to understand patterns\n3. **Plan Implementation**: Break down into steps (use TodoWrite for complex tasks - 3+ steps)\n4. **Write Clean Code**:\n   - Follow existing code style\n   - Add meaningful comments where needed\n   - Include error handling\n   - Write modular, testable code\n5. **Verify**: Test the implementation when possible\n\n# Code Quality Standards\n- Clear, descriptive variable and function names\n- Proper error handling and edge cases\n- Consistent formatting matching existing code\n- Minimal complexity, prefer simple solutions\n- Reusable components\n\n# Important Guidelines\n- ALWAYS read existing code first to match style and patterns\n- Use TodoWrite for multi-step implementations (3+ steps)\n- Test your changes when possible\n- Explain your implementation decisions\n- Prefer editing existing files over creating new ones\n\n# Tool Usage\n- Call multiple tools in parallel when there are no dependencies\n- Use specialized tools (Read, Edit, Write) instead of bash for file operations\n- Use Glob and Grep for efficient code search\n\nReady to implement with high quality and attention to detail.`;return i.cacheable(s)}getReviewPrompt(e){const t=`You are Claude, a senior code reviewer focused on quality, security, and maintainability.\n\n# Your Role\nReview code for best practices, potential issues, and improvement opportunities.\n\n# Context\n- Working Directory: ${this.workdir}\n- Platform: ${this.platform}\n\n# Quick Check: Use TodoWrite?\nReviewing multiple files OR comprehensive analysis?\n→ YES (3+ steps)? CREATE TodoWrite list FIRST\n→ NO (single file)? Review directly\n\nExample TodoWrite for "Review entire project":\n1. Review project structure\n2. Analyze main components\n3. Check security patterns\n4. Generate final report\n\n# Review Dimensions\n1. **Correctness**: Logic errors, edge cases\n2. **Security**: Vulnerabilities, unsafe patterns\n3. **Performance**: Inefficiencies, bottlenecks\n4. **Maintainability**: Code clarity, documentation\n5. **Best Practices**: Language idioms, design patterns\n\n# Review Process\n1. **Read Thoroughly**: Understand the code's purpose\n2. **Identify Issues**: Note problems by severity\n3. **Suggest Improvements**: Provide actionable feedback\n4. **Explain Reasoning**: Why each suggestion matters\n\n# Output Format\n- **Critical Issues**: Security vulnerabilities, bugs\n- **Important**: Performance problems, poor patterns\n- **Minor**: Style inconsistencies, naming\n- **Suggestions**: Potential enhancements\n\n# Feedback Style\n- Be constructive and specific\n- Provide examples of improvements\n- Explain the "why" behind suggestions\n- Acknowledge good practices\n\n# Important\n- DO NOT modify code unless explicitly asked\n- Focus on providing value, not nitpicking\n- Prioritize high-impact issues\n- Reference specific line numbers\n- Use TodoWrite for complex multi-file reviews\n\nReady to provide thorough, constructive code review.`;return i.cacheable(t)}getDebugPrompt(e){const t=(new Date).toISOString().split("T")[0];const s=`You are a debugging specialist skilled at diagnosing and fixing software issues.\n\n# Context\n- Working Directory: ${this.workdir}\n- Platform: ${this.platform}\n- Today's date: ${t}\n\n# Debugging Methodology\n1. **Reproduce**: Understand the problem and how to trigger it\n2. **Investigate**: Read relevant code, check logs, examine stack traces\n3. **Hypothesize**: Form theories about the root cause\n4. **Test**: Verify your hypothesis with evidence\n5. **Fix**: Implement the solution\n6. **Verify**: Confirm the fix works and doesn't break anything else\n\n# Available Tools\n- **Read**: Examine code and logs\n- **Grep**: Search for error patterns and related code\n- **Bash**: Run tests, check logs, reproduce issues\n- **Edit**: Apply fixes\n- **TodoWrite**: Track debugging steps for complex issues (USE THIS FREQUENTLY!)\n\n# Task Management - CRITICAL\nFor complex debugging (3+ investigation steps), you MUST:\n1. Create a TodoWrite list to track debugging steps\n2. Mark each step as in_progress before starting\n3. Mark each step as completed immediately after finishing\n4. Update status in real-time as you investigate\n\n# Common Bug Patterns to Look For\n- Off-by-one errors and boundary conditions\n- Null/undefined references\n- Race conditions and timing issues\n- Type mismatches and conversions\n- Logic errors and incorrect assumptions\n- Missing error handling\n\n# Tool Usage\n- Use Grep to find all occurrences of problematic code\n- Use Bash to run tests and verify fixes\n- Call multiple tools in parallel when investigating\n- Use Read to examine code context carefully\n\n# Output Guidelines\n- Clearly explain what you found\n- Describe the root cause, not just symptoms\n- Show the fix with clear before/after comparison\n- Explain why the fix works\n- Suggest preventive measures if applicable\n\n# Important\n- Read code carefully before making changes\n- Test fixes when possible (use Bash to run tests)\n- Consider edge cases and potential side effects\n- Explain your reasoning and debugging process\n\nReady to systematically debug and resolve issues.`;return i.cacheable(s)}getTestPrompt(e){const t=`You are Claude, a test engineering specialist focused on comprehensive, maintainable test coverage.\n\n# Your Role\nWrite effective tests that catch bugs, document behavior, and enable confident refactoring.\n\n# Context\n- Working Directory: ${this.workdir}\n- Platform: ${this.platform}\n\n# Testing Philosophy\n- Tests document expected behavior\n- Good tests are clear, focused, and independent\n- Test the interface, not the implementation\n- Balance coverage with maintainability\n\n# Test Strategy\n1. **Understand the Code**: Read what you're testing\n2. **Identify Test Cases**:\n   - Happy path\n   - Edge cases\n   - Error conditions\n3. **Write Clear Tests**:\n   - Descriptive test names\n   - Arrange-Act-Assert pattern\n   - Minimal, focused assertions\n4. **Verify**: Run tests and confirm they work\n\n# Test Quality\n- **Independent**: Tests don't depend on each other\n- **Repeatable**: Same input = same output\n- **Fast**: Quick feedback loop\n- **Clear**: Easy to understand failures\n\n# Available Tools\n- **Read**: Examine code to test\n- **Write**: Create test files\n- **Bash**: Run tests\n- **TodoWrite**: Track test coverage goals (USE THIS FREQUENTLY!)\n\n# Task Management - CRITICAL\nFor comprehensive test coverage (3+ test files or scenarios), you MUST:\n1. Create a TodoWrite list to track test coverage\n2. Mark each test file/scenario as in_progress before starting\n3. Mark each as completed immediately after finishing\n4. Update status in real-time\n\n# Important\n- Match the existing test framework and style\n- Write tests that fail when code breaks\n- Include edge cases and error scenarios\n- Keep tests simple and maintainable\n\nReady to create comprehensive, high-quality tests.`;return i.cacheable(t)}getGeneralPrompt(e){const t=(new Date).toISOString().split("T")[0];const s=`You are an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\n\n# Tone and style\n- Only use emojis if the user explicitly requests it. Avoid using emojis in all communication unless asked.\n- Your output will be displayed on a command line interface. Your responses should be short and concise. You can use Github-flavored markdown for formatting.\n- Output text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\n- NEVER create files unless they're absolutely necessary for achieving your goal. ALWAYS prefer editing an existing file to creating a new one. This includes markdown files.\n\n# Professional objectivity\nPrioritize technical accuracy and truthfulness over validating the user's beliefs. Focus on facts and problem-solving, providing direct, objective technical info without any unnecessary superlatives, praise, or emotional validation.\n\n# Quick Decision Guide\nBefore starting ANY task, count the steps:\n- 1-2 simple steps? → Do it directly\n- 3+ steps OR user says "and"? → Create TodoWrite list FIRST\n- User gives numbered list? → Convert to TodoWrite immediately\n\nCommon 3+ step patterns:\n• "Implement X" = research + code + test (3 steps)\n• "Fix bug and add tests" = fix + test + verify (3 steps)\n• "Analyze and optimize" = analyze + identify issues + implement fixes (3+ steps)\n\n# Task Management\nYou have access to the TodoWrite tool to help you manage and plan tasks. Use this tool VERY frequently to ensure that you are tracking your tasks and giving the user visibility into your progress.\n\nThese tools are also EXTREMELY helpful for planning tasks, and for breaking down larger complex tasks into smaller steps. If you do not use this tool when planning, you may forget to do important tasks - and that is unacceptable.\n\nIt is critical that you mark todos as completed as soon as you are done with a task. Do not batch up multiple tasks before marking them as completed.\n\n**Examples:**\n\nExample 1 - Multi-step task:\nuser: Run the build and fix any type errors\nassistant: I'm going to use the TodoWrite tool to write the following items to the todo list:\n- Run the build\n- Fix any type errors\n\nI'm now going to run the build using Bash.\n\nLooks like I found 10 type errors. I'm going to use the TodoWrite tool to write 10 items to the todo list.\n\nMarking the first todo as in_progress\n\nLet me start working on the first item...\n\nThe first item has been fixed, let me mark the first todo as completed, and move on to the second item...\n\nExample 2 - Complex feature:\nuser: Help me implement a metrics tracking and export feature\nassistant: I'll help you implement a usage metrics tracking and export feature. Let me first use the TodoWrite tool to plan this task.\nAdding the following todos to the todo list:\n1. Research existing metrics tracking in the codebase\n2. Design the metrics collection system\n3. Implement core metrics tracking functionality\n4. Create export functionality for different formats\n\nLet me start by researching the existing codebase to understand what metrics we might already be tracking and how we can build on that.\n\nI'm going to search for any existing metrics or telemetry code in the project.\n\nI've found some existing telemetry code. Let me mark the first todo as in_progress and start designing our metrics tracking system based on what I've learned...\n\n[Assistant continues implementing the feature step by step, marking todos as in_progress and completed as they go]\n\n**IMPORTANT: Always use the TodoWrite tool to plan and track tasks throughout the conversation.**\n\n# Tool usage policy\n- You can call multiple tools in a single response. If you intend to call multiple tools and there are no dependencies between them, make all independent tool calls in parallel.\n- Use specialized tools instead of bash commands when possible. For file operations, use dedicated tools: Read for reading files, Edit for editing, Write for creating files.\n- When exploring the codebase to gather context or to answer questions, use the appropriate search tools (Glob, Grep) to find files efficiently.\n- **For complex searches or explorations**: If you need to perform multiple search iterations or comprehensive codebase analysis, use the Task tool with "Explore" agent type instead of running search commands directly. This is more efficient for open-ended discovery tasks.\n\n# Doing tasks\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks:\n- Use the TodoWrite tool to plan the task if required\n- Break down complex tasks into manageable steps\n- Execute one step at a time, marking each as complete before moving to the next\n\n# Code References\nWhen referencing specific functions or pieces of code include the pattern \`file_path:line_number\` to allow the user to easily navigate to the source code location.\n\nExample: Clients are marked as failed in the \`connectToServer\` function in src/services/process.js:712.\n\nHere is useful information about the environment you are running in:\n<env>\nWorking directory: ${this.workdir}\nIs directory a git repo: ${e.isGitRepo||"Unknown"}\nPlatform: ${this.platform}\nOS Version: ${e.osVersion||""}\nToday's date: ${t}\n</env>\n\nAssistant knowledge cutoff is January 2025.\n\n${e.gitStatus?`gitStatus: This is the git status at the start of the conversation. Note that this status is a snapshot in time, and will not update during the conversation.\n\n${e.gitStatus}`:""}`;return i.cacheable(s)}getStats(){return{provider:"Anthropic (Claude)",supportedTypes:["SEARCH","READ","CODE","REVIEW","DEBUG","TEST","GENERAL"],cachingEnabled:true,averageLength:"300-400 words",style:"Detailed, structured, comprehensive"}}}e.exports=Prompt},7527:(e,t,s)=>{const i=s(2162);const n=s(7258);const{Message:r}=s(9409);const{Block:o}=s(7271);class AnthropicStreaming extends i{constructor(e,t,s,i){super(e,i);this.client=t;this.adapter=s}name(){return"Streaming"}supported(){return true}shouldEnable(){return this.config.ENABLE_STREAMING!==false}configure(e){return{...e,stream:true}}async handle(e){n.streamStart();const t=[];let s=null;let i=null;let r=null;const o=new Map;let a=null;let l=null;let c=null;let h=null;try{for await(const u of this._parseSSEStream(e)){switch(u.type){case"message_start":a=u.message?.id;l=u.message?.model;h=u.message?.usage;break;case"content_block_start":if(u.content_block?.type==="text"){s={type:"text",text:""}}else if(u.content_block?.type==="thinking"){i={type:"thinking",thinking:"",signature:null}}else if(u.content_block?.type==="tool_use"){r={type:"tool_use",id:u.content_block.id,name:u.content_block.name,input:{}};o.set(u.index,"")}break;case"content_block_delta":if(u.delta?.type==="text_delta"){if(s){s.text+=u.delta.text;n.streamDelta(u.delta.text,"text")}}else if(u.delta?.type==="thinking_delta"){if(i){i.thinking+=u.delta.thinking;n.streamDelta(u.delta.thinking,"thinking")}}else if(u.delta?.type==="signature_delta"){if(i&&u.delta.signature){i.signature=u.delta.signature}}else if(u.delta?.type==="input_json_delta"){if(o.has(u.index)){const e=o.get(u.index);o.set(u.index,e+u.delta.partial_json)}}break;case"content_block_stop":if(s){t.push(s);s=null}else if(i){t.push(i);i=null;n.streamDelta("\n\n","text")}else if(r){if(o.has(u.index)){const e=o.get(u.index);try{r.input=JSON.parse(e)}catch(e){console.error("Failed to parse tool input JSON:",e.message)}o.delete(u.index)}t.push(r);r=null}break;case"message_delta":if(u.delta?.stop_reason){c=u.delta.stop_reason}if(u.usage){h={...h,...u.usage}}break;case"message_stop":break}}n.streamEnd({usage:h});const u={id:a,model:l,content:t,stop_reason:c,usage:h};if(this.client&&this.client.saveDebugLog){this.client.saveDebugLog("stream-response",u)}return u}catch(e){n.streamError(e);throw e}}async*_parseSSEStream(e){const t=e.getReader();const s=new TextDecoder;let i="";try{while(true){const{done:e,value:n}=await t.read();if(e)break;i+=s.decode(n,{stream:true});const r=i.split("\n");i=r.pop()||"";for(const e of r){if(e.startsWith("data: ")){const t=e.slice(6);if(t==="[DONE]")continue;try{const e=JSON.parse(t);yield e}catch(e){console.warn("Failed to parse SSE event:",e.message)}}}}}finally{t.releaseLock()}}}e.exports=AnthropicStreaming},8063:(e,t,s)=>{const i=s(2162);class AnthropicThinking extends i{constructor(e,t){super(e,t)}name(){return"Thinking"}supported(){const e=this.provider.model||"";return e.includes("sonnet")||e.includes("opus")}shouldEnable(){return this.config.ENABLE_THINKING!==false}configure(e){const t=e.max_tokens||32e3;const s=this.config.THINKING_BUDGET||1e4;const i=Math.max(1024,Math.min(s,t-1024));return{...e,thinking:{type:"enabled",budget_tokens:i}}}extract(e){if(!e||!e.content){return[]}return e.content.filter((e=>e.type==="thinking")).map((e=>e.thinking))}}e.exports=AnthropicThinking},7928:(e,t,s)=>{const i=s(5249);class AnthropicTools extends i{constructor(e={}){super(e);this.enableCaching=e.CACHING!==false;this.cacheReadonlyTools=e.CACHE_READONLY_TOOLS!==false;this._initializeCustomSchemas()}_initializeCustomSchemas(){this.registerCustomSchema("Bash",{type:"object",properties:{command:{type:"string",description:"The command to execute. Platform: Windows. Use Windows commands: dir (NOT ls), type (NOT cat), copy (NOT cp). For file operations, prefer specialized tools (Read, Write, Edit)."},timeout:{type:"number",description:"Optional timeout in milliseconds (max 600000)"},description:{type:"string",description:"Clear, concise description of what this command does in 5-10 words"},run_in_background:{type:"boolean",description:"Set to true to run this command in the background"},dangerouslyDisableSandbox:{type:"boolean",description:"Set this to true to dangerously override sandbox mode"}},required:["command"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"});this.registerCustomSchema("Read",{type:"object",properties:{file_path:{type:"string",description:"The absolute path to the file to read"},offset:{type:"number",description:"The line number to start reading from (optional)"},limit:{type:"number",description:"The number of lines to read (optional)"}},required:["file_path"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"});this.registerCustomSchema("Glob",{type:"object",properties:{pattern:{type:"string",description:'The glob pattern to match files against (e.g., "**/*.js", "src/**/*.ts")'},path:{type:"string",description:"The directory to search in (optional, defaults to current working directory)"}},required:["pattern"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"});this.registerCustomSchema("Grep",{type:"object",properties:{pattern:{type:"string",description:"The regular expression pattern to search for in file contents"},path:{type:"string",description:"File or directory to search in (defaults to current working directory)"},output_mode:{type:"string",enum:["content","files_with_matches","count"],description:'Output mode: "content" shows matching lines, "files_with_matches" shows file paths, "count" shows match counts. Defaults to "files_with_matches".'},glob:{type:"string",description:'Glob pattern to filter files (e.g. "*.js", "*.{ts,tsx}")'},type:{type:"string",description:'File type to search (e.g., "js", "py", "rust"). More efficient than glob for standard file types.'},"-i":{type:"boolean",description:"Case insensitive search"},"-n":{type:"boolean",description:"Show line numbers in output (only with content mode)"},"-A":{type:"number",description:"Number of lines to show after each match (only with content mode)"},"-B":{type:"number",description:"Number of lines to show before each match (only with content mode)"},"-C":{type:"number",description:"Number of lines to show before and after each match (only with content mode)"},head_limit:{type:"number",description:"Limit output to first N lines/entries. Works across all output modes."},multiline:{type:"boolean",description:"Enable multiline mode where . matches newlines. Default: false."}},required:["pattern"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"});this.registerCustomSchema("Write",{type:"object",properties:{file_path:{type:"string",description:"The absolute path to the file to write"},content:{type:"string",description:"The content to write to the file"}},required:["file_path","content"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"});this.registerCustomSchema("Edit",{type:"object",properties:{file_path:{type:"string",description:"The absolute path to the file to modify"},old_string:{type:"string",description:"The text to replace"},new_string:{type:"string",description:"The text to replace it with"},replace_all:{type:"boolean",description:"Replace all occurrences (default false)",default:false}},required:["file_path","old_string","new_string"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"});this.registerCustomSchema("TodoWrite",{type:"object",properties:{todos:{type:"array",description:'The updated todo list. USE THIS PROACTIVELY for multi-step tasks (3+ steps required). Triggers: user request with "and" (multiple tasks), "implement X" (research+code+test), "fix + test/docs" (2+ actions).',items:{type:"object",properties:{content:{type:"string",description:"The imperative form describing what needs to be done"},status:{type:"string",enum:["pending","in_progress","completed"],description:"Task status"},activeForm:{type:"string",description:"The present continuous form shown during execution"}},required:["content","status","activeForm"]}}},required:["todos"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"});this.registerCustomSchema("Task",{type:"object",properties:{description:{type:"string",description:"A short (3-5 word) description of the task"},prompt:{type:"string",description:"The task for the agent to perform"},subagent_type:{type:"string",description:"The type of specialized agent to use for this task"},model:{type:"string",enum:["fast","powerful","default"],description:"Optional model selection. fast: FAST_MODEL (optimized for speed/cost), powerful: POWERFUL_MODEL (optimized for quality), default: provider default. Prefer fast for quick tasks to minimize cost and latency."},resume:{type:"string",description:"Optional agent ID to resume from. If provided, the agent will continue from the previous execution transcript."}},required:["description","prompt","subagent_type"],additionalProperties:false,$schema:"http://json-schema.org/draft-07/schema#"})}customizeTool(e){if(this.customSchemas.has(e.name)){e.schema=this.customSchemas.get(e.name)}e.vendor="anthropic";return e}}e.exports=AnthropicTools},4135:(e,t,s)=>{const i=s(2162);const n=s(7258);class AnthropicWarmup extends i{constructor(e,t,s,i){super(e,i);this.client=t;this.adapter=s;this.warmedModels=new Set}name(){return"Warmup"}supported(){return true}shouldEnable(){return this.config.ENABLE_WARMUP!==false}async warmup(e,t){if(!this.enabled()){return false}if(this.warmedModels.has(e)){return true}try{n.warmupStart(e);const s=Date.now();const i=t.isCacheable()?[{type:"text",text:"You are Claude Code, Anthropic's official CLI for Claude.",cache_control:{type:"ephemeral"}},{type:"text",text:t.content,cache_control:{type:"ephemeral"}}]:[{type:"text",text:"You are Claude Code, Anthropic's official CLI for Claude."},{type:"text",text:t.content}];const r={model:e,max_tokens:32e3,system:i,messages:[{role:"user",content:t.isCacheable()?[{type:"text",text:"Warmup",cache_control:{type:"ephemeral"}}]:"Warmup"}],tools:[]};await this.client.createMessage(r);this.warmedModels.add(e);const o=Date.now()-s;n.warmupComplete(e,o);return true}catch(t){n.warmupError(e,t);console.warn(`Warmup failed for ${e}:`,t.message);return false}}async batch(e){if(!this.enabled()||!Array.isArray(e)){return{success:0,failed:0}}const t=await Promise.allSettled(e.map((e=>this.warmup(e.modelId,e.system))));const s=t.filter((e=>e.status==="fulfilled"&&e.value===true)).length;const i=t.length-s;return{success:s,failed:i,total:t.length}}isWarmed(e){return this.warmedModels.has(e)}clear(){this.warmedModels.clear()}stats(){return{...super.stats(),warmed_models:Array.from(this.warmedModels),count:this.warmedModels.size}}}e.exports=AnthropicWarmup},5192:(e,t,s)=>{const i=s(9896);const n=s(6928);const r=s(857);const o=s(8330);const a=o.version;const l=o.name;const c={PROVIDER:"gemini",FAST_MODEL:"gemini-2.5-flash",POWERFUL_MODEL:"gemini-2.5-pro",MAX_TOKENS:64e3,ANTHROPIC_BASE_URL:"https://api.anthropic.com",GEMINI_BASE_URL:"https://generativelanguage.googleapis.com",ENABLE_CACHE:true,ENABLE_WARMUP:true,ENABLE_THINKING:true,ENABLE_STREAMING:true,ENABLE_MODEL_SCHEDULING:true,THINKING_BUDGET:-1,INCLUDE_THOUGHTS:false,VERBOSE:false,DEBUG:true,MAX_RETRIES:5,RETRY_BASE_DELAY:1e3,RETRY_MAX_DELAY:32e3,REQUIRE_TOOL_APPROVAL:true};const h=n.join(r.homedir(),".codes");const u=n.join(h,"settings.json");const d=n.join(h,"logs");function initializeConfigFile(){try{if(!i.existsSync(h)){i.mkdirSync(h,{recursive:true});console.log(`✓ Created configuration directory: ${h}`)}if(!i.existsSync(u)){const e={...c};i.writeFileSync(u,JSON.stringify(e,null,2),"utf8");console.log(`✓ Created configuration file: ${u}`);console.log(`\nPlease edit ${u} and add your API keys.\n`)}}catch(e){console.warn(`Warning: Could not initialize config file: ${e.message}`)}}function loadConfigFromFile(){try{if(i.existsSync(u)){const e=i.readFileSync(u,"utf8");return JSON.parse(e)}}catch(e){console.warn(`Warning: Could not load config file: ${e.message}`)}return{}}initializeConfigFile();const p=loadConfigFromFile();const f={PROVIDER:p.PROVIDER||process.env.PROVIDER||c.PROVIDER,MODEL:p.MODEL||process.env.MODEL,MAX_TOKENS:p.MAX_TOKENS||parseInt(process.env.MAX_TOKENS||c.MAX_TOKENS),API_KEY:p.ANTHROPIC_API_KEY||process.env.ANTHROPIC_API_KEY||process.env.ANTHROPIC_AUTH_TOKEN,BASE_URL:p.ANTHROPIC_BASE_URL||process.env.ANTHROPIC_BASE_URL||c.ANTHROPIC_BASE_URL,GEMINI_API_KEY:p.GEMINI_API_KEY||process.env.GEMINI_API_KEY,GEMINI_BASE_URL:p.GEMINI_BASE_URL||process.env.GEMINI_API_BASE_URL||c.GEMINI_BASE_URL,ENABLE_CACHE:p.ENABLE_CACHE!==undefined?p.ENABLE_CACHE:c.ENABLE_CACHE,ENABLE_WARMUP:p.ENABLE_WARMUP!==undefined?p.ENABLE_WARMUP:c.ENABLE_WARMUP,ENABLE_THINKING:p.ENABLE_THINKING!==undefined?p.ENABLE_THINKING:c.ENABLE_THINKING,ENABLE_STREAMING:p.ENABLE_STREAMING!==undefined?p.ENABLE_STREAMING:c.ENABLE_STREAMING,ENABLE_MODEL_SCHEDULING:p.ENABLE_MODEL_SCHEDULING!==undefined?p.ENABLE_MODEL_SCHEDULING:c.ENABLE_MODEL_SCHEDULING,FAST_MODEL:p.FAST_MODEL||process.env.FAST_MODEL||c.FAST_MODEL,POWERFUL_MODEL:p.POWERFUL_MODEL||process.env.POWERFUL_MODEL||p.MODEL||process.env.MODEL||c.POWERFUL_MODEL,THINKING_BUDGET:p.THINKING_BUDGET!==undefined?p.THINKING_BUDGET:process.env.THINKING_BUDGET?parseInt(process.env.THINKING_BUDGET):c.THINKING_BUDGET,INCLUDE_THOUGHTS:p.INCLUDE_THOUGHTS!==undefined?p.INCLUDE_THOUGHTS:c.INCLUDE_THOUGHTS,VERBOSE:p.VERBOSE!==undefined?p.VERBOSE:process.env.VERBOSE==="true",DEBUG:p.DEBUG!==undefined?p.DEBUG:process.env.DEBUG==="true"||c.DEBUG,MAX_RETRIES:p.MAX_RETRIES||parseInt(process.env.MAX_RETRIES||c.MAX_RETRIES),RETRY_BASE_DELAY:p.RETRY_BASE_DELAY||parseInt(process.env.RETRY_BASE_DELAY||c.RETRY_BASE_DELAY),RETRY_MAX_DELAY:p.RETRY_MAX_DELAY||parseInt(process.env.RETRY_MAX_DELAY||c.RETRY_MAX_DELAY),REQUIRE_TOOL_APPROVAL:p.REQUIRE_TOOL_APPROVAL!==undefined?p.REQUIRE_TOOL_APPROVAL:c.REQUIRE_TOOL_APPROVAL,WORKDIR:process.cwd(),LOG_DIR:d,VERSION:a,CLINAME:l};if(f.PROVIDER==="gemini"){f.API_KEY=f.GEMINI_API_KEY;f.BASE_URL=f.GEMINI_BASE_URL}function validateConfig(){const e=[];if(f.PROVIDER==="anthropic"&&!f.API_KEY){e.push("ANTHROPIC_API_KEY is required when using Anthropic provider")}if(f.PROVIDER==="gemini"&&!f.API_KEY){e.push("GEMINI_API_KEY is required when using Gemini provider")}if(e.length>0){console.error("\n❌ Configuration Error:\n");e.forEach((e=>console.error(`  - ${e}`)));console.error("\nPlease set the API key in one of the following ways:");console.error(`  1. Edit configuration file: ${u}`);console.error("  2. Set system environment variable\n");console.error("\nExample for settings.json:");if(f.PROVIDER==="gemini"){console.error('  "GEMINI_API_KEY": "your_api_key_here"')}else{console.error('  "ANTHROPIC_API_KEY": "your_api_key_here"')}console.error("\nExample for environment variable:");if(f.PROVIDER==="gemini"){console.error("  export GEMINI_API_KEY=your_api_key_here")}else{console.error("  export ANTHROPIC_API_KEY=your_api_key_here")}console.error("");process.exit(1)}}validateConfig();e.exports=f},1121:(e,t,s)=>{const{Message:i}=s(9409);const{Block:n}=s(7271);const r=s(9201);class Adapter{constructor(){}messages(e){throw new Error("Adapter must implement messages() method")}system(e){throw new Error("Adapter must implement system() method")}tools(e){throw new Error("Adapter must implement tools() method")}parse(e){throw new Error("Adapter must implement parse() method")}parseTools(e){throw new Error("Adapter must implement parseTools() method")}parseTokens(e){throw new Error("Adapter must implement parseTokens() method")}_validateMessage(e){if(!(e instanceof i)){throw new Error("Expected Message instance")}}_validateSystem(e){if(!(e instanceof r)){throw new Error("Expected System instance")}}getName(){return this.constructor.name}toString(){return`[${this.getName()}]`}}e.exports=Adapter},9587:(e,t,s)=>{const{Message:i}=s(9409);const{Block:n}=s(7271);const r=s(9201);class Agent{constructor(){this.provider=null;this.toolRegistry=null;this.initialized=false}initialize(e,t){this.provider=e;this.toolRegistry=t;this.initialized=true}isInitialized(){return this.initialized&&this.provider!==null&&this.toolRegistry!==null}getToolsForAgentType(e){const t={General:{categories:null,toolNames:null},Explore:{toolNames:["Glob","Grep","Read","Bash"]},Plan:{toolNames:["Glob","Grep","Read","Bash"]}};const s=t[e]||t["General"];return this.provider.getTools(s)}async execute(e,t,s,n=null){if(!this.isInitialized()){throw new Error("Agent not initialized. Call initialize() first.")}try{const e=this.getToolsForAgentType(s);const r=s==="Explore"||s==="Plan"?"SEARCH":"GENERAL";const o=this.provider.getSystemPrompt(r);const a=i.user(`${t}\n\nIMPORTANT: This is a sub-agent task. Provide a comprehensive report of your findings when complete.`);const l=await this.provider.generateWithTools([a],o,e,this.toolRegistry,{stream:false,model:n||undefined});return l.finalResponse.getText()}catch(t){return`[SUB-AGENT EXECUTION ERROR]\n\nTask: ${e}\nAgent Type: ${s}\n\nError: ${t.message}\n\nThe sub-agent failed to execute. You may want to try the task manually or with different parameters.`}}getSupportedAgentTypes(){return["General","Explore","Plan"]}}const o=new Agent;e.exports=o},7271:e=>{const t={TEXT:"text",TOOL_USE:"tool_use",TOOL_RESULT:"tool_result",THINKING:"thinking",IMAGE:"image"};class Block{constructor(e,t){this.type=e;this.data=t}static text(e){return new Block(t.TEXT,{text:e})}static thinking(e,s=null){const i={thinking:e};if(s){i.signature=s}return new Block(t.THINKING,i)}static toolUse(e,s,i){return new Block(t.TOOL_USE,{id:e,name:s,input:i})}static toolResult(e,s,i=false,n=null){const r={tool_use_id:e,content:s,is_error:i};if(n){r.name=n}return new Block(t.TOOL_RESULT,r)}static image(e,s="base64",i="image/jpeg"){return new Block(t.IMAGE,{type:s,source:e,media_type:i})}isText(){return this.type===t.TEXT}isToolUse(){return this.type===t.TOOL_USE}isToolResult(){return this.type===t.TOOL_RESULT}isThinking(){return this.type===t.THINKING}isImage(){return this.type===t.IMAGE}toJSON(){return{type:this.type,...this.data}}static fromJSON(e){const{type:t,...s}=e;return new Block(t,s)}clone(){return new Block(this.type,{...this.data})}toString(){switch(this.type){case t.TEXT:return`[Text: ${this.data.text?.substring(0,50)}...]`;case t.THINKING:return`[Thinking: ${this.data.thinking?.substring(0,50)}...]`;case t.TOOL_USE:return`[ToolUse: ${this.data.name}(${JSON.stringify(this.data.input)})]`;case t.TOOL_RESULT:return`[ToolResult: ${this.data.is_error?"ERROR":"OK"}]`;case t.IMAGE:return`[Image: ${this.data.media_type}]`;default:return`[Unknown: ${this.type}]`}}}e.exports={Block:Block,BlockType:t}},2162:e=>{class Capability{constructor(e,t={}){this.provider=e;this.config=t}name(){throw new Error("Capability must implement name() method")}supported(){return false}enabled(){return this.supported()&&this.shouldEnable()}shouldEnable(){return false}stats(){return{name:this.name(),supported:this.supported(),enabled:this.enabled()}}toString(){const e=this.enabled()?"✓ enabled":this.supported()?"○ disabled":"✗ unsupported";return`[${this.name()}: ${e}]`}}e.exports=Capability},1135:(e,t,s)=>{const i=s(9896);const n=s(6928);class Client{constructor(e={}){if(!e.apiKey){throw new Error("apiKey is required")}this.apiKey=e.apiKey;this.baseURL=e.baseURL||this.getDefaultBaseURL();this.debug=e.debug||false;this.debugPath=e.debugPath||"./logs";if(this.debug){this.ensureDebugDir()}}getDefaultBaseURL(){throw new Error("Client must implement getDefaultBaseURL() method")}getProviderName(){return"Unknown"}ensureDebugDir(){if(!i.existsSync(this.debugPath)){i.mkdirSync(this.debugPath,{recursive:true})}}saveDebugLog(e,t,s=null,r=null){if(!this.debug)return null;try{const o=(new Date).toISOString().replace(/[:.]/g,"-");const a=this.getProviderName().toLowerCase();const l=n.join(this.debugPath,`${a}-${e}-${o}.json`);const c={timestamp:(new Date).toISOString(),type:e,...r&&{model:r},...s&&{headers:s},data:t};i.writeFileSync(l,JSON.stringify(c,null,2),"utf-8");if(this.debug){console.log(`[DEBUG] ${e} logged to: ${l}`)}return l}catch(t){console.warn(`[DEBUG] Failed to save ${e} log:`,t.message);return null}}handleError(e,t=""){const s=t?`[${t}] `:"";const i=`${s}${this.getProviderName()} API Error: ${e.message}`;const n=new Error(i);n.originalError=e;n.provider=this.getProviderName();return n}toString(){return`[${this.getProviderName()}Client]`}}e.exports=Client},7258:(e,t,s)=>{const{EventEmitter:i}=s(4434);class EventBus extends i{constructor(){super();this.setMaxListeners(20)}toolStart(e,t){this.emit("tool:start",{name:e,input:t,timestamp:Date.now()})}toolEnd(e,t,s=0){this.emit("tool:end",{name:e,result:t,duration:s,timestamp:Date.now()})}toolError(e,t){this.emit("tool:error",{name:e,error:t,timestamp:Date.now()})}streamStart(e={}){this.emit("stream:start",{...e,timestamp:Date.now()})}streamDelta(e,t="text"){this.emit("stream:delta",{delta:e,type:t,timestamp:Date.now()})}streamEnd(e={}){this.emit("stream:end",{...e,timestamp:Date.now()})}streamError(e){this.emit("stream:error",{error:e,timestamp:Date.now()})}system(e,t="info"){this.emit("system",{message:e,level:t,timestamp:Date.now()})}info(e){this.system(e,"info")}warning(e){this.system(e,"warning")}error(e){this.system(e,"error")}success(e){this.system(e,"success")}model(e,t=""){this.emit("model",{model:e,reason:t,timestamp:Date.now()})}providerSwitch(e){this.emit("provider:switch",{provider:e,timestamp:Date.now()})}providerError(e,t){this.emit("provider:error",{provider:e,error:t,timestamp:Date.now()})}capability(e,t){this.emit("capability",{capability:e,enabled:t,timestamp:Date.now()})}warmupStart(e){this.emit("warmup:start",{model:e,timestamp:Date.now()})}warmupComplete(e,t=0){this.emit("warmup:complete",{model:e,duration:t,timestamp:Date.now()})}warmupError(e,t){this.emit("warmup:error",{model:e,error:t,timestamp:Date.now()})}conversationStart(){this.emit("conversation:start",{timestamp:Date.now()})}conversationEnd(e=0){this.emit("conversation:end",{messageCount:e,timestamp:Date.now()})}userMessage(e){this.emit("message:user",{content:e,timestamp:Date.now()})}assistantMessage(e){this.emit("message:assistant",{content:e,timestamp:Date.now()})}taskClassified(e){this.emit("task:classified",{type:e.type,complexity:e.complexity,needsModification:e.needsModification,confidence:e.confidence,timestamp:Date.now()})}scheduleDecision(e){this.emit("schedule:decision",{taskInfo:e.taskInfo,model:e.model,tools:e.tools,reason:e.reason,estimatedCost:e.estimatedCost,costSaving:e.costSaving,timestamp:Date.now()})}reset(){this.removeAllListeners()}listenerCount(e){return super.listenerCount(e)}subscribe(e){for(const[t,s]of Object.entries(e)){this.on(t,s)}return this}unsubscribe(e){for(const[t,s]of Object.entries(e)){this.off(t,s)}return this}once(e,t){super.once(e,t);return this}waitFor(e,t=0){return new Promise(((s,i)=>{let n=null;const handler=e=>{if(n)clearTimeout(n);s(e)};this.once(e,handler);if(t>0){n=setTimeout((()=>{this.off(e,handler);i(new Error(`Timeout waiting for event: ${e}`))}),t)}}))}generateStart(e,t){this.emit("generate:start",{provider:e,model:t,timestamp:Date.now()})}generateComplete(e,t,s=null){this.emit("generate:complete",{provider:e,message:t,usage:s,timestamp:Date.now()})}generateError(e,t){this.emit("generate:error",{provider:e,error:t,timestamp:Date.now()})}async requestApproval(e,t,s,i=3e4){const n=`${Date.now()}_${Math.random().toString(36).substr(2,9)}`;this.emit("approval:request",{requestId:n,toolName:e,category:t,input:s,timestamp:Date.now()});try{const e=await this.waitFor(`approval:response:${n}`,i);return{approved:e.approved===true,autoApproveCategory:e.autoApproveCategory===true}}catch(t){this.warning(`Approval timeout for ${e}, operation cancelled`);return{approved:false,autoApproveCategory:false}}}approvalResponse(e,t,s=false){this.emit(`approval:response:${e}`,{requestId:e,approved:t,autoApproveCategory:s,timestamp:Date.now()})}}let n=null;function getInstance(){if(!n){n=new EventBus}return n}e.exports=getInstance();e.exports.EventBus=EventBus},9409:(e,t,s)=>{const{Block:i,BlockType:n}=s(7271);const r={USER:"user",ASSISTANT:"assistant",SYSTEM:"system"};class Message{constructor(e,t,s={}){this.role=e;this.content=this._normalizeContent(t);this.metadata=s}_normalizeContent(e){if(typeof e==="string"){return[i.text(e)]}if(Array.isArray(e)){return e.map((e=>{if(e instanceof i){return e}return i.fromJSON(e)}))}throw new Error("Content must be string or Block array")}static user(e,t={}){return new Message(r.USER,e,t)}static assistant(e,t={}){return new Message(r.ASSISTANT,e,t)}static system(e,t={}){return new Message(r.SYSTEM,e,t)}isUser(){return this.role===r.USER}isAssistant(){return this.role===r.ASSISTANT}isSystem(){return this.role===r.SYSTEM}getText(){return this.content.filter((e=>e.isText())).map((e=>e.data.text)).join("")}getThinking(){return this.content.filter((e=>e.isThinking())).map((e=>e.data.thinking)).join("\n")}getToolUses(){return this.content.filter((e=>e.isToolUse()))}getToolResults(){return this.content.filter((e=>e.isToolResult()))}hasToolUse(){return this.content.some((e=>e.isToolUse()))}hasToolResult(){return this.content.some((e=>e.isToolResult()))}hasThinking(){return this.content.some((e=>e.isThinking()))}isTextOnly(){return this.content.every((e=>e.isText()))}meta(e,t=undefined){return this.metadata[e]!==undefined?this.metadata[e]:t}setMeta(e,t){this.metadata[e]=t;return this}hasMeta(e){return this.metadata[e]!==undefined}addBlock(e){this.content.push(e);return this}toJSON(){return{role:this.role,content:this.content.map((e=>e.toJSON())),metadata:this.metadata}}static fromJSON(e){const t=e.content.map((e=>i.fromJSON(e)));return new Message(e.role,t,e.metadata||{})}clone(){const e=this.content.map((e=>e.clone()));return new Message(this.role,e,{...this.metadata})}toString(){const e=this.getText().substring(0,100);const t=this.getToolUses();const s=t.length>0?` [${t.length} tools]`:"";return`[${this.role}]${s}: ${e}...`}get length(){return this.content.length}isEmpty(){return this.content.length===0||this.content.length===1&&this.getText().trim()===""}}e.exports={Message:Message,Role:r}},931:e=>{class Model{constructor(e){this.fastModel=e.FAST_MODEL;this.powerfulModel=e.POWERFUL_MODEL||e.MODEL;this.readonlyTools=["Glob","Grep","Read","Bash","TodoWrite"];this.modelCosts={"claude-haiku-4-5-20251001":.15,"claude-sonnet-4-5-20250929":1,"claude-opus-4-1-20250805":5,"gemini-2.0-flash":.1,"gemini-2.5-flash":1,"gemini-2.5-pro":1.2}}analyze(e,t={}){const s=this.selectModel(e,t);const i=this.selectTools(e);const n=this.estimateCost(e,s,t);return{taskInfo:e,model:s,tools:i,reason:this.explainDecision(e,s,t),estimatedCost:n,costSaving:this.calculateSaving(n,e)}}selectModel(e,t){if(t.conversationLength>10){return this.powerfulModel}if(e.complexity==="SIMPLE"&&!e.needsModification){return this.fastModel}if(["SEARCH","READ"].includes(e.type)){return this.fastModel}if(["CODE","DEBUG","TEST"].includes(e.type)){return this.powerfulModel}if(e.complexity==="COMPLEX"){return this.powerfulModel}if(e.type==="REVIEW"&&e.complexity!=="SIMPLE"){return this.powerfulModel}return this.powerfulModel}selectTools(e){const t=["SEARCH","READ","REVIEW"];if(t.includes(e.type)&&!e.needsModification){return this.readonlyTools}return null}estimateCost(e,t,s){const i=this.modelCosts[t]||1;let n=1;if(e.complexity==="COMPLEX"){n=2}else if(e.complexity==="MODERATE"){n=1.5}const r=1+(s.conversationLength||0)*.1;return{relative:i*n*r,baseCost:i,complexityMultiplier:n,historyMultiplier:r}}calculateSaving(e,t){const s=this.modelCosts[this.powerfulModel]||1;const i=e.baseCost;if(i>=s){return{percentSaving:0,description:"Using powerful model for best quality"}}const n=(s-i)/s*100;return{percentSaving:Math.round(n),description:`Saving ${Math.round(n)}% by using fast model`}}explainDecision(e,t,s){const i=[];if(s.conversationLength>10){i.push("long conversation history")}if(["SEARCH","READ"].includes(e.type)){i.push(`${e.type.toLowerCase()} task`)}else if(["CODE","DEBUG","TEST"].includes(e.type)){i.push(`${e.type.toLowerCase()} task requires strong reasoning`)}if(e.complexity==="COMPLEX"){i.push("complex task")}else if(e.complexity==="SIMPLE"){i.push("simple task")}if(e.needsModification){i.push("needs code modification")}const n=t===this.fastModel;const r=n?"fast":"powerful";i.push(`using ${r} model`);return i.join(", ")}getStats(){return{fastModel:this.fastModel,powerfulModel:this.powerfulModel,readonlyToolsCount:this.readonlyTools.length,supportedModels:Object.keys(this.modelCosts).length}}validateConfig(){const e=[];if(!this.fastModel){e.push("FAST_MODEL not configured")}if(!this.powerfulModel){e.push("POWERFUL_MODEL not configured")}if(this.fastModel&&!this.modelCosts[this.fastModel]){e.push(`Unknown fast model: ${this.fastModel}`)}if(this.powerfulModel&&!this.modelCosts[this.powerfulModel]){e.push(`Unknown powerful model: ${this.powerfulModel}`)}return{valid:e.length===0,errors:e}}}e.exports=Model},7617:e=>{class Result{constructor(e,t=null,s=null,i={}){this.success=e;this.data=t;this.error=s;this.metadata=i}static ok(e,t={}){return new Result(true,e,null,t)}static fail(e,t={}){return new Result(false,null,e,t)}isSuccess(){return this.success===true}isFailure(){return this.success===false}getData(){return this.data}getError(){return this.error}getErrorMessage(){if(!this.error)return"";if(this.error instanceof Error){return this.error.message}return String(this.error)}meta(e,t=undefined){return this.metadata[e]!==undefined?this.metadata[e]:t}setMeta(e,t){this.metadata[e]=t;return this}map(e){if(this.isFailure()){return this}try{const t=e(this.data);return Result.ok(t,this.metadata)}catch(e){return Result.fail(e,this.metadata)}}mapError(e){if(this.isSuccess()){return this}try{const t=e(this.error);return Result.fail(t,this.metadata)}catch(e){return Result.fail(e,this.metadata)}}flatMap(e){if(this.isFailure()){return this}try{return e(this.data)}catch(e){return Result.fail(e,this.metadata)}}getOrElse(e){return this.isSuccess()?this.data:e}onSuccess(e){if(this.isSuccess()){e(this.data)}return this}onFailure(e){if(this.isFailure()){e(this.error)}return this}toString(){if(this.isFailure()){return`Error: ${this.getErrorMessage()}`}if(this.data===null||this.data===undefined){return""}if(typeof this.data==="string"){return this.data}if(this.data&&typeof this.data==="object"){if("stdout"in this.data||"stderr"in this.data||"exitCode"in this.data){return this._formatBashResult(this.data)}if(Array.isArray(this.data)){return this.data.join("\n")}return JSON.stringify(this.data,null,2)}return String(this.data)}_formatBashResult(e){const t=[];if(e.stdout){t.push(e.stdout)}if(e.stderr){t.push(`[stderr] ${e.stderr}`)}if(e.exitCode&&e.exitCode!==0){t.push(`[exit code: ${e.exitCode}]`)}return t.join("\n")}toJSON(){return{success:this.success,data:this.data,error:this.error instanceof Error?{message:this.error.message,stack:this.error.stack,name:this.error.name}:this.error,metadata:this.metadata}}static fromJSON(e){let t=e.error;if(t&&typeof t==="object"&&t.message){const e=new Error(t.message);e.name=t.name||"Error";if(t.stack)e.stack=t.stack;t=e}return new Result(e.success,e.data,t,e.metadata||{})}clone(){return new Result(this.success,this.data,this.error,{...this.metadata})}toCompactString(){if(this.isSuccess()){const e=this.toString().substring(0,100);return`[OK]: ${e}${e.length>=100?"...":""}`}else{return`[ERROR]: ${this.getErrorMessage()}`}}}e.exports=Result},9201:e=>{class System{constructor(e,t={}){this.content=e;this.options={cacheable:t.cacheable||false,breakpoint:t.breakpoint||false,priority:t.priority||0}}static create(e){return new System(e)}static cacheable(e){return new System(e,{cacheable:true})}static breakpoint(e){return new System(e,{cacheable:true,breakpoint:true})}setCacheable(e){this.options.cacheable=e;return this}setBreakpoint(e){this.options.breakpoint=e;if(e){this.options.cacheable=true}return this}setPriority(e){this.options.priority=e;return this}isCacheable(){return this.options.cacheable===true}isBreakpoint(){return this.options.breakpoint===true}getPriority(){return this.options.priority||0}isEmpty(){return!this.content||this.content.trim()===""}get length(){return this.content.length}toJSON(){return{content:this.content,options:this.options}}static fromJSON(e){return new System(e.content,e.options)}clone(){return new System(this.content,{...this.options})}merge(e,t="\n\n"){const s=this.content+t+e.content;const i={cacheable:this.options.cacheable||e.options.cacheable,breakpoint:this.options.breakpoint||e.options.breakpoint,priority:Math.max(this.options.priority,e.options.priority)};return new System(s,i)}append(e,t="\n\n"){this.content+=t+e;return this}prepend(e,t="\n\n"){this.content=e+t+this.content;return this}toString(){const e=this.content.substring(0,100);const t=[];if(this.isCacheable())t.push("cacheable");if(this.isBreakpoint())t.push("breakpoint");if(this.getPriority()>0)t.push(`priority:${this.getPriority()}`);const s=t.length>0?` [${t.join(", ")}]`:"";return`[System${s}]: ${e}...`}static fromArray(e,t={}){if(!Array.isArray(e)){throw new Error("contents must be an array")}return e.map((e=>new System(e,t)))}static join(e,t="\n\n"){if(!Array.isArray(e)||e.length===0){throw new Error("systems must be a non-empty array")}let s=e[0].clone();for(let i=1;i<e.length;i++){s=s.merge(e[i],t)}return s}}e.exports=System},745:e=>{class Task{classify(e){const t=e.toLowerCase().trim();const s={type:this.determineType(t),complexity:this.determineComplexity(t,e),needsModification:this.needsWriteAccess(t),confidence:0};s.confidence=this.calculateConfidence(t,s);return s}determineType(e){if(this._matchKeywords(e,["搜索","查找","找到","定位","寻找","find","search","locate","where","grep","glob","哪些文件","什么文件","which file"])){return"SEARCH"}if(this._matchKeywords(e,["调试","修复","bug","错误","解决","debug","fix","solve","error","issue","不工作","not working","报错","crash","problem"])){return"DEBUG"}if(this._matchKeywords(e,["测试","验证","单元测试","集成测试","编写测试","test","spec","verify","unit test","integration test","test case","测试用例","write test"])){return"TEST"}if(this._matchKeywords(e,["审查","检查","优化","重构","改进","提升","代码质量","review","check","optimize","refactor","improve","enhance","code quality","inspect"])){return"REVIEW"}if(this._matchKeywords(e,["编写","实现","创建","写","代码","添加","开发","write","implement","create","code","develop","add","build","make","新增功能","new feature"])){return"CODE"}if(this._matchKeywords(e,["读取","查看","显示","分析","理解","解释","read","show","display","analyze","explain","what","how does","tell me about","是什么","怎么工作","什么意思"])){return"READ"}return"GENERAL"}determineComplexity(e,t){let s=0;const i=(t.match(/[\u4e00-\u9fa5]/g)||[]).length;const n=t.split(/\s+/).filter((e=>e.length>0)).length;let r=i>t.length*.3?i:n;if(r>50){s+=3}else if(r>20){s+=2}else if(r>8){s+=1}const o=["重构","架构","设计","分析","复杂","系统","分布式","微服务","多个","所有","整个","算法","refactor","architecture","design","analyze","complex","system","distributed","microservice","multiple","all","entire","comprehensive","algorithm","caching","redis","database"];let a=0;o.forEach((t=>{if(e.includes(t.toLowerCase())){a++}}));if(a>=2){s+=3}else if(a===1){s+=2}const l=["并且","然后","接着","之后","同时","还要","包含","and then","after","next","also","additionally","as well as","furthermore","with","including"];if(this._matchKeywords(e,l)){s+=1}const c=["只","仅","简单","just","only","simple","quick","briefly"];const h=["快速排序","快速傅里叶","quick sort","quicksort"];const u=h.some((t=>e.includes(t.toLowerCase())));if(!u&&this._matchKeywords(e,c)){s-=2}if(u||e.includes("快速")&&(e.includes("排序")||e.includes("算法"))){}else if(e.includes("快速")||e.includes("查看一下")){s-=1}if(s>=4){return"COMPLEX"}else if(s>=2){return"MODERATE"}else{return"SIMPLE"}}needsWriteAccess(e){const t=["写入","创建","修改","删除","编辑","保存","更新","编写","write","create","modify","delete","edit","save","update","remove","change","add","实现","添加","新增","开发","implement","develop","build","修复","fix","patch"];return this._matchKeywords(e,t)}calculateConfidence(e,t){let s=.7;const i=e.split(/\s+/).length;if(i>=10){s+=.1}else if(i<3){s-=.2}if(t.type==="GENERAL"){s-=.1}const n=this._countTypeMatches(e);if(n>2){s-=.1}else if(n===1){s+=.1}return Math.max(.5,Math.min(1,s))}_matchKeywords(e,t){return t.some((t=>e.includes(t.toLowerCase())))}_countTypeMatches(e){const t=[["搜索","查找","find","search"],["读取","查看","read","show"],["编写","实现","write","implement"],["审查","优化","review","optimize"],["调试","修复","debug","fix"],["测试","test"]];let s=0;for(const i of t){if(this._matchKeywords(e,i)){s++}}return s}static getTypeDescription(e){const t={SEARCH:"文件搜索和定位",READ:"内容读取和分析",CODE:"代码编写和实现",REVIEW:"代码审查和优化",DEBUG:"问题调试和修复",TEST:"测试编写和验证",GENERAL:"通用任务"};return t[e]||"未知任务类型"}static getComplexityDescription(e){const t={SIMPLE:"简单任务",MODERATE:"中等复杂度",COMPLEX:"复杂任务"};return t[e]||"未知复杂度"}}e.exports=Task},5249:(e,t,s)=>{const i=s(1287);class Tools{constructor(e={}){this.config=e;this.registry=i;this.customSchemas=new Map}_ensureInitialized(){if(!this.registry.initialized){this.registry.initialize()}}_toPlainObject(e){return{name:e.name,description:e.description,schema:e.schema,category:e.category}}getAllTools(){this._ensureInitialized();return this.registry.getAllTools().map((e=>this._toPlainObject(e)))}getToolsByCategory(e){this._ensureInitialized();return this.registry.getToolsByCategory(e).map((e=>this._toPlainObject(e)))}getTool(e){this._ensureInitialized();const t=this.registry.getTool(e);if(!t)return null;const s=this._toPlainObject(t);if(this.customSchemas.has(e)){s.schema=this.customSchemas.get(e)}return this.customizeTool(s)}registerCustomSchema(e,t){this.customSchemas.set(e,t)}getToolsForRequest(e={}){let t=this.getAllTools();t=t.map((e=>this.customizeTool(e)));if(e.categories){const s=Array.isArray(e.categories)?e.categories:[e.categories];t=t.filter((e=>s.includes(e.category)))}if(e.toolNames){const s=Array.isArray(e.toolNames)?e.toolNames:[e.toolNames];t=t.filter((e=>s.includes(e.name)))}return t}customizeTool(e){return e}getToolMetadata(){return{vendor:"base",version:"1.0.0",features:[]}}}e.exports=Tools},2227:(e,t,s)=>{const i=s(2162);class GeminiCaching extends i{constructor(e,t,s){super(e,s);this.client=t;this.cachedContentName=null;this.MIN_TOKENS={flash:2048,pro:4096}}name(){return"Caching"}supported(){return true}shouldEnable(){return this.config.ENABLE_CACHE!==false}estimateTokens(e){if(!e)return 0;return Math.ceil(e.length/4)}getMinTokens(e){if(e.includes("pro")){return this.MIN_TOKENS.pro}return this.MIN_TOKENS.flash}meetsMinimumTokens(e,t){const s=this.estimateTokens(e);const i=this.getMinTokens(t);return s>=i}async createCachedContent(e,t,s={}){if(!this.enabled()){return null}if(!this.meetsMinimumTokens(t.content,e)){const s=this.estimateTokens(t.content);const i=this.getMinTokens(e);if(this.config.VERBOSE){console.warn(`[GeminiCaching] Content too short for caching: `+`${s} tokens (minimum: ${i}). Skipping cache creation.`)}return null}try{const i={parts:[{text:t.content}]};const n=await this.client.createCachedContent({model:e,systemInstruction:i,displayName:s.displayName||`${e}-session`,ttl:s.ttl||"3600s"});this.cachedContentName=n.name;if(this.config.VERBOSE){console.log(`[GeminiCaching] Cache created: ${this.cachedContentName}`)}return n.name}catch(e){if(this.config.VERBOSE){console.warn(`[GeminiCaching] Failed to create cached content: ${e.message}`)}return null}}async applyToRequest(e){if(!this.enabled()){return e}if(!this.cachedContentName&&e.systemInstruction){const t=e.systemInstruction.parts?.[0]?.text||"";if(this.meetsMinimumTokens(t,e.model)){const s={content:t};await this.createCachedContent(e.model,s,{displayName:`${e.model}-auto`,ttl:"3600s"})}}if(this.cachedContentName){const t={...e};delete t.systemInstruction;t.cachedContent=this.cachedContentName;return t}return e}getCachedContentName(){return this.cachedContentName}async clear(){if(this.cachedContentName){try{await this.client.deleteCachedContent(this.cachedContentName);if(this.config.VERBOSE){console.log(`[GeminiCaching] Cache deleted: ${this.cachedContentName}`)}}catch(e){console.warn(`[GeminiCaching] Failed to delete cached content: ${e.message}`)}this.cachedContentName=null}}stats(){return{...super.stats(),has_cache:!!this.cachedContentName,cache_name:this.cachedContentName,min_tokens:{flash:this.MIN_TOKENS.flash,pro:this.MIN_TOKENS.pro}}}}e.exports=GeminiCaching},3326:(e,t,s)=>{const i=s(9201);class GeminiPrompt{constructor(e){this.config=e;this.workdir=e.WORKDIR||process.cwd();this.platform=process.platform}getPrompt(e="GENERAL",t={}){const s={SEARCH:this.getSearchPrompt.bind(this),READ:this.getReadPrompt.bind(this),CODE:this.getCodePrompt.bind(this),REVIEW:this.getReviewPrompt.bind(this),DEBUG:this.getDebugPrompt.bind(this),TEST:this.getTestPrompt.bind(this),GENERAL:this.getGeneralPrompt.bind(this)};const i=s[e]||s["GENERAL"];return i(t)}getSearchPrompt(e){const t=`You are Gemini, a fast file search assistant.\n\nDirectory: ${this.workdir}\nPlatform: ${this.platform}\n\nTools: Glob (patterns), Grep (content), Read (verify), Task (complex searches)\n\nTask: Find files and code quickly.\n- Use Glob for filenames\n- Use Grep for content\n- Use Task (Explore agent) for complex multi-iteration searches\n- Show results with counts\n- Be direct and efficient\n\nDO NOT use Write or Edit tools.\n\nStart searching now.`;return i.cacheable(t)}getReadPrompt(e){const t=`You are Gemini, a code reading specialist.\n\nDirectory: ${this.workdir}\n\nTask: Read and explain code clearly.\n- Read the code thoroughly\n- Explain key components\n- Use simple language\n- Reference specific lines\n\nTools: Read, Glob, Grep\n\nDO NOT modify files. Focus on understanding and explaining.\n\nReady to analyze.`;return i.cacheable(t)}getCodePrompt(e){const t=`You are Gemini, a software engineer.\n\nDirectory: ${this.workdir}\nPlatform: ${this.platform}${this.platform==="win32"?" (Windows - Bash commands: use dir, npm, git. Avoid ls, cat, grep)":""}\n\nTask: Implement features with clean, working code.\n\n# Workflow\n1. Read existing code (understand patterns)\n2. **Plan with TodoWrite** (for 3+ steps - REQUIRED for complex tasks)\n3. Write clean code (match existing style)\n4. Test when possible\n\n# Task Management (CRITICAL)\n**BEFORE coding: Count steps!**\n- 1-2 steps? Start coding\n- 3+ steps? CREATE TodoWrite FIRST!\n\nAuto-detect 3+ steps:\n• "Implement X" → research + code + test = 3 steps\n• "Fix and add tests" → fix + test = 2+ steps (use TodoWrite!)\n• User says "Make sure you also..." → extra step (use TodoWrite!)\n• Multiple files involved → use TodoWrite\n\nProcess:\n1. Count steps → ≥3? Create TodoWrite list\n2. Start step → mark in_progress FIRST\n3. Done → mark completed IMMEDIATELY\n4. Only ONE in_progress at a time\n\n# Code Quality\n- Clear names, error handling\n- Consistent style\n- Modular, testable\n- Comments for complex logic\n\nTools: Read, Write, Edit, Glob, Grep, Bash, TodoWrite, Task\n\nStart implementing.`;return i.cacheable(t)}getReviewPrompt(e){const t=`You are Gemini, a code reviewer.\n\nDirectory: ${this.workdir}\n\nTask: Review code for quality and issues.\n\n# Before You Start\nIs this a complex review (multiple files OR deep analysis)?\n→ YES? CREATE TodoWrite list FIRST with review steps\n→ NO? Just review directly\n\n# Task Management (CRITICAL)\nFor complex reviews (3+ steps), use TodoWrite:\n1. List all files/areas to review\n2. Mark each as in_progress when reviewing\n3. Mark completed after each area\n4. Only ONE in_progress at a time\n\nExample: "Review entire project" → TodoWrite with:\n- Review project structure\n- Review main components\n- Review security patterns\n- Generate final report\n\n# Focus\n- Correctness (bugs, logic errors)\n- Security (vulnerabilities)\n- Performance (inefficiencies)\n- Maintainability (clarity, patterns)\n\n# Output\nList issues by priority (Critical, Important, Minor).\nBe specific. Reference line numbers. Explain why.\n\nDO NOT modify code unless asked.\n\nStart reviewing.`;return i.cacheable(t)}getDebugPrompt(e){const t=`You are Gemini, a debugging specialist.\n\nDirectory: ${this.workdir}\n\nTask: Find and fix bugs efficiently.\n\n# Debugging Method\n1. Reproduce the issue\n2. Read relevant code\n3. Identify root cause\n4. Fix it\n5. Test the fix\n\n# Task Management\nFor complex debugging (3+ steps), use TodoWrite:\n- Reproduce bug\n- Investigate cause\n- Implement fix\n- Verify solution\n- Test edge cases\n\nMark each step completed before next.\n\nTools: Read, Grep, Bash, Edit, TodoWrite\n\nOutput: Explain what broke, why, and how you fixed it.\n\nStart debugging.`;return i.cacheable(t)}getTestPrompt(e){const t=`You are Gemini, a test engineer.\n\nDirectory: ${this.workdir}\n\nTask: Write effective, maintainable tests.\n\nCoverage:\n- Happy path\n- Edge cases\n- Error handling\n\nTest Quality:\n- Clear names\n- Independent tests\n- Fast execution\n- Easy to understand\n\nTools: Read, Write, Bash\n\nMatch existing test style. Run tests after writing.\n\nStart testing.`;return i.cacheable(t)}getGeneralPrompt(e){const t=`You are Gemini, a helpful coding assistant.\n\nDirectory: ${this.workdir}\nPlatform: ${this.platform}${this.platform==="win32"?" (Windows - use dir, type, copy)":""}\n\nTools: Read, Write, Edit, Glob, Grep, Bash, TodoWrite, Task\n\n# Task Management (CRITICAL - DON'T SKIP!)\n**RULE: 3+ steps = TodoWrite MANDATORY**\n\nQuick decision:\n1. Count steps in user request\n2. If ≥3 → CREATE TodoWrite BEFORE coding\n3. If <3 → Just do it\n\nAuto-trigger signals:\n✓ User says "implement" → likely 3+ steps (research + code + test)\n✓ User says "and" → multiple tasks ("fix X and test")\n✓ User says "Make sure..." → extra requirement\n✓ User gives numbered list → convert to todos\n✓ You think "I need to research first" → 3+ steps ahead\n\nWorkflow:\n1. See trigger? Create TodoWrite\n2. Start step? Mark in_progress FIRST\n3. Done? Mark completed IMMEDIATELY\n4. Only ONE in_progress at a time\n\n# Tool Selection\nFile operations:\n- Read files: Use Read (can read multiple in parallel)\n- Edit files: Use Edit (must Read first)\n- Create files: Use Write (only when necessary)\n- Find files: Use Glob (pattern matching)\n- Search content: Use Grep (with type/glob filters)\n\nCommands:\n- Use Bash for: git, npm, docker, pytest\n- DO NOT use Bash for: cat, grep, find (use dedicated tools)\n\nComplex tasks:\n- Use Task (Explore agent) for: complex codebase exploration, multi-iteration searches\n- Use TodoWrite for: tracking multi-step implementations (3+ steps)\n\n# Best Practices\n1. Read before editing\n2. Track complex tasks with TodoWrite (3+ steps)\n3. Use Task for complex searches/explorations\n4. Match existing code style\n5. Test when possible\n6. Ask if unclear\n\nReady to help.`;return i.cacheable(t)}getStats(){return{provider:"Google (Gemini)",supportedTypes:["SEARCH","READ","CODE","REVIEW","DEBUG","TEST","GENERAL"],cachingEnabled:true,averageLength:"100-200 words",style:"Concise, direct, action-oriented"}}}e.exports=GeminiPrompt},4034:(e,t,s)=>{const i=s(2162);const n=s(7258);const{Message:r}=s(9409);const{Block:o}=s(7271);class GeminiStreaming extends i{constructor(e,t,s,i){super(e,i);this.client=t;this.adapter=s}name(){return"Streaming"}supported(){return true}shouldEnable(){return this.config.ENABLE_STREAMING!==false}configure(e){return e}async handle(e){n.streamStart();const t=[];let s=null;let i=null;try{for await(const r of this._parseJSONStream(e)){if(!r.candidates||r.candidates.length===0){continue}const e=r.candidates[0];if(e.content&&e.content.parts){for(const s of e.content.parts){t.push(s);if(s.thought===true){const e=this.config.INCLUDE_THOUGHTS!==false;if(e&&s.text){n.streamDelta(s.text,"thinking")}}else{if(s.text){n.streamDelta(s.text,"text")}}}}if(e.finishReason){s=e.finishReason}if(r.usageMetadata){i=r.usageMetadata}}n.streamEnd({usage:i});const r={parts:t,finishReason:s,usage:i};if(this.client.debug){this.client.saveDebugLog("stream-response",r)}return r}catch(e){n.streamError(e);throw e}}async*_parseJSONStream(e){const t=e.getReader();const s=new TextDecoder;let i="";try{while(true){const{done:e,value:n}=await t.read();if(e)break;i+=s.decode(n,{stream:true});let r=0;while(true){const e=i.indexOf("{",r);if(e===-1){i=i.slice(r);break}let t=0;let s=-1;for(let n=e;n<i.length;n++){if(i[n]==="{")t++;if(i[n]==="}")t--;if(t===0){s=n+1;break}}if(s===-1){i=i.slice(e);break}const n=i.slice(e,s);try{const e=JSON.parse(n);yield e}catch(e){console.warn("Failed to parse JSON chunk:",e.message);console.warn("Chunk content:",n.substring(0,200));if(n.includes("error")||n.includes("Error")){throw new Error(`API returned error: ${n.substring(0,500)}`)}}r=s}}if(i.trim()){try{const e=JSON.parse(i);yield e}catch(e){}}}finally{t.releaseLock()}}}e.exports=GeminiStreaming},5796:(e,t,s)=>{const i=s(2162);class GeminiThinking extends i{constructor(e,t){super(e,t)}name(){return"Thinking"}supported(){const e=this.provider.model||"";return e.includes("gemini-2")||e.includes("2.5")||e.includes("2.0")}shouldEnable(){if(this.config.ENABLE_THINKING===false){return false}const e=this.provider.model||"";const t=this.config.POWERFUL_MODEL||"";return e===t}configure(e){if(!this.enabled()){return e}if(this.config.ENABLE_THINKING===false){return e}const t=e.model||this.provider.model;const s=this.config.POWERFUL_MODEL||"";if(t!==s){return e}const i=this.config.THINKING_BUDGET!==undefined?this.config.THINKING_BUDGET:-1;const n=this.config.INCLUDE_THOUGHTS!==false;const r={...e};if(!r.generationConfig){r.generationConfig={}}r.generationConfig.thinkingConfig={thinkingBudget:i,includeThoughts:n};return r}extract(e){if(!e||!e.parts){return[]}return e.parts.filter((e=>e.thought===true)).map((e=>e.text||""))}getThinkingTokens(e){if(!e||!e.usageMetadata){return 0}return e.usageMetadata.thoughtsTokenCount||0}stats(){const e=this.provider.model||"unknown";const t=this.config.POWERFUL_MODEL||"";const s=this.config.ENABLE_THINKING!==false&&e===t;return{...super.stats(),model:e,thinking_enabled:s,thinking_budget:this.config.THINKING_BUDGET!==undefined?this.config.THINKING_BUDGET:-1,include_thoughts:this.config.INCLUDE_THOUGHTS!==false}}}e.exports=GeminiThinking},65:(e,t,s)=>{const i=s(5249);class GeminiTools extends i{constructor(e={}){super(e);this.maxToolsPerRequest=e.MAX_TOOLS_PER_REQUEST||64;this._initializeCustomSchemas()}_initializeCustomSchemas(){this.registerCustomSchema("Bash",{type:"object",properties:{command:{type:"string",description:"The bash command to execute (REQUIRED). **PLATFORM: Windows** - Use Windows commands! "+'Examples: "dir" (list files, NOT "ls -la"), "npm install" (ok), "git status" (ok), "mkdir my-folder" (ok). '+"AVOID: ls, cat, grep, cp (use Read/Write/Edit/Glob/Grep tools instead)."},timeout:{type:"number",description:"Timeout in milliseconds. Default: 120000 (2 minutes), Max: 600000 (10 minutes). "+"Example: 30000 for a 30-second timeout"},description:{type:"string",description:"Clear, concise description of what this command does (5-10 words, active voice). "+"Examples:\n"+'• For "ls": "List files in current directory"\n'+'• For "git status": "Show working tree status"\n'+'• For "npm install": "Install package dependencies"\n'+'• For "mkdir foo": "Create directory \'foo\'"'},run_in_background:{type:"boolean",description:"Set to true to run command in background. Use for long-running commands. "+'Example: true for "npm start" or dev servers'},dangerouslyDisableSandbox:{type:"boolean",description:"Set to true to disable sandbox mode (USE WITH CAUTION). Only for trusted commands."}},required:["command"]});this.registerCustomSchema("Read",{type:"object",properties:{file_path:{type:"string",description:"Absolute path to the file to read (REQUIRED). Must be a valid file path. "+'Examples: "/home/user/project/src/index.js", "C:\\\\Users\\\\name\\\\file.txt". '+'DO NOT use relative paths like "./file.txt"'},offset:{type:"number",description:"Starting line number (0-based). Use for reading specific sections of large files. "+"Example: 100 to start reading from line 100"},limit:{type:"number",description:"Number of lines to read. Use with offset for pagination. "+"Example: 50 to read 50 lines"}},required:["file_path"]});this.registerCustomSchema("Edit",{type:"object",properties:{file_path:{type:"string",description:"Absolute path to the file to edit (REQUIRED). "+'Example: "/home/user/project/src/main.js"'},old_string:{type:"string",description:"Exact text to find and replace (REQUIRED). Must match exactly including whitespace. "+'Example: "function hello() {\\n  console.log(\\"hi\\");\\n}"'},new_string:{type:"string",description:"New text to insert (REQUIRED). "+'Example: "function hello() {\\n  console.log(\\"Hello, World!\\");\\n}"'},replace_all:{type:"boolean",description:"Replace all occurrences (default: false). Set to true for global replacement. "+"Example: true when renaming a variable throughout a file"}},required:["file_path","old_string","new_string"]});this.registerCustomSchema("Write",{type:"object",properties:{file_path:{type:"string",description:"Absolute path for the new file (REQUIRED). Will create parent directories if needed. "+'Example: "/home/user/project/src/utils/helper.js"'},content:{type:"string",description:"Content to write to the file (REQUIRED). Will overwrite if file exists. "+'Example: "export function add(a, b) { return a + b; }"'}},required:["file_path","content"]});this.registerCustomSchema("Glob",{type:"object",properties:{pattern:{type:"string",description:"Glob pattern to match files (REQUIRED). "+'Examples: "**/*.js" (all JS files), "src/**/*.ts" (TS files in src), '+'"*.json" (JSON files in current dir), "**/*test*.js" (test files)'},path:{type:"string",description:"Directory to search in (optional, defaults to current directory). "+'Example: "/home/user/project/src"'}},required:["pattern"]});this.registerCustomSchema("Grep",{type:"object",properties:{pattern:{type:"string",description:"Regular expression pattern to search for (REQUIRED). "+'Examples: "TODO", "function\\s+\\w+", "import.*from"'},path:{type:"string",description:"Directory or file to search in (optional, defaults to current directory). "+'Example: "src/components"'},output_mode:{type:"string",description:'Output format (optional, default: "files_with_matches"). '+'Options: "content" (show matching lines), "files_with_matches" (show file paths), '+'"count" (show match counts per file)'},glob:{type:"string",description:"File pattern filter (optional). "+'Examples: "*.js", "*.{ts,tsx}", "**/*.py"'},type:{type:"string",description:"File type to search (optional, more efficient than glob). "+'Common types: "js", "py", "rust", "go", "java". '+'Example: "js" to search only JavaScript files'},"-i":{type:"boolean",description:"Case insensitive search (optional, default: false). "+'Example: true to match "TODO", "todo", "Todo"'},"-n":{type:"boolean",description:'Show line numbers in output (optional, only with "content" mode). '+"Example: true"},"-A":{type:"number",description:'Show N lines after each match (optional, only with "content" mode). '+"Example: 3 to show 3 lines of context after matches"},"-B":{type:"number",description:'Show N lines before each match (optional, only with "content" mode). '+"Example: 2 to show 2 lines of context before matches"},"-C":{type:"number",description:'Show N lines before and after each match (optional, only with "content" mode). '+"Example: 5 for 5 lines of context on both sides"},head_limit:{type:"number",description:"Limit output to first N results (optional, works with all modes). "+"Example: 10 to show only first 10 matches/files"},multiline:{type:"boolean",description:"Enable multiline mode where . matches newlines (optional, default: false). "+"Use for patterns spanning multiple lines"}},required:["pattern"]});this.registerCustomSchema("TodoWrite",{type:"object",properties:{todos:{type:"array",description:"Array of todo items (REQUIRED). **AUTO-CREATE for 3+ steps!** "+'Trigger keywords: user says "implement X" (research+code+test), "fix and test" (2 tasks), '+'"Make sure you..." (extra requirement), numbered list, or "and" between tasks. '+"Each todo: content (what to do), status (pending/in_progress/completed), activeForm (doing what). "+'Example: User: "Add login and write tests" → CREATE 2 todos: 1) Add login feature, 2) Write login tests.',items:{type:"object",properties:{content:{type:"string",description:"Todo description in imperative form (REQUIRED). "+'Examples: "Run tests", "Fix bug in login", "Update documentation"'},status:{type:"string",description:'Task status (REQUIRED). Must be one of: "pending" (not started), '+'"in_progress" (currently working), "completed" (finished). '+'Only ONE task should be "in_progress" at a time.'},activeForm:{type:"string",description:"Present continuous form of the todo (REQUIRED). "+'Examples: "Running tests", "Fixing bug in login", "Updating documentation"'}},required:["content","status","activeForm"]}}},required:["todos"]});this.registerCustomSchema("Task",{type:"object",properties:{description:{type:"string",description:"Short (3-5 word) description of the task (REQUIRED). "+'Examples: "Analyze code quality", "Search for bugs", "Explore API endpoints", "Review security". '+"Keep it brief and descriptive."},prompt:{type:"string",description:"Detailed task prompt for the agent to perform (REQUIRED). "+"Be specific about what the agent should do and what it should return. "+"Examples:\n"+'• "Locate all files using authentication and analyze for security vulnerabilities. Return a detailed security report."\n'+'• "Search the codebase for all API endpoints and document them with their methods, paths, and descriptions."\n'+'• "Find all TODO comments in the code and create a prioritized list of tasks."\n'+"Since the agent is stateless, include ALL context and instructions in this prompt."},subagent_type:{type:"string",description:"Type of specialized agent to use (REQUIRED). Options:\n"+'• "General": Full-featured agent with all tools (search, code, execute)\n'+'• "Explore": Fast codebase exploration (Glob, Grep, Read, Bash)\n'+'• "Plan": Planning and analysis specialist (Glob, Grep, Read, Bash)\n'+'Example: Use "Explore" for finding files or searching code patterns.'},model:{type:"string",description:"Optional model selection. Options:\n"+'• "fast": Use FAST_MODEL from config (optimized for speed and cost)\n'+'• "powerful": Use POWERFUL_MODEL from config (optimized for quality)\n'+'• "default": Use provider\'s default model\n'+'If not specified, inherits from parent. Prefer "fast" for quick, straightforward tasks to minimize cost and latency. '+'Example: "fast" for simple file searches, "powerful" for complex analysis.'},resume:{type:"string",description:"Optional agent ID to resume from. Use when you want to continue a previous agent execution. "+"The agent will pick up where it left off using the previous transcript. "+'Example: "agent_abc123" to resume that specific agent.'}},required:["description","prompt","subagent_type"]})}customizeTool(e){if(this.customSchemas.has(e.name)){e.schema=this.customSchemas.get(e.name)}e.vendor="gemini";return e}getToolsForRequest(e={}){let t=super.getToolsForRequest(e);if(t.length>this.maxToolsPerRequest){console.warn(`Gemini: Limiting tools from ${t.length} to ${this.maxToolsPerRequest}`);t=t.slice(0,this.maxToolsPerRequest)}return t}}e.exports=GeminiTools},443:(module,__unused_webpack_exports,__nccwpck_require__)=>{module=__nccwpck_require__.nmd(module);const readline=__nccwpck_require__(3785);const System=__nccwpck_require__(9201);const{Message:Message}=__nccwpck_require__(9409);const EventBus=__nccwpck_require__(7258);const Task=__nccwpck_require__(745);const Model=__nccwpck_require__(931);const AnthropicProvider=__nccwpck_require__(3140);const GeminiProvider=__nccwpck_require__(3615);const toolRegistry=__nccwpck_require__(1287);const agent=__nccwpck_require__(9587);const UIManager=__nccwpck_require__(2746);const config=__nccwpck_require__(5192);class MiniCodeApp{constructor(){this.provider=null;this.ui=null;this.taskClassifier=null;this.modelScheduler=null;this.conversationHistory=[];this.systemPrompt=null;this.tools=[]}async initialize(){try{this.ui=new UIManager({showThinking:config.INCLUDE_THOUGHTS!==false,showToolExecution:true,showTokens:true,showStreaming:true,verbose:config.VERBOSE||false});this.ui.showWelcome();toolRegistry.initialize();await this.initializeProvider();agent.initialize(this.provider,toolRegistry);this.ui.showSystemMessage("Agent initialized","info");this.tools=this.provider.getTools();this.ui.showSystemMessage(`Loaded ${this.tools.length} tools`,"info");if(config.ENABLE_MODEL_SCHEDULING!==false){this.taskClassifier=new Task;this.modelScheduler=new Model(config);const e=this.modelScheduler.validateConfig();if(!e.valid){this.ui.showSystemMessage("Model scheduling disabled: "+e.errors.join(", "),"warn");this.modelScheduler=null}else{this.ui.showSystemMessage("Model scheduling enabled","success")}}this.systemPrompt=this.provider.getSystemPrompt("GENERAL");if(config.ENABLE_WARMUP!==false){await this.warmupProvider()}this.ui.showSystemMessage("Ready!","success");return true}catch(e){console.error("Initialization failed:",e.message);if(config.VERBOSE){console.error(e.stack)}return false}}async initializeProvider(){const e=config.PROVIDER||"anthropic";this.ui.showSystemMessage(`Initializing ${e} provider...`,"info");if(e==="anthropic"){this.provider=new AnthropicProvider(config)}else if(e==="gemini"){this.provider=new GeminiProvider(config)}else{throw new Error(`Unknown provider: ${e}`)}this.ui.showSystemMessage(`Provider: ${this.provider.name()} (${this.provider.model})`,"success");const t=this.provider.getEnabledCapabilities();if(t.length>0){const e=t.map((e=>e.name())).join(", ");this.ui.showSystemMessage(`Capabilities: ${e}`,"info")}}async warmupProvider(){try{const e=await this.provider.warmup(this.systemPrompt);if(e){this.ui.showSystemMessage("Provider warmed up successfully","success")}}catch(e){this.ui.showSystemMessage("Warmup failed (continuing anyway)","warn")}}async handleUserInput(e){try{const t=Message.user(e);this.conversationHistory.push(t);let s=null;let i=this.tools;let n="GENERAL";if(this.modelScheduler){const t=this.taskClassifier.classify(e);n=t.type;EventBus.taskClassified(t);const r=this.modelScheduler.analyze(t,{conversationLength:this.conversationHistory.length});EventBus.scheduleDecision(r);s={model:r.model};if(r.tools){i=this.tools.filter((e=>r.tools.includes(e.name)))}}const r=this.provider.getSystemPrompt(n,{conversationHistory:this.conversationHistory});const o=await this.provider.generateWithTools(this.conversationHistory,r,i,toolRegistry,{stream:config.ENABLE_STREAMING!==false,maxConsecutiveSameTool:5,maxIterations:100,...s});for(const e of o.newMessages){this.conversationHistory.push(e)}}catch(e){this.ui.showError(e)}}async start(){const e=await this.initialize();if(!e){process.exit(1)}const t=readline.createInterface({input:process.stdin,output:process.stdout,prompt:"\n> "});this.ui.setReadlineInterface(t);t.prompt();t.on("line",(async e=>{const s=e.trim();if(!s){t.prompt();return}if(s==="/exit"||s==="/quit"){this.exit(t);return}if(s==="/clear"){this.ui.clear();t.prompt();return}if(s==="/help"){this.ui.showHelp();t.prompt();return}if(s==="/stats"){this.showStats();t.prompt();return}await this.handleUserInput(s);t.prompt()}));t.on("close",(()=>{this.exit(t)}))}showStats(){console.log("\n📊 Statistics:");const e=this.provider.stats();console.log(`  Provider: ${e.provider}`);console.log(`  Model: ${e.model}`);console.log(`  Enabled Capabilities: ${e.enabled_capabilities.join(", ")}`);const t=toolRegistry.getStats();console.log(`\n  Tools:`);console.log(`    Total: ${t.total}`);console.log(`    Executions: ${t.total}`);console.log(`    Success Rate: ${t.successRate}`);console.log(`\n  Conversation:`);console.log(`    Messages: ${this.conversationHistory.length}`)}exit(e){console.log(chalk.dim("\n\n👋 Goodbye!\n"));if(this.ui){this.ui.unsubscribe()}if(e){e.close()}process.exit(0)}}const chalk=__nccwpck_require__(465);const isMainModule=require.main===require.cache[eval("__filename")]||!module.parent;if(isMainModule){const e=new MiniCodeApp;e.start().catch((e=>{console.error(chalk.red("Fatal error:"),e.message);process.exit(1)}))}module.exports=MiniCodeApp},1826:(e,t,s)=>{const i=s(1121);const{Message:n,Role:r}=s(9409);const{Block:o,BlockType:a}=s(7271);const l=s(9201);class AnthropicAdapter extends i{messages(e){if(!Array.isArray(e)){throw new Error("messages must be an array")}return e.filter((e=>!e.isSystem())).map((e=>{this._validateMessage(e);return{role:e.role,content:this._transformContent(e.content)}}))}system(e){this._validateSystem(e);if(!e.isCacheable()){return[{type:"text",text:"You are Claude Code, Anthropic's official CLI for Claude."},{type:"text",text:e.content}]}return[{type:"text",text:"You are Claude Code, Anthropic's official CLI for Claude.",cache_control:{type:"ephemeral"}},{type:"text",text:e.content,cache_control:{type:"ephemeral"}}]}tools(e){if(!Array.isArray(e)){throw new Error("tools must be an array")}if(e.length===0){return undefined}return e.map((e=>{const t={name:e.name,description:e.description,input_schema:e.schema};if(e.cacheable){t.cache_control={type:"ephemeral"}}return t}))}parse(e){if(!e||!e.content){throw new Error("Invalid Anthropic response")}const t=e.content.map((e=>{if(e.type==="text"){return o.text(e.text)}if(e.type==="thinking"){return o.thinking(e.thinking,e.signature)}if(e.type==="tool_use"){return o.toolUse(e.id,e.name,e.input)}return o.text(JSON.stringify(e))}));const s=n.assistant(t);if(e.id){s.setMeta("id",e.id)}if(e.model){s.setMeta("model",e.model)}if(e.stop_reason){s.setMeta("stop_reason",e.stop_reason)}return s}parseTools(e){if(!e||!e.content){return[]}return e.content.filter((e=>e.type==="tool_use")).map((e=>o.toolUse(e.id,e.name,e.input)))}parseTokens(e){if(!e||!e.usage){return{input_tokens:0,output_tokens:0}}return{input_tokens:e.usage.input_tokens||0,output_tokens:e.usage.output_tokens||0,cache_creation_input_tokens:e.usage.cache_creation_input_tokens||0,cache_read_input_tokens:e.usage.cache_read_input_tokens||0}}_transformContent(e){if(!Array.isArray(e)){throw new Error("content must be an array of Blocks")}if(e.every((e=>e.isText()))){return e.map((e=>e.data.text)).join("")}return e.map((e=>{if(e.isText()){return{type:"text",text:e.data.text}}if(e.isToolUse()){return{type:"tool_use",id:e.data.id,name:e.data.name,input:e.data.input}}if(e.isToolResult()){return{type:"tool_result",tool_use_id:e.data.tool_use_id,content:e.data.content,is_error:e.data.is_error||false}}if(e.isThinking()){const t={type:"thinking",thinking:e.data.thinking};if(e.data.signature){t.signature=e.data.signature}return t}if(e.isImage()){return{type:"image",source:{type:e.data.type,media_type:e.data.media_type,data:e.data.source}}}throw new Error(`Unknown block type: ${e.type}`)}))}}e.exports=AnthropicAdapter},8002:(e,t,s)=>{const i=s(5692);const n=s(1135);class AnthropicClient extends n{constructor(e){super(e);this.apiVersion=e.apiVersion||"2023-06-01";this.betaFeatures=["claude-code-20250219","interleaved-thinking-2025-05-14","fine-grained-tool-streaming-2025-05-14"];this.metadata={arch:process.arch,lang:"js",os:process.platform,packageVersion:"0.60.0",runtime:"node",runtimeVersion:process.version}}getDefaultBaseURL(){return"https://api.anthropic.com"}getProviderName(){return"Anthropic"}getHeaders(e=false){const t={"anthropic-beta":this.betaFeatures.join(","),"anthropic-version":this.apiVersion,"content-type":"application/json",authorization:`Bearer ${this.apiKey}`,"x-stainless-arch":this.metadata.arch,"x-stainless-lang":this.metadata.lang,"x-stainless-os":this.metadata.os,"x-stainless-package-version":this.metadata.packageVersion,"x-stainless-runtime":this.metadata.runtime,"x-stainless-runtime-version":this.metadata.runtimeVersion,"user-agent":"minicode-cli/1.0.0 (external, cli)"};if(e){t["x-stainless-helper-method"]="stream"}return t}async createMessage(e){const t=new URL("/v1/messages",this.baseURL);const s={model:e.model,messages:e.messages,system:e.system,max_tokens:e.max_tokens||32e3,...e};if(e.thinking){s.thinking=e.thinking}if(e.tools&&e.tools.length>0){s.tools=e.tools}const i=this.getHeaders(false);const n={method:"POST",headers:i,body:JSON.stringify(s)};this.saveDebugLog("request",s,i);try{const e=await fetch(t.toString(),n);if(!e.ok){const t=await e.text();throw new Error(`API Error ${e.status}: ${t}`)}const s=await e.json();this.saveDebugLog("response",s);return s}catch(e){throw this.handleError(e,"createMessage")}}async createMessageStream(e){const t=new URL("/v1/messages",this.baseURL);const s={model:e.model,messages:e.messages,system:e.system,max_tokens:e.max_tokens||32e3,stream:true,...e};if(e.thinking){s.thinking=e.thinking}if(e.tools&&e.tools.length>0){s.tools=e.tools}const i=this.getHeaders(true);const n={method:"POST",headers:i,body:JSON.stringify(s)};this.saveDebugLog("stream-request",s,i);try{const e=await fetch(t.toString(),n);if(!e.ok){const t=await e.text();throw new Error(`API Error ${e.status}: ${t}`)}return e.body}catch(e){throw this.handleError(e,"createMessageStream")}}}e.exports=AnthropicClient},3140:(e,t,s)=>{const i=s(8002);const n=s(4710);const r=s(4135);const o=s(8063);const a=s(7527);const l=s(1833);const c=s(7928);const h=s(1826);const u=s(7041);class AnthropicProvider extends u{constructor(e,t=null){if(!t){t=new i({apiKey:e.API_KEY||process.env.ANTHROPIC_API_KEY,baseURL:e.BASE_URL||process.env.ANTHROPIC_BASE_URL,debug:e.DEBUG,debugPath:e.LOG_DIR})}const s=new h(e);super(e,t,s);this.promptManager=new l(e);this.toolsManager=new c(e)}name(){return"Anthropic"}getDefaultModel(){return this.config.POWERFUL_MODEL||"claude-sonnet-4-5-20250929"}resolveModel(e){if(!e||typeof e!=="string"){return this.model}const t={fast:this.config.FAST_MODEL||"claude-3-5-haiku-20241022",powerful:this.config.POWERFUL_MODEL||this.model,default:this.model};const s=e.toLowerCase();if(t[s]){return t[s]}if(e.includes("-")||e.startsWith("claude")){return e}return this.model}getSystemPrompt(e="GENERAL",t={}){return this.promptManager.getPrompt(e,t)}initializeCapabilities(){const e=new n(this,this.config);this.registerCapability(e);const t=new r(this,this.client,this.adapter,this.config);this.registerCapability(t);const s=new o(this,this.config);this.registerCapability(s);const i=new a(this,this.client,this.adapter,this.config);this.registerCapability(i)}async generateNonStreaming(e){const{stream:t,...s}=e;const i=await this.client.createMessage(s);return i}async generateStreaming(e){const t=this.getCapability("Streaming");if(!t||!t.enabled()){return await this.generateNonStreaming(e)}e.stream=true;const s=await this.client.createMessageStream(e);const i=await t.handle(s);return i}applySystemCaching(e){const t=this.getCapability("Caching");if(t&&t.enabled()){return t.applySystem(e)}return this.adapter.system(e)}extractThinking(e){const t=this.getCapability("Thinking");if(!t||!t.enabled()){return[]}const s={content:e.content.map((e=>{if(e.isThinking&&e.isThinking()){return{type:"thinking",thinking:e.data.thinking}}return null})).filter(Boolean)};return t.extract(s)}}e.exports=AnthropicProvider},7041:(e,t,s)=>{const i=s(7258);const{Message:n}=s(9409);const{Block:r}=s(7271);const o=s(9201);const a=s(5249);class BaseProvider{constructor(e,t,s){this.config=e;this.client=t;this.adapter=s;this.model=e.MODEL||this.getDefaultModel();this.capabilities=new Map;this.initializeCapabilities()}name(){throw new Error("Provider must implement name() method")}getDefaultModel(){throw new Error("Provider must implement getDefaultModel() method")}resolveModel(e){if(!e||typeof e!=="string"){return this.model}if(e.includes("-")||e.includes("@")||e.includes("/")){return e}return this.model}getSystemPrompt(e="GENERAL",t={}){return o.cacheable("You are a helpful AI assistant.")}getTools(e={}){if(this.toolsManager){return this.toolsManager.getToolsForRequest(e)}const t=new a;return t.getToolsForRequest(e)}initializeCapabilities(){}registerCapability(e){this.capabilities.set(e.name(),e)}getCapability(e){return this.capabilities.get(e)||null}getEnabledCapabilities(){return Array.from(this.capabilities.values()).filter((e=>e.enabled()))}async _retryWithBackoff(e,t={}){const s=t.maxRetries||5;const n=t.baseDelay||1e3;const r=t.maxDelay||32e3;let o=null;for(let t=0;t<=s;t++){try{return await e()}catch(e){o=e;const a=this._isRetryableError(e);const l=t===s;if(!a||l){throw e}const c=Math.min(n*Math.pow(2,t),r);const h=Math.random()*.3*c;const u=Math.floor(c+h);i.warning(`API error ${this._getErrorCode(e)}, retrying (${t+1}/${s}) after ${u}ms...`);await this._sleep(u)}}throw o}_isRetryableError(e){const t=e.status||e.statusCode||e.code;if([429,500,502,503,504].includes(t)){return true}const s=(e.message||"").toLowerCase();const i=["rate limit","too many requests","service unavailable","temporarily unavailable","timeout","timed out","connection reset","econnreset","econnrefused","etimedout"];return i.some((e=>s.includes(e)))}_getErrorCode(e){const t=e.status||e.statusCode||e.code;if(t){return`${t}`}const s=(e.message||"").toLowerCase();if(s.includes("rate limit")||s.includes("429")){return"429 (Rate Limit)"}if(s.includes("service unavailable")||s.includes("503")){return"503 (Service Unavailable)"}return"Network Error"}_sleep(e){return new Promise((t=>setTimeout(t,e)))}async generate(e,t=null,s=[],n={}){try{const r=await this.buildRequestParams(e,t,s,n);i.generateStart(this.name(),r.model);const o=this.getCapability("Streaming");const a=o&&o.enabled()&&n.stream!==false;const l=await this._retryWithBackoff((async()=>{if(a){return await this.generateStreaming(r)}else{return await this.generateNonStreaming(r)}}),{maxRetries:n.maxRetries||this.config.MAX_RETRIES||5,baseDelay:n.retryBaseDelay||this.config.RETRY_BASE_DELAY||1e3,maxDelay:n.retryMaxDelay||this.config.RETRY_MAX_DELAY||32e3});const c=this.adapter.parse(l);const h=this.adapter.parseTokens(l);i.generateComplete(this.name(),c,h);return c}catch(e){i.generateError(this.name(),e);throw e}}buildRequestParams(e,t,s,i){const n=this.resolveModel(i.model||this.model);let r={model:n,max_tokens:i.max_tokens||this.config.MAX_TOKENS||4096};r.messages=this.adapter.messages(e);if(t){const e=this.getCapability("Caching");if(e&&e.enabled()){r.system=e.applySystem?e.applySystem(t):this.adapter.system(t)}else{r.system=this.adapter.system(t)}}if(s&&s.length>0){r.tools=this.adapter.tools(s)}for(const e of this.getEnabledCapabilities()){if(e.configure){r=e.configure(r)}}return r}async generateNonStreaming(e){throw new Error("Provider must implement generateNonStreaming() method")}async generateStreaming(e){throw new Error("Provider must implement generateStreaming() method")}async executeTool(e,t,s){if(!s){throw new Error("ToolRegistry is required for tool execution")}return await s.execute(e,t)}async generateWithTools(e,t,s,i,o={}){const a=o.maxConsecutiveSameTool||3;const l=o.maxIterations||100;let c=[...e];const h=[];let u=null;let d=0;for(let e=0;e<l;e++){const e=await this.generate(c,t,s,o);const l=e.getToolUses();if(l.length===0){h.push(e);return{finalResponse:e,newMessages:h}}const p=this._getToolSignature(l);if(p===u){d++;if(d>=a){const e=l.map((e=>e.data.name)).join(", ");throw new Error(`Infinite loop detected: Tool(s) [${e}] called ${d+1} times consecutively. `+`This usually means the AI is stuck in a loop. Consider refining your request or breaking it into smaller tasks.`)}}else{d=1;u=p}c.push(e);h.push(e);const f=[];for(const e of l){const t=await this.executeTool(e.data.name,e.data.input,i);if(e.data.name==="TodoWrite"&&t.metadata&&t.metadata.completed==="ended"){continue}f.push(r.toolResult(e.data.id,t.toString(),!t.isSuccess(),e.data.name))}if(f.length===0){return{finalResponse:e,newMessages:h}}const g=n.user(f);c.push(g);h.push(g)}throw new Error(`Maximum tool iterations (${l}) reached. `+`This is a safety limit to prevent infinite loops and excessive costs. `+`Your task may be too complex - consider breaking it into smaller parts.`)}_getToolSignature(e){return e.map((e=>{const t=e.data.name;const s=JSON.stringify(e.data.input);return`${t}(${s})`})).join("|")}async warmup(e,t={}){const s=this.getCapability("Warmup");if(!s||!s.enabled()){return false}return await s.warmup(this.model,e,t)}stats(){const e={};for(const[t,s]of this.capabilities){if(s.stats){e[t]=s.stats()}}return{provider:this.name(),model:this.model,capabilities:e,enabled_capabilities:this.getEnabledCapabilities().map((e=>e.name()))}}}e.exports=BaseProvider},103:(e,t,s)=>{const i=s(1121);const{Message:n,Role:r}=s(9409);const{Block:o,BlockType:a}=s(7271);const l=s(9201);class GeminiAdapter extends i{messages(e){if(!Array.isArray(e)){throw new Error("messages must be an array")}return e.filter((e=>!e.isSystem())).map((e=>{this._validateMessage(e);const t=this._transformContent(e.content);if(e.role==="assistant"&&e.meta("thought_signature")){const s=e.meta("thought_signature");const i=t.find((e=>e.text!==undefined||e.functionCall!==undefined));if(i){i.thoughtSignature=s}}return{role:e.role==="assistant"?"model":"user",parts:t}}))}system(e){this._validateSystem(e);return{parts:[{text:e.content}]}}tools(e){if(!Array.isArray(e)){throw new Error("tools must be an array")}if(e.length===0){return undefined}const t=e.map((e=>({name:e.name,description:e.description,parameters:e.schema})));return[{functionDeclarations:t}]}parse(e){if(!e||!e.parts){throw new Error("Invalid Gemini response")}let t=null;for(const s of e.parts){if(!s.thought&&s.thoughtSignature){t=s.thoughtSignature;break}}const s=e.parts.map((e=>{if(e.thought===true&&e.text){return o.thinking(e.text)}if(e.text){return o.text(e.text)}if(e.functionCall){const t=this._generateId(e.functionCall.name);return o.toolUse(t,e.functionCall.name,e.functionCall.args)}return o.text(JSON.stringify(e))}));const i=this._mergeTextBlocks(s);const r=n.assistant(i);if(e.model){r.setMeta("model",e.model)}if(e.finishReason){r.setMeta("finish_reason",e.finishReason)}if(t){r.setMeta("thought_signature",t)}if(e.usageMetadata&&e.usageMetadata.thoughtsTokenCount){r.setMeta("thinking_tokens",e.usageMetadata.thoughtsTokenCount)}return r}_mergeTextBlocks(e){const t=[];let s=null;let i=null;for(const n of e){const e=n.type;if(e==="text"||e==="thinking"){const r=e==="text"?n.data.text:n.data.thinking;if(s!==null&&i===e){s+=r}else{if(s!==null){const e=i==="text"?o.text(s):o.thinking(s);t.push(e)}s=r;i=e}}else{if(s!==null){const e=i==="text"?o.text(s):o.thinking(s);t.push(e);s=null;i=null}t.push(n)}}if(s!==null){const e=i==="text"?o.text(s):o.thinking(s);t.push(e)}return t}parseTools(e){if(!e||!e.parts){return[]}return e.parts.filter((e=>e.functionCall)).map((e=>{const t=this._generateId(e.functionCall.name);return o.toolUse(t,e.functionCall.name,e.functionCall.args)}))}parseTokens(e){if(!e||!e.usage){return{input_tokens:0,output_tokens:0}}return{input_tokens:e.usage.promptTokenCount||0,output_tokens:e.usage.candidatesTokenCount||0,total_tokens:e.usage.totalTokenCount||0}}_transformContent(e){if(!Array.isArray(e)){throw new Error("content must be an array of Blocks")}return e.map((e=>{if(e.isText()){return{text:e.data.text}}if(e.isToolUse()){return{functionCall:{name:e.data.name,args:e.data.input}}}if(e.isToolResult()){return{functionResponse:{name:e.data.name||e.data.tool_use_id,response:{result:e.data.content,tool_use_id:e.data.tool_use_id}}}}if(e.type==="thinking"){return null}return{text:JSON.stringify(e.data)}})).filter((e=>e!==null))}_generateId(e){const t=Date.now();const s=Math.random().toString(36).substring(2,9);return`toolu_${e}_${t}_${s}`}}e.exports=GeminiAdapter},677:(e,t,s)=>{const i=s(5692);const n=s(8611);const r=s(1135);class GeminiClient extends r{constructor(e={}){super(e);const t=new URL(this.baseURL);this.protocol=t.protocol==="https:"?i:n;this.hostname=t.hostname;this.port=t.port||(t.protocol==="https:"?443:80);this.basePath=t.pathname==="/"?"":t.pathname}getDefaultBaseURL(){return"https://generativelanguage.googleapis.com"}getProviderName(){return"Gemini"}_request(e,t,s){return new Promise(((i,n)=>{const r=s?JSON.stringify(s):null;const o={hostname:this.hostname,port:this.port,path:this.basePath+e,method:t,headers:{"Content-Type":"application/json","x-goog-api-key":this.apiKey}};if(r){o.headers["Content-Length"]=Buffer.byteLength(r)}this.saveDebugLog("request",s,o.headers,e);const a=this.protocol.request(o,(t=>{let s="";t.on("data",(e=>{s+=e}));t.on("end",(()=>{try{const r=JSON.parse(s);this.saveDebugLog("response",r,t.headers,e);if(t.statusCode>=200&&t.statusCode<300){i(r)}else{const e=new Error(r.error?.message||`HTTP ${t.statusCode}`);e.status=t.statusCode;e.response=r;n(e)}}catch(i){this.saveDebugLog("response",{error:"Invalid JSON response",statusCode:t.statusCode,rawResponse:s.substring(0,1e3)},t.headers,e);const r=new Error(`Failed to parse response: ${i.message}. `+`Status: ${t.statusCode}. `+`Response: ${s.substring(0,200)}`);r.status=t.statusCode;r.rawResponse=s;n(r)}}))}));a.on("error",(e=>{n(this.handleError(e,"_request"))}));if(r){a.write(r)}a.end()}))}async generateContent(e){if(!e.model){throw new Error("model is required")}if(!e.contents||!Array.isArray(e.contents)){throw new Error("contents must be an array")}const{model:t,...s}=e;const i=`/v1beta/models/${t}:generateContent`;return this._request(i,"POST",s)}async createCachedContent(e){if(!e.model){throw new Error("model is required")}const t={model:`models/${e.model}`};if(e.systemInstruction){t.systemInstruction=e.systemInstruction}if(e.contents){t.contents=e.contents}t.ttl=e.ttl||"3600s";if(e.displayName){t.displayName=e.displayName}const s="/v1beta/cachedContents";return this._request(s,"POST",t)}async deleteCachedContent(e){if(!e){throw new Error("cacheName is required")}const t=`/v1beta/${e}`;return this._request(t,"DELETE",null)}async getCachedContent(e){if(!e){throw new Error("cacheName is required")}const t=`/v1beta/${e}`;return this._request(t,"GET",null)}async streamGenerateContent(e){if(!e.model){throw new Error("model is required")}if(!e.contents||!Array.isArray(e.contents)){throw new Error("contents must be an array")}const{model:t,...s}=e;const i=`/v1beta/models/${t}:streamGenerateContent`;return this._streamRequest(i,"POST",s)}async _streamRequest(e,t,s){const i=new URL(this.baseURL);i.pathname=this.basePath+e;const n=s?JSON.stringify(s):null;const r={"Content-Type":"application/json","x-goog-api-key":this.apiKey};this.saveDebugLog("stream-request",s,r,e);try{const e=await fetch(i.toString(),{method:t,headers:r,body:n});if(!e.ok){const t=await e.text();this.saveDebugLog("stream-response",{error:t});throw new Error(`HTTP ${e.status}: ${t}`)}return e.body}catch(e){console.error("[GeminiClient] Stream request failed:",e.message);throw this.handleError(e,"_streamRequest")}}}e.exports=GeminiClient},3615:(e,t,s)=>{const i=s(677);const n=s(2227);const r=s(5796);const o=s(4034);const a=s(3326);const l=s(65);const c=s(103);const h=s(7041);class GeminiProvider extends h{constructor(e,t=null){if(!t){t=new i({apiKey:e.API_KEY||process.env.GEMINI_API_KEY,baseURL:e.BASE_URL||process.env.GEMINI_API_BASE_URL,debug:e.DEBUG,debugPath:e.LOG_DIR})}const s=new c(e);super(e,t,s);this.promptManager=new a(e);this.toolsManager=new l(e)}name(){return"Gemini"}getDefaultModel(){return this.config.POWERFUL_MODEL||"gemini-2.5-pro"}resolveModel(e){if(!e||typeof e!=="string"){return this.model}const t={fast:this.config.FAST_MODEL||"gemini-2.5-flash",powerful:this.config.POWERFUL_MODEL||this.model,default:this.model};const s=e.toLowerCase();if(t[s]){return t[s]}if(e.includes("-")||e.startsWith("gemini")||e.includes("/")){return e}return this.model}getSystemPrompt(e="GENERAL",t={}){return this.promptManager.getPrompt(e,t)}initializeCapabilities(){const e=new n(this,this.client,this.config);this.registerCapability(e);const t=new r(this,this.config);this.registerCapability(t);const s=new o(this,this.client,this.adapter,this.config);this.registerCapability(s)}async buildRequestParams(e,t,s,i){let n={model:i.model||this.model};n.contents=this.adapter.messages(e);if(t){n.systemInstruction=this.adapter.system(t)}if(s&&s.length>0){n.tools=this.adapter.tools(s)}n.generationConfig={maxOutputTokens:i.max_tokens||this.config.MAX_TOKENS||4096};const r=this.getCapability("Caching");if(r&&r.enabled()){n=await r.applyToRequest(n)}for(const e of this.getEnabledCapabilities()){if(e.name()!=="Caching"&&e.configure){n=e.configure(n)}}return n}async generateNonStreaming(e){const t=await this.client.generateContent(e);if(t.error){throw new Error(`Gemini API Error: ${t.error.message||JSON.stringify(t.error)}`)}if(!t.candidates||t.candidates.length===0){const e=t.promptFeedback?.blockReason?`Blocked: ${t.promptFeedback.blockReason}`:"No candidates in response";throw new Error(`Gemini API: ${e}. Response: ${JSON.stringify(t).substring(0,500)}`)}const s=t.candidates[0];const i=s.content?.parts||[];const n=s.finishReason||null;const r=t.usageMetadata||null;return{parts:i,finishReason:n,usage:r}}async generateStreaming(e){const t=this.getCapability("Streaming");if(!t||!t.enabled()){return await this.generateNonStreaming(e)}const s=await this.client.streamGenerateContent(e);const i=await t.handle(s);return i}extractThinking(e){const t=this.getCapability("Thinking");if(!t||!t.enabled()){return[]}const s={parts:e.content.map((e=>{if(e.isText&&e.isText()){return{text:e.data.text,thought:false}}return null})).filter(Boolean)};return t.extract(s)}}e.exports=GeminiProvider},4860:(e,t,s)=>{const{exec:i}=s(5317);const{promisify:n}=s(9023);const r=s(3172);const o=s(7617);const a=n(i);class Bash extends r{get name(){return"Bash"}get description(){return`Executes a bash command in a shell session with timeout and encoding handling.\n\nIMPORTANT: This tool is for terminal operations like git, npm, docker, etc. DO NOT use it for file operations (reading, writing, editing, searching, finding files) - use the specialized tools for this instead.\n\n## Usage Guidelines\n\n**Proper Use Cases:**\n- Running system commands (git, npm, docker, etc.)\n- Executing tests and builds\n- Directory operations (cd, mkdir, ls for verification)\n- Package management operations\n\n**DO NOT Use Bash For:**\n- File search: Use Glob (NOT find or ls)\n- Content search: Use Grep (NOT grep or rg)\n- Read files: Use Read (NOT cat/head/tail)\n- Edit files: Use Edit (NOT sed/awk)\n- Write files: Use Write (NOT echo >/cat <<EOF)\n\n## Command Execution\n\n**Path Quoting:**\n- Always quote file paths that contain spaces with double quotes\n- Example: cd "/Users/name/My Documents" (correct)\n- Example: cd /Users/name/My Documents (incorrect - will fail)\n\n**Multiple Commands:**\n- Independent commands: Make multiple Bash tool calls in parallel\n- Dependent commands: Use '&&' to chain (e.g., \`mkdir foo && cd foo\`)\n- Use ';' only when you don't care if earlier commands fail\n- DO NOT use newlines to separate commands\n\n**Working Directory:**\n- Try to maintain your current working directory by using absolute paths\n- Prefer: pytest /foo/bar/tests\n- Avoid: cd /foo/bar && pytest tests\n\n## Parameters\n\n- command: The bash command to execute (required)\n- timeout: Optional timeout in milliseconds (default 120000ms, max 600000ms)\n- description: Clear, concise description of what this command does (5-10 words)\n\n## Important Notes\n\n- Output exceeding 30000 characters will be truncated\n- Commands timeout after 2 minutes by default (configurable)\n- Dangerous commands (rm -rf /, disk operations) are blocked\n- Windows encoding is automatically handled (UTF-8)`}get schema(){return{type:"object",properties:{command:{type:"string"},timeout:{type:"number",default:12e4},description:{type:"string"}},required:["command"]}}get category(){return"bash"}_validateCommand(e){const t=[/rm\s+-rf\s+\/\s*$/,/>\s*\/dev\/sda/,/mkfs\./,/dd\s+if=/];for(const s of t){if(s.test(e)){throw new Error(`Dangerous command blocked: ${e}`)}}return true}async execute(e){try{this.validate(e);const{command:t,timeout:s=12e4,description:i=""}=e;const n=6e5;const r=Math.min(s,n);try{this._validateCommand(t)}catch(e){return o.fail(e)}let l=t;if(process.platform==="win32"){l=`chcp 65001 >nul && ${t}`}const c=Date.now();let h,u,d;try{const e=await a(l,{timeout:r,maxBuffer:10*1024*1024,cwd:process.cwd(),encoding:"utf8",windowsHide:true});h=e.stdout||"";u=e.stderr||"";d=0}catch(e){h=e.stdout||"";u=e.stderr||e.message||"";d=e.code||1;if(e.killed&&e.signal==="SIGTERM"){u=`Command timed out after ${r}ms\n${u}`}}const p=Date.now()-c;const f={stdout:h,stderr:u,exitCode:d};return o.ok(f,{command:t,description:i,duration:p,timeout:r,platform:process.platform,cwd:process.cwd()})}catch(e){return o.fail(e)}}}e.exports=new Bash},9426:(e,t,s)=>{const i=s(9896).promises;const n=s(6928);const r=s(3172);const o=s(7617);class Edit extends r{get name(){return"Edit"}get description(){return`Performs exact string replacements in files.\n\n## Usage Requirements\n\n**IMPORTANT - Read First:**\n- You MUST use the Read tool at least once before editing a file\n- This ensures you see the current file content and can match strings exactly\n\n**String Matching:**\n- When editing text from Read tool output, preserve exact indentation (tabs/spaces)\n- The Read output format is: spaces + line number + tab + actual content\n- Never include the line number prefix in old_string or new_string\n- Match only the actual file content after the tab character\n\n## Replacement Modes\n\n**Single Replacement (default):**\n- The edit will FAIL if old_string is not unique in the file\n- Solution: Provide a larger string with more surrounding context to make it unique\n- Or: Use replace_all parameter to change every instance\n\n**Replace All (replace_all=true):**\n- Replaces every occurrence of old_string in the file\n- Useful for renaming variables or updating repeated patterns\n- Use with caution - verify all matches are intended\n\n## Best Practices\n\n- ALWAYS prefer editing existing files in the codebase\n- NEVER write new files unless explicitly required\n- Only use emojis if the user explicitly requests it\n- Test your old_string match before executing (mentally verify it exists)\n- Consider whether replace_all is appropriate for your use case\n\n## Parameters\n\n- file_path: The absolute path to the file to modify (required)\n- old_string: The exact text to replace (required, must exist in file)\n- new_string: The replacement text (required, must differ from old_string)\n- replace_all: Replace all occurrences vs single match (optional, default false)`}get schema(){return{type:"object",properties:{file_path:{type:"string"},old_string:{type:"string"},new_string:{type:"string"},replace_all:{type:"boolean",default:false}},required:["file_path","old_string","new_string"]}}get category(){return"writeops"}async execute(e){try{this.validate(e);const{file_path:t,old_string:s,new_string:r,replace_all:a=false}=e;if(!s){return o.fail(new Error("old_string cannot be empty"))}if(s===r){return o.fail(new Error("old_string and new_string must be different"))}const l=n.isAbsolute(t)?t:n.resolve(process.cwd(),t);let c;try{c=await i.readFile(l,"utf-8")}catch(e){if(e.code==="ENOENT"){return o.fail(new Error(`File not found: ${t}`))}if(e.code==="EACCES"){return o.fail(new Error(`Permission denied: ${t}`))}return o.fail(e)}if(!c.includes(s)){return o.fail(new Error(`The old_string was not found in ${t}`))}if(!a){const e=c.split(s).length-1;if(e>1){return o.fail(new Error(`The old_string appears ${e} times in ${t}. `+`Use replace_all=true to replace all occurrences, or provide a more unique string.`))}}let h;let u;if(a){const e=c.split(s);u=e.length-1;h=e.join(r)}else{const e=c.indexOf(s);h=c.substring(0,e)+r+c.substring(e+s.length);u=1}try{await i.writeFile(l,h,"utf-8")}catch(e){if(e.code==="EACCES"){return o.fail(new Error(`Permission denied writing to: ${t}`))}if(e.code==="ENOSPC"){return o.fail(new Error(`No space left on device: ${t}`))}return o.fail(e)}let d;try{d=await i.stat(l)}catch(e){d=null}const p=`Successfully replaced ${u} occurrence(s) in ${l}`;return o.ok(p,{file_path:l,replacements:u,old_length:s.length,new_length:r.length,size_change:(r.length-s.length)*u,final_size:d?d.size:h.length,modified:d?d.mtime:new Date})}catch(e){return o.fail(e)}}}e.exports=new Edit},1312:(e,t,s)=>{const{glob:i}=s(1363);const n=s(9896).promises;const r=s(6928);const o=s(3172);const a=s(7617);class Glob extends o{get name(){return"Glob"}get description(){return`Fast file pattern matching tool that works with any codebase size.\n\n## Usage\n\n- Supports glob patterns like "**/*.js" or "src/**/*.ts"\n- Returns matching file paths sorted by modification time (most recent first)\n- Use this tool when you need to find files by name patterns\n\n## Common Patterns\n\n- \`**/*.js\` - All JavaScript files in any directory\n- \`src/**/*.ts\` - All TypeScript files under src/\n- \`*.json\` - All JSON files in current directory\n- \`**/*test*.js\` - All files containing "test" in name\n- \`{src,lib}/**/*.ts\` - TypeScript files in src/ or lib/\n\n## Parallel Searching\n\n- You can call multiple tools in a single response\n- It is always better to speculatively perform multiple searches in parallel if they are potentially useful\n- Example: Search for "*.ts" and "*.tsx" files simultaneously\n\n## Parameters\n\n- pattern: The glob pattern to match files against (required)\n- path: The directory to search in (optional, defaults to current working directory)\n\n## Excluded Directories\n\nThe following directories are automatically excluded:\n- node_modules, .git, dist, build, .next, coverage\n\n## Important\n\n- This tool only finds files by name/path patterns\n- For content search, use the Grep tool instead\n- Returns file paths, not file contents`}get schema(){return{type:"object",properties:{pattern:{type:"string"},path:{type:"string"}},required:["pattern"]}}get category(){return"readonly"}async execute(e){try{this.validate(e);const{pattern:t,path:s}=e;const r=s||process.cwd();try{const e=await n.stat(r);if(!e.isDirectory()){return a.fail(new Error(`Path is not a directory: ${r}`))}}catch(e){if(e.code==="ENOENT"){return a.fail(new Error(`Directory not found: ${r}`))}return a.fail(e)}const o=Date.now();let l;try{l=await i(t,{cwd:r,absolute:true,nodir:true,ignore:["**/node_modules/**","**/.git/**","**/dist/**","**/build/**","**/.next/**","**/coverage/**"]})}catch(e){return a.fail(new Error(`Glob pattern error: ${e.message}`))}const c=Date.now()-o;if(l.length===0){return a.ok(`No files found matching pattern: ${t}`,{pattern:t,cwd:r,count:0,duration:c})}const h=await Promise.all(l.map((async e=>{try{const t=await n.stat(e);return{file:e,mtime:t.mtime,size:t.size}}catch(t){return{file:e,mtime:new Date(0),size:0}}})));h.sort(((e,t)=>t.mtime-e.mtime));const u=h.map((e=>e.file));const d=h.reduce(((e,t)=>e+t.size),0);const p=u.join("\n");return a.ok(p,{pattern:t,cwd:r,count:u.length,total_size:d,duration:c,files:u})}catch(e){return a.fail(e)}}}e.exports=new Glob},4042:(e,t,s)=>{const{exec:i}=s(5317);const{promisify:n}=s(9023);const r=s(3172);const o=s(7617);const a=n(i);class Grep extends r{get name(){return"Grep"}get description(){return`A powerful search tool built on grep for finding text patterns in files.\n\n## Usage\n\nALWAYS use Grep for search tasks. NEVER invoke \`grep\` or \`rg\` as a Bash command. The Grep tool has been optimized for correct permissions and access.\n\n## Features\n\n- Supports full regex syntax (e.g., "log.*Error", "function\\s+\\w+")\n- Filter files with glob parameter (e.g., "*.js", "**/*.tsx") or type parameter (e.g., "js", "py", "rust")\n- Multiple output modes for different use cases\n\n## Output Modes\n\n- **content**: Shows matching lines (supports -A/-B/-C context, -n line numbers)\n- **files_with_matches**: Shows only file paths (default, faster for finding files)\n- **count**: Shows match counts per file\n\n## Common Options\n\n- \`-i\`: Case insensitive search\n- \`-n\`: Show line numbers in output (content mode only)\n- \`-A N\`: Show N lines after each match (content mode only)\n- \`-B N\`: Show N lines before each match (content mode only)\n- \`-C N\`: Show N lines before and after each match (content mode only)\n- \`head_limit\`: Limit output to first N lines/entries\n\n## Pattern Syntax\n\n- Uses grep regex (not ripgrep)\n- Literal braces: use \`\\{\` and \`\\}\` (e.g., \`interface\\{\\}\` to find \`interface{}\` in code)\n- For simple text search, just use the text directly\n\n## Parallel Searching\n\n- You can call multiple tools in a single response\n- Speculatively perform multiple searches in parallel if they are potentially useful\n- Example: Search for "TODO" and "FIXME" simultaneously\n\n## Parameters\n\n- pattern: The regular expression pattern to search for (required)\n- path: File or directory to search in (optional, defaults to current directory)\n- output_mode: "content", "files_with_matches", or "count" (optional, default "files_with_matches")\n- glob: Glob pattern to filter files (e.g., "*.js", "*.{ts,tsx}")\n- type: File type to search (e.g., "js", "py", "rust")\n\n## Excluded Directories\n\nThe following directories are automatically excluded:\n- node_modules, .git, dist, build, .next, coverage`}get schema(){return{type:"object",properties:{pattern:{type:"string"},path:{type:"string"},output_mode:{type:"string",enum:["content","files_with_matches","count"],default:"files_with_matches"},glob:{type:"string"},type:{type:"string"},"-i":{type:"boolean",default:false},"-n":{type:"boolean",default:false},"-A":{type:"number"},"-B":{type:"number"},"-C":{type:"number"},head_limit:{type:"number"}},required:["pattern"]}}get category(){return"readonly"}async execute(e){try{this.validate(e);const{pattern:t,path:s=".",output_mode:i="files_with_matches",glob:n,type:r,"-i":l=false,"-n":c=false,"-A":h,"-B":u,"-C":d,head_limit:p}=e;const f=["-r"];if(l)f.push("-i");if(c&&i==="content")f.push("-n");if(h&&i==="content")f.push(`-A ${h}`);if(u&&i==="content")f.push(`-B ${u}`);if(d&&i==="content")f.push(`-C ${d}`);if(i==="files_with_matches"){f.push("-l")}else if(i==="count"){f.push("-c")}let g=`grep ${f.join(" ")} "${t}" ${s}`;if(n){g+=` --include="${n}"`}if(r){const e={js:"*.js",ts:"*.ts",tsx:"*.tsx",jsx:"*.jsx",py:"*.py",java:"*.java",go:"*.go",rs:"*.rs",rust:"*.rs",c:"*.c",cpp:"*.cpp",h:"*.h",hpp:"*.hpp"};const t=e[r]||`*.${r}`;g+=` --include="${t}"`}const y=["node_modules",".git","dist","build",".next","coverage"];for(const e of y){g+=` --exclude-dir=${e}`}const w=Date.now();let b,E,S;try{const e=await a(g,{maxBuffer:10*1024*1024,cwd:process.cwd(),encoding:"utf8"});b=e.stdout;E=e.stderr;S=0}catch(e){b=e.stdout||"";E=e.stderr||"";S=e.code||1}const k=Date.now()-w;if(S===1&&!b){return o.ok(`No matches found for pattern: ${t}`,{pattern:t,path:s,count:0,duration:k})}if(S>1){return o.fail(new Error(`Grep error: ${E||"Unknown error"}`))}let T=b.trim();if(p&&T){const e=T.split("\n");T=e.slice(0,p).join("\n")}const x=T?T.split("\n").length:0;return o.ok(T||"No matches found",{pattern:t,path:s,output_mode:i,count:x,duration:k,case_insensitive:l})}catch(e){return o.fail(e)}}}e.exports=new Grep},774:(e,t,s)=>{const i=s(9896).promises;const n=s(6928);const r=s(3172);const o=s(7617);class Read extends r{get name(){return"Read"}get description(){return`Reads a file from the local filesystem. You can access any file directly by using this tool.\n\n## File Access\n\n- Assume this tool is able to read all files on the machine\n- If the user provides a path to a file, assume that path is valid\n- It is okay to read a file that does not exist; an error will be returned\n\n## Usage\n\n**File Path:**\n- The file_path parameter must be an absolute path, not a relative path\n- By default, reads up to 2000 lines starting from the beginning\n- You can optionally specify a line offset and limit for long files\n\n**Output Format:**\n- Results are returned using cat -n format, with line numbers starting at 1\n- Format: spaces + line number + tab + actual file content\n- Lines longer than 2000 characters will be truncated\n\n**Parallel Reading:**\n- You can call multiple tools in a single response\n- It is always better to speculatively read multiple potentially useful files in parallel\n- Example: Read package.json, tsconfig.json, and README.md simultaneously\n\n## Special File Support\n\nThis tool supports reading various file types beyond plain text:\n- **Images**: PNG, JPG, etc. (contents presented visually)\n- **PDFs**: Processed page by page with text and visual content\n- **Jupyter Notebooks**: Returns all cells with outputs, code, text, and visualizations\n- **Directories**: Cannot read directories; use ls command via Bash tool instead\n\n## Parameters\n\n- file_path: The absolute path to the file to read (required)\n- offset: The line number to start reading from (optional, for large files)\n- limit: The number of lines to read (optional, for large files)\n\n## Important Notes\n\n- If you read a file that exists but has empty contents, you will receive a system reminder warning\n- Recommended to read the whole file by not providing offset/limit parameters\n- For screenshots, ALWAYS use this tool to view the file at the path`}get schema(){return{type:"object",properties:{file_path:{type:"string"},offset:{type:"number"},limit:{type:"number"}},required:["file_path"]}}get category(){return"readonly"}async execute(e){try{this.validate(e);const{file_path:t,offset:s=0,limit:r}=e;const a=n.isAbsolute(t)?t:n.resolve(process.cwd(),t);let l;try{l=await i.readFile(a,"utf-8")}catch(e){if(e.code==="ENOENT"){return o.fail(new Error(`File not found: ${t}`))}if(e.code==="EACCES"){return o.fail(new Error(`Permission denied: ${t}`))}if(e.code==="EISDIR"){return o.fail(new Error(`Path is a directory: ${t}`))}return o.fail(e)}const c=l.split("\n");const h=Math.max(0,s);const u=r?Math.min(h+r,c.length):c.length;const d=c.slice(h,u);const p=d.map(((e,t)=>{const s=h+t+1;return`${s.toString().padStart(6," ")}→${e}`})).join("\n");return o.ok(p,{file_path:a,total_lines:c.length,lines_read:d.length,offset:h,size:l.length})}catch(e){return o.fail(e)}}}e.exports=new Read},5531:(e,t,s)=>{const i=s(3172);const n=s(7617);const r=s(9587);class Task extends i{get name(){return"Task"}get description(){return`Launch a new agent to handle complex, multi-step tasks autonomously.\n\n## When to Use Task Tool\nUse this tool to delegate complex, multi-step tasks to specialized sub-agents:\n- Exploring codebases for patterns, files, or code structures\n- Comprehensive code analysis or review across multiple files\n- Complex search operations requiring multiple search iterations\n- Any task that would benefit from autonomous, focused execution\n\n## Available Agent Types\n- **General**: Full-featured agent with all tools available\n- **Explore**: Specialized for codebase exploration (Glob, Grep, Read, Bash)\n- **Plan**: Specialized for planning and analysis (Glob, Grep, Read, Bash)\n\n## When NOT to Use Task Tool\n- Reading a specific known file path (use Read directly)\n- Searching within 1-3 specific files (use Read/Grep directly)\n- Simple, single-step operations\n- Tasks requiring user interaction or approval\n\n## Usage Guidelines\n- Launch multiple agents concurrently when possible (parallel execution)\n- Each agent invocation is stateless (one-shot execution)\n- Include all context and detailed instructions in the prompt\n- The agent will return a single final report when complete\n- Agent outputs should be trusted and summarized for the user\n\n## Parameters\n- **description**: Short (3-5 word) description of the task (required)\n- **prompt**: Detailed task instructions for the agent (required)\n- **subagent_type**: Type of specialized agent to use (required)\n- **model**: Optional model selection (fast/powerful/default)\n  - fast: Use FAST_MODEL from config (optimized for speed/cost)\n  - powerful: Use POWERFUL_MODEL from config (optimized for quality)\n  - default: Use provider's default model\n- **resume**: Optional agent ID to continue from previous execution`}get schema(){return{type:"object",properties:{description:{type:"string"},prompt:{type:"string"},subagent_type:{type:"string"},model:{type:"string",enum:["fast","powerful","default"]},resume:{type:"string"}},required:["description","prompt","subagent_type"]}}get category(){return"task"}async execute(e){try{this.validate(e);const{description:t,prompt:s,subagent_type:i,model:o,resume:a}=e;if(!r.isInitialized()){return n.fail(new Error("Task tool not available: Agent not initialized. "+"This usually means the application is still starting up."))}const l=r.getSupportedAgentTypes();if(!l.includes(i)){return n.fail(new Error(`Invalid subagent_type: "${i}". `+`Supported types: ${l.join(", ")}`))}if(a){return n.fail(new Error("Resume functionality is not yet implemented. "+"Each Task execution starts fresh."))}const c=await r.execute(t,s,i,o);return n.ok(c)}catch(e){return n.fail(e)}}getSupportedAgentTypes(){const e=r.getSupportedAgentTypes();return e.map((e=>({type:e,description:this._getAgentTypeDescription(e),tools:this._getAgentTypeTools(e)})))}_getAgentTypeDescription(e){const t={General:"General-purpose agent for researching complex questions and executing multi-step tasks",Explore:"Fast agent specialized for exploring codebases",Plan:"Planning and analysis specialist"};return t[e]||"Unknown agent type"}_getAgentTypeTools(e){const t={General:["all"],Explore:["Glob","Grep","Read","Bash"],Plan:["Glob","Grep","Read","Bash"]};return t[e]||[]}}e.exports=new Task},4171:(e,t,s)=>{const i=s(3172);const n=s(7617);class TodoWrite extends i{get name(){return"TodoWrite"}get description(){return`Use this tool to create and manage a structured task list for tracking progress and demonstrating thoroughness to the user.\n\n## When to Use This Tool (IMPORTANT)\nUse this tool proactively in these scenarios:\n\n1. **Complex multi-step tasks** - When a task requires 3 or more distinct steps or actions\n2. **Non-trivial tasks** - Tasks that require careful planning or multiple operations\n3. **User requests todo list** - When the user explicitly asks you to use the todo list\n4. **Multiple tasks** - When users provide a list of things to be done (numbered or comma-separated)\n5. **After receiving new instructions** - Immediately capture user requirements as todos\n6. **When you start working** - Mark it as in_progress BEFORE beginning work\n7. **After completing a task** - Mark it as completed and add any new follow-up tasks\n\n## When NOT to Use This Tool\n\nSkip using this tool when:\n1. There is only a single, straightforward task\n2. The task is trivial and tracking it provides no organizational benefit\n3. The task can be completed in less than 3 trivial steps\n4. The task is purely conversational or informational\n\n## Task States and Management\n\n**Task States**:\n- pending: Task not yet started\n- in_progress: Currently working on (limit to ONE task at a time)\n- completed: Task finished successfully\n\n**IMPORTANT**: Task descriptions must have two forms:\n- content: The imperative form (e.g., "Run tests", "Build the project")\n- activeForm: The present continuous form (e.g., "Running tests", "Building the project")\n\n**Task Management Rules**:\n- Update task status in real-time as you work\n- Mark tasks complete IMMEDIATELY after finishing (don't batch completions)\n- Exactly ONE task must be in_progress at any time\n- ONLY mark a task as completed when you have FULLY accomplished it\n- If you encounter errors or cannot finish, keep the task as in_progress\n\nWhen in doubt, use this tool. Being proactive with task management demonstrates attentiveness and ensures you complete all requirements successfully.`}get schema(){return{type:"object",properties:{todos:{type:"array",items:{type:"object",properties:{content:{type:"string"},status:{type:"string",enum:["pending","in_progress","completed"]},activeForm:{type:"string"}},required:["content","status","activeForm"]}}},required:["todos"]}}get category(){return"task"}_validateTodos(e){if(!Array.isArray(e)){throw new Error("todos must be an array")}if(e.length===0){throw new Error("todos array cannot be empty")}for(let t=0;t<e.length;t++){const s=e[t];if(!s.content||typeof s.content!=="string"){throw new Error(`Todo ${t+1}: content must be a non-empty string`)}if(!s.status||!["pending","in_progress","completed"].includes(s.status)){throw new Error(`Todo ${t+1}: status must be one of: pending, in_progress, completed`)}if(!s.activeForm||typeof s.activeForm!=="string"){throw new Error(`Todo ${t+1}: activeForm must be a non-empty string`)}}const t=e.filter((e=>e.status==="in_progress")).length;if(t>1){throw new Error('Only one todo can have status "in_progress" at a time')}return true}_getStats(e){const t={total:e.length,pending:0,in_progress:0,completed:0,completion_rate:0};for(const s of e){t[s.status]++}if(t.total>0){t.completion_rate=(t.completed/t.total*100).toFixed(1)}return t}async execute(e){try{this.validate(e);const{todos:t}=e;this._validateTodos(t);const s=t.every((e=>e.status==="completed"));if(s){return n.ok("All tasks completed. Conversation ended.",{total:t.length,completed:"ended"})}const i=this._getStats(t);const r=`Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable`;return n.ok(r,{total:i.total,completed:i.completed,in_progress:i.in_progress})}catch(e){return n.fail(e)}}}e.exports=new TodoWrite},3172:(e,t,s)=>{const i=s(7617);class Tool{get name(){throw new Error("Tool must implement name getter")}get description(){throw new Error("Tool must implement description getter")}get schema(){throw new Error("Tool must implement schema getter")}get category(){return"general"}validate(e){if(!e||typeof e!=="object"){throw new Error("Input must be an object")}const t=this.schema;if(t.required&&Array.isArray(t.required)){for(const s of t.required){if(!(s in e)){throw new Error(`Missing required field: ${s}`)}}}if(t.properties){for(const[s,i]of Object.entries(e)){if(!(s in t.properties)){continue}const e=t.properties[s];const n=typeof i;const r=e.type;if(i===null||i===undefined){if(t.required&&t.required.includes(s)){throw new Error(`Field ${s} cannot be null`)}continue}if(r==="array"){if(!Array.isArray(i)){throw new Error(`Field ${s} must be an array`)}continue}if(r==="number"||r==="integer"){if(n!=="number"){throw new Error(`Field ${s} must be a number`)}if(r==="integer"&&!Number.isInteger(i)){throw new Error(`Field ${s} must be an integer`)}continue}if(r==="boolean"&&n!=="boolean"){throw new Error(`Field ${s} must be a boolean`);continue}if(r==="string"&&n!=="string"){throw new Error(`Field ${s} must be a string`);continue}if(r==="object"&&(n!=="object"||Array.isArray(i))){throw new Error(`Field ${s} must be an object`);continue}}}return true}async execute(e){throw new Error("Tool must implement execute method")}signature(){const e=this.schema;const t=[];if(e.properties){const s=e.required||[];for(const[i,n]of Object.entries(e.properties)){const e=s.includes(i);const r=n.type||"any";t.push(`${i}${e?"":"?"}: ${r}`)}}return`${this.name}(${t.join(", ")})`}getInfo(){return{name:this.name,description:this.description,schema:this.schema,category:this.category,signature:this.signature()}}toString(){return`[Tool: ${this.name}]`}isReadOnly(){return this.category==="readonly"}isWriteOps(){return this.category==="writeops"}isTask(){return this.category==="task"}}e.exports=Tool},1287:(e,t,s)=>{const i=s(7258);const n=s(7617);const r=s(5192);class ToolRegistry{constructor(){this.tools=new Map;this.categories={readonly:[],writeops:[],bash:[],task:[],general:[]};this.initialized=false;this.stats={totalExecutions:0,successCount:0,failureCount:0,executionTimes:new Map};this.autoApprovedCategories=new Set}initialize(){if(this.initialized){return}try{this.registerTool(s(774),"readonly");this.registerTool(s(1312),"readonly");this.registerTool(s(4042),"readonly");this.registerTool(s(2163),"writeops");this.registerTool(s(9426),"writeops");this.registerTool(s(4860),"bash");this.registerTool(s(4171),"task");this.registerTool(s(5531),"task");this.initialized=true;i.info(`Initialized ${this.tools.size} tools`)}catch(e){i.warning(`Some tools failed to load: ${e.message}`);console.warn("⚠️  Tool loading warning:",e.message);console.warn("This is expected during development. Missing tools will be skipped.")}}registerTool(e,t="general"){if(!e){console.warn("Cannot register null/undefined tool");return}try{const t=e.name;const s=e.description;const i=e.schema;if(!t||!s||!i){throw new Error("Tool must implement Tool interface (name, description, schema)")}if(typeof e.execute!=="function"){throw new Error("Tool must implement execute method")}}catch(e){console.warn(`Invalid tool, skipping:`,e.message);return}this.tools.set(e.name,e);if(!this.categories[t]){this.categories[t]=[]}this.categories[t].push(e.name);this.stats.executionTimes.set(e.name,[])}getTool(e){if(!this.initialized){this.initialize()}return this.tools.get(e)||null}getAllTools(){if(!this.initialized){this.initialize()}return Array.from(this.tools.values())}getToolsByCategory(e){if(!this.initialized){this.initialize()}const t=this.categories[e]||[];return t.map((e=>this.tools.get(e))).filter(Boolean)}hasTool(e){if(!this.initialized){this.initialize()}return this.tools.has(e)}async execute(e,t){if(!this.initialized){this.initialize()}const s=this.tools.get(e);if(!s){return n.fail(new Error(`Tool not found: ${e}`))}if(this._requiresApproval(s)){const r=await this._requestApproval(e,s,t);if(!r.approved){i.warning(`Tool execution cancelled by user: ${e}`);return n.fail(new Error("Operation cancelled by user"))}if(r.autoApproveCategory){const e=s.category||"general";this.autoApprovedCategories.add(e);i.info(`Auto-approval enabled for category: ${e}`)}}const r=Date.now();i.toolStart(e,t);try{const n=await s.execute(t);const o=Date.now()-r;this.stats.totalExecutions++;if(n.isSuccess()){this.stats.successCount++}else{this.stats.failureCount++}const a=this.stats.executionTimes.get(e)||[];a.push(o);if(a.length>100){a.shift()}this.stats.executionTimes.set(e,a);i.toolEnd(e,n,o);return n}catch(t){const s=Date.now()-r;this.stats.totalExecutions++;this.stats.failureCount++;const o=n.fail(new Error(`Tool execution failed (${e}): ${t.message}`));i.toolError(e,t);i.toolEnd(e,o,s);return o}}_requiresApproval(e){if(!r.REQUIRE_TOOL_APPROVAL){return false}const t=e.category||"general";if(t==="readonly"||t==="task"){return false}if(this.autoApprovedCategories.has(t)){return false}return true}async _requestApproval(e,t,s){try{const n=t.category||"general";const r=3e4;const o=await i.requestApproval(e,n,s,r);return o}catch(t){i.error(`Approval request failed for ${e}: ${t.message}`);return{approved:false,autoApproveCategory:false}}}getStats(){if(!this.initialized){this.initialize()}const e={};for(const[t,s]of Object.entries(this.categories)){e[t]=s.length}const t={};for(const[e,s]of this.stats.executionTimes.entries()){if(s.length>0){const i=s.reduce(((e,t)=>e+t),0)/s.length;t[e]=Math.round(i)}}return{total:this.tools.size,byCategory:e,executions:{total:this.stats.totalExecutions,success:this.stats.successCount,failure:this.stats.failureCount,successRate:this.stats.totalExecutions>0?(this.stats.successCount/this.stats.totalExecutions*100).toFixed(2)+"%":"0%"},avgExecutionTimes:t}}getCategories(){if(!this.initialized){this.initialize()}return{...this.categories}}resetStats(){this.stats.totalExecutions=0;this.stats.successCount=0;this.stats.failureCount=0;for(const[e]of this.stats.executionTimes.entries()){this.stats.executionTimes.set(e,[])}}getToolInfo(e){const t=this.getTool(e);if(!t)return null;return t.getInfo()}}const o=new ToolRegistry;e.exports=o},2163:(e,t,s)=>{const i=s(9896).promises;const n=s(6928);const r=s(3172);const o=s(7617);class Write extends r{get name(){return"Write"}get description(){return`Writes content to a file, creating it if it doesn't exist or overwriting if it does.\n\n## Usage Guidelines\n\n**IMPORTANT - Prefer Edit Over Write:**\n- This tool will OVERWRITE the existing file if there is one at the provided path\n- If this is an existing file, you MUST use the Read tool first to read the file's contents\n- This tool will fail if you did not read the file first\n- ALWAYS prefer editing existing files in the codebase\n- NEVER write new files unless explicitly required\n\n**When to Use Write:**\n- Creating new files that don't exist yet\n- Generating new configuration files\n- Creating new test files or documentation\n- Initial file creation for new features\n\n**When to Use Edit Instead:**\n- Modifying existing files (preferred approach)\n- Updating specific sections of code\n- Changing configuration values\n- Any time the file already exists\n\n## Best Practices\n\n- NEVER proactively create documentation files (*.md) or README files\n- Only create documentation files if explicitly requested by the user\n- Only use emojis if the user explicitly requests it\n- Avoid writing emojis to files unless asked\n- Prefer editing existing files over creating new ones\n- Always read existing files first before overwriting\n\n## Parameters\n\n- file_path: The absolute path to the file to write (required, must be absolute not relative)\n- content: The content to write to the file (required)\n\n## Automatic Features\n\n- Parent directories will be created automatically if they don't exist\n- Existing files will be completely replaced with new content\n- UTF-8 encoding is used by default`}get schema(){return{type:"object",properties:{file_path:{type:"string"},content:{type:"string"}},required:["file_path","content"]}}get category(){return"writeops"}async execute(e){try{this.validate(e);const{file_path:t,content:s}=e;const r=n.isAbsolute(t)?t:n.resolve(process.cwd(),t);const a=n.dirname(r);try{await i.mkdir(a,{recursive:true})}catch(e){if(e.code!=="EEXIST"){return o.fail(new Error(`Failed to create directory: ${e.message}`))}}try{await i.writeFile(r,s,"utf-8")}catch(e){if(e.code==="EACCES"){return o.fail(new Error(`Permission denied: ${t}`))}if(e.code==="EISDIR"){return o.fail(new Error(`Path is a directory: ${t}`))}if(e.code==="ENOSPC"){return o.fail(new Error(`No space left on device: ${t}`))}return o.fail(e)}let l;try{l=await i.stat(r)}catch(e){l=null}const c=`Successfully wrote to ${r}`;return o.ok(c,{file_path:r,bytes_written:s.length,lines_written:s.split("\n").length,size:l?l.size:s.length,created:l?l.birthtime:new Date,modified:l?l.mtime:new Date})}catch(e){return o.fail(e)}}}e.exports=new Write},2746:(e,t,s)=>{const i=s(7258);const n=s(465);const r=s(5192);class UIManager{constructor(e={}){this.options=e;this.showThinking=e.showThinking!==false;this.showToolExecution=e.showToolExecution!==false;this.showTokens=e.showTokens!==false;this.showStreaming=e.showStreaming!==false;this.isStreaming=false;this.streamBuffer="";this.rl=null;this.subscribeToEvents()}subscribeToEvents(){i.on("generate:start",(e=>this.onGenerateStart(e)));i.on("generate:complete",(e=>this.onGenerateComplete(e)));i.on("generate:error",(e=>this.onGenerateError(e)));i.on("tool:start",(e=>this.onToolStart(e)));i.on("tool:end",(e=>this.onToolEnd(e)));i.on("tool:error",(e=>this.onToolError(e)));i.on("stream:start",(()=>this.onStreamStart()));i.on("stream:delta",(e=>this.onStreamDelta(e)));i.on("stream:end",(e=>this.onStreamEnd(e)));i.on("stream:error",(e=>this.onStreamError(e)));i.on("warmup:start",(e=>this.onWarmupStart(e)));i.on("warmup:complete",(e=>this.onWarmupComplete(e)));i.on("warmup:error",(e=>this.onWarmupError(e)));i.on("system",(e=>this.onSystem(e)));i.on("task:classified",(e=>this.onTaskClassified(e)));i.on("schedule:decision",(e=>this.onScheduleDecision(e)));i.on("approval:request",(e=>this.onApprovalRequest(e)))}unsubscribe(){i.removeAllListeners("generate:start");i.removeAllListeners("generate:complete");i.removeAllListeners("generate:error");i.removeAllListeners("tool:start");i.removeAllListeners("tool:end");i.removeAllListeners("tool:error");i.removeAllListeners("stream:start");i.removeAllListeners("stream:delta");i.removeAllListeners("stream:end");i.removeAllListeners("stream:error");i.removeAllListeners("warmup:start");i.removeAllListeners("warmup:complete");i.removeAllListeners("warmup:error");i.removeAllListeners("system");i.removeAllListeners("task:classified");i.removeAllListeners("schedule:decision");i.removeAllListeners("approval:request")}onGenerateStart(e){console.log(n.dim(`Generating with ${e.provider} (${e.model})...`))}onGenerateComplete(e){if(!this.isStreaming){if(this.showThinking){const t=e.message.getThinking();if(t){console.log(n.dim("\n"+t))}}const t=e.message.getText();if(t){console.log(n.cyan("\n"+t))}}this.isStreaming=false;this.streamBuffer="";let t="Generation complete";if(this.showTokens&&e.usage){const s=[];if(e.usage.input_tokens!==undefined){s.push(`in: ${e.usage.input_tokens}`)}if(e.usage.output_tokens!==undefined){s.push(`out: ${e.usage.output_tokens}`)}if(e.usage.cache_read_tokens!==undefined){s.push(`cache: ${e.usage.cache_read_tokens}`)}if(s.length>0){t+=` (Tokens: ${s.join(", ")})`}}console.log(n.dim("\n"+t))}onGenerateError(e){console.error(n.red(`\nGeneration error: ${e.error.message}`))}formatToolInput(e,t=80){const s=JSON.stringify(e);if(s.length<=t){return s}return s.substring(0,t-3)+"..."}onToolStart(e){if(this.showToolExecution){const t=this.formatToolInput(e.input);console.log(n.yellow(`\n${e.name}(${t})`));if(this.options.verbose){console.log(n.dim("   Input: "+JSON.stringify(e.input,null,2)))}}}onToolEnd(e){if(this.showToolExecution){if(e.result.isSuccess()){console.log(`Tool ${e.name} completed (${e.duration}ms)`)}else{console.log(n.red(`Tool ${e.name} error (${e.duration}ms)`))}if(this.options.verbose){console.log(n.dim("   Result: "+e.result.toString().substring(0,200)))}}}onToolError(e){console.error(n.red(`Tool ${e.name} failed: ${e.error.message}`))}onStreamStart(){if(this.showStreaming){this.isStreaming=true;this.streamBuffer="";console.log()}}onStreamDelta(e){if(!this.showStreaming){return}if(e.type==="text"){process.stdout.write(n.cyan(e.delta));this.streamBuffer+=e.delta}else if(e.type==="thinking"){if(this.showThinking){process.stdout.write(n.dim(e.delta));this.streamBuffer+=e.delta}}}onStreamEnd(e){if(this.showStreaming){console.log()}}onStreamError(e){this.isStreaming=false;console.error(n.red(`Streaming error: ${e.error.message}`))}onWarmupStart(e){}onWarmupComplete(e){}onWarmupError(e){console.error(n.red(`Warmup failed for ${e.model}: ${e.error.message}`))}onSystem(e){const t=e.level||"info";const s={info:n.blue,warn:n.yellow,error:n.red,success:n.green};const i=s[t]||n.white;console.log(i(`ℹ ${e.message}`))}onTaskClassified(e){if(this.options.verbose){const t={SEARCH:"🔍",READ:"📖",CODE:"💻",REVIEW:"🔎",DEBUG:"🐛",TEST:"🧪",GENERAL:"📝"};const s=t[e.type]||"📝";console.log(n.dim(`${s} Task: ${e.type} (${e.complexity}, ${Math.round(e.confidence*100)}% confidence)`))}}onScheduleDecision(e){if(this.options.verbose&&e.reason){console.log(n.dim(`   Reason: ${e.reason}`))}if(e.tools&&e.tools.length>0){if(this.options.verbose){console.log(n.dim(`Tools: ${e.tools.join(", ")}`))}}}async onApprovalRequest(e){const{requestId:t,toolName:s,category:r,input:o}=e;console.log(n.yellow("\nTool Execution Requires Approval"));console.log(n.cyan(`Tool: ${s} (${r})`));console.log(n.dim("Input:"));const a=JSON.stringify(o,null,2);const l=500;if(a.length>l){console.log(n.dim(a.substring(0,l)+"..."));console.log(n.dim(`(${a.length-l} more characters)`))}else{console.log(n.dim(a))}if(this._isDangerousOperation(s,o)){console.log(n.red("\nThis operation will modify files!"))}const c=await this._promptForApproval(r);i.approvalResponse(t,c.approved,c.autoApproveCategory)}async _promptForApproval(e){if(!this.rl){console.error(n.red("No readline interface available, operation cancelled"));return{approved:false,autoApproveCategory:false}}return new Promise((t=>{this.rl.question(n.yellow(`Continue? (y/a/n): `),(s=>{const i=s.toLowerCase().trim();if(i==="y"){t({approved:true,autoApproveCategory:false})}else if(i==="a"){console.log(n.green(`Approved (auto-approving all "${e}" tools)\n`));t({approved:true,autoApproveCategory:true})}else{console.log(n.red("Cancelled\n"));t({approved:false,autoApproveCategory:false})}}))}))}_isDangerousOperation(e,t){if(e==="Edit"||e==="Write"){return true}if(e==="Bash"){const e=t.command||"";const s=[/rm\s+-rf/,/del\s+/,/format\s+/,/mkfs/,/dd\s+if=/];return s.some((t=>t.test(e)))}return false}setReadlineInterface(e){this.rl=e}showUserMessage(e){console.log(n.green(`\nYou: ${e}`))}showAssistantMessage(e){console.log(n.cyan(`\nAssistant: ${e}`))}showSystemMessage(e,t="info"){i.system(e,t)}showError(e){console.error(n.red(`\nError: ${e.message}`));if(this.options.verbose&&e.stack){console.error(n.dim(e.stack))}}showWelcome(){console.log(n.bold.cyan(`  ${r.CLINAME} ${r.VERSION}`))}showHelp(){console.log(n.yellow("\nHelp:"));console.log("  - Type your message and press Enter");console.log("  - Ctrl+C to exit");console.log("  - Tools are executed automatically");console.log("  - Streaming is enabled by default\n")}clear(){console.clear()}}e.exports=UIManager},8330:e=>{"use strict";e.exports=JSON.parse('{"name":"CodesCli","version":"1.1.0","description":"MiniCode","main":"dist/index.js","bin":{"minicode":"bin/minicode.js"},"files":["dist","bin"],"engines":{"node":">=14.0.0"},"scripts":{"build":"ncc build src/main.js -o dist -m","start":"node src/main.js","prepublishOnly":"npm run build","test":"echo \\"Error: no test specified\\" && exit 1","lint":"eslint .","format":"prettier --write ."},"repository":{"type":"git","url":"https://gitee.com/naka507/MiniCode.git"},"keywords":[],"author":"","license":"ISC","type":"commonjs","dependencies":{"blessed":"^0.1.81","chalk":"^4.1.2","glob":"^11.0.3","ora":"^5.4.1"},"devDependencies":{"@vercel/ncc":"^0.38.4","eslint":"^9.39.1","eslint-config-prettier":"^10.1.8","eslint-plugin-prettier":"^5.5.4","prettier":"^3.6.2"}}')}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var s=__webpack_module_cache__[e]={id:e,loaded:false,exports:{}};var i=true;try{__webpack_modules__[e].call(s.exports,s,s.exports,__nccwpck_require__);i=false}finally{if(i)delete __webpack_module_cache__[e]}s.loaded=true;return s.exports}(()=>{__nccwpck_require__.nmd=e=>{e.paths=[];if(!e.children)e.children=[];return e}})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__=__nccwpck_require__(443);module.exports=__webpack_exports__})();